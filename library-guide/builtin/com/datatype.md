[aardio æ–‡æ¡£](../../../index.htm "aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ")

# COM ç±»å‹ä¸ç±»å‹è½¬æ?
## ä¸€ã€IDispatch å¯¹è±¡

aardio æ”¯æŒ COM åŸç”Ÿæ¥å£ï¼Œåœ¨æ ‡å‡†åº“çš„ com.interface åå­—ç©ºé—´ä¸‹å¯æ‰¾åˆ°å¾ˆå¤šè¿™ç±»åŸç”Ÿæ¥å£ã€‚COM åŸç”Ÿæ¥å£ä½¿ç”¨çš„å‚æ•°çš„æ•°æ®ç±»å‹ä¸è°ƒç”¨åŸç”?API ç›¸ç±»ä¼¼ï¼Œå‚è€?raw åº?[ç›¸å…³æ–‡æ¡£](../raw/datatype.html) å³å¯ã€?
æˆ‘ä»¬ä¸€èˆ¬æ‰€è¯´çš„ COM å¯¹è±¡å¹¶éä¸Šé¢æ‰€è¿°çš„åŸç”Ÿæ¥å£å¯¹è±¡ï¼Œè€Œæ˜¯å®ç°äº?COM åŠ¨æ€æ¥å£çš„ IDispatch å¯¹è±¡ï¼Œcom.CreateObject ç”¨äº åˆ›å»º IDispatch å¯¹è±¡ï¼?com.IsObject() å‡½æ•°ç”¨äºåˆ¤æ–­å‚æ•°æ˜¯å¦ IDispatch å¯¹è±¡ã€?
åœ?aardio ä¸­æˆ‘ä»¬ä¸€èˆ¬æåˆ°çš„ "COM å¯¹è±¡"ä¹Ÿä¸“æŒ‡è¿™ç§åŠ¨æ€æ¥å£çš„ IDispatch å¯¹è±¡ã€‚IDispatch å¯¹è±¡åœ?aardio ä¸­çš„å…ƒç±»å‹ä¸º "com.IDispatch"ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿç§?IDispatch å¯¹è±¡ä¸?"com.IDispatch" å¯¹è±¡ã€?
## äºŒã€Variant å˜ä½“ç±»å‹

æˆ‘ä»¬åœ¨è°ƒç”?COM å¯¹è±¡æ—¶ï¼Œä¸€èˆ¬ä¸ä¼šç›´æ¥ä½¿ç”?Variant å˜ä½“ç±»å‹ã€‚ä½†æ˜?IDispatch æ¥å£ä¼ å‚åœ¨å†…éƒ¨ä¸»è¦ä½¿ç”¨å˜ä½“ç±»å‹ï¼ˆVariantï¼‰ï¼Œä¹Ÿå°±æ˜?aardio ä¸­çš„ com.Variant å¯¹è±¡ã€?
å˜ä½“ç±»å‹ï¼ˆVariantï¼‰æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œå¹¶ä¸”ç”¨ä¸€ä¸?vt å­—æ®µå£°æ˜äº†è‡ªå·±çš„ç±»å‹ï¼Œä¾‹å¦?VT\_I4 å°±è¡¨ç¤?4 å­—èŠ‚çš„æ•´å‹æ•°å€¼ï¼Œè€?VT\_BSTR è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹ã€?
ä¾‹å¦‚ä¸€ä¸?VT\_I4 ç±»å‹çš„æ•°å€?123ï¼Œç”¨ aardio [ç»“æ„ä½“](../raw/datatype.html#struct) æè¿°å°±æ˜¯è¿™æ ·ï¼?
```aardio aardio
{
    WORD vt = 3/*_VT_I4*/;
    WORD r1;
    WORD r2;
    WORD r3;
    ptr lVal = 123;
    ptr r4;
};

```

## ä¸‰ã€COM æ¥å£ç±»å‹è½¬æ¢åŸºæœ¬è§„åˆ™

### æœ‰ç±»å‹ä¿¡æ¯çš„è‡ªåŠ¨ç±»å‹è½¬æ¢

COM å¯¹è±¡é€šå¸¸ä¼šæä¾›ç±»å‹åº“å¯ä»¥è‡ªåŠ¨è·å–æ¥å£å‚æ•°çš„ç±»å‹ä¿¡æ¯ã€‚å¦‚æœæœ‰è¿™æ ·çš„ç±»å‹ä¿¡æ¯ï¼Œé‚£ä¹ˆå‚æ•°ä¸è¿”å›å€¼çš„ç±»å‹è½¬æ¢å¯ä»¥æ¯”è¾ƒå®Œç¾åœ°è‡ªåŠ¨å®Œæˆã€‚aardio ä¼šä¾æ?COM å‡½æ•°æä¾›çš„å‚æ•°ç±»å‹ã€ä»¥åŠå®é™…ä¼ å…¥çš„å‚æ•°è‡ªåŠ¨è½¬æ¢ä¸ºåˆé€‚çš„COMç±»å‹ï¼ŒCOM å‡½æ•°çš„è¿”å›å€¼ä¹Ÿä¼šè‡ªåŠ¨è½¬æ¢ä¸ºåˆé€‚çš„ aardo ç±»å‹ã€‚å„ç§?aardio æ•°æ®ç±»å‹èƒ½è‡ªåŠ¨æ”¯æŒ?COM å¯¹è±¡ï¼Œä¾‹å¦‚å¸¸è§çš„æ•°å€¼ã€å­—ç¬¦ä¸²ç±»å‹ã€æ—¶é—´å¯¹è±¡ã€table æ•°ç»„ç­‰ç­‰ã€?
### æ— ç±»å‹ä¿¡æ¯çš„è½¬æ¢è§„åˆ™

æœ‰äº› COM å¯¹è±¡ä¸æä¾›ç±»å‹åº“ï¼Œæ— æ³•è‡ªåŠ¨è·å–æ¥å£çš„å‚æ•°ç±»å‹ä¿¡æ¯ã€‚è¿™ç§æ¥å£æœ‰äº›ä¼šæ¯”è¾ƒå®½æ¾å¹¶è‡ªåŠ¨è½¬æ¢å…¼å®¹çš„ç±»å‹ï¼Œä½†æœ‰äº›æ¥å£æ—¢ä¸æä¾›ç±»å‹ä¿¡æ¯ï¼Œå¯¹ç±»å‹çš„è¦æ±‚åˆéå¸¸ä¸¥æ ¼ä¸€ç‚¹ä¸å¯¹å°±æŠ¥é”™ã€?
è¿™æ—¶å€™æˆ‘ä»¬å°±å…ˆè¦äº†è§£åœ¨è¿™ç§æ— ç±»å‹ä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œç±»å‹è‡ªåŠ¨è½¬æ¢çš„è§„åˆ™ã€‚å¹¶ä¸”äº†è§£æ€æ · [æ˜¾å¼å£°æ˜æŒ‡å®šç±»å‹çš„å‚æ•°](#explicit-typing)ã€?
åœ¨æ— ç±»å‹ä¿¡æ¯çš„æƒ…å†µä¸‹è°ƒç”¨ COM å‡½æ•°ï¼Œç±»å‹è½¬æ¢åˆåˆ†ä¸ºä»¥ä¸‹ä¸‰å¤§ç±»ï¼š

1. éæ•°å€¼éæ•°ç»„ç±»å‹
   éæ•°å€¼éæ•°ç»„ç±»å‹åŸºæœ¬éƒ½èƒ½è‡ªåŠ¨è½¬æ¢ä¸ºå…¼å®¹çš„ Variant å˜ä½“ï¼Œå‚æ•°ä¼šè½¬æ¢ä¸ºåˆé€‚çš„ç±»å‹ã€‚ä¾‹å¦‚å¸ƒå°”å€¼ï¼Œbuffer è¿™äº›ç›´æ¥å…¼å®¹ï¼Œå­—ç¬¦ä¸²è½¬ä¸º \_VT\_BSTR ç±»å‹ï¼Œæ—¶é—´è½¬æ¢ä¸º \_VT\_DATE ç±»å‹ â€¦â€?éæ•°ç»„çš„æ™®é€?table ä»¥åŠ function è½¬æ¢ä¸?IDispatch æ¥å£å¯¹è±¡ï¼Œè¿™äº›ç±»å‹åŸºæœ¬éƒ½æ˜¯ç›¸äº’å…¼å®¹çš„ï¼Œä¸€èˆ¬ä¹Ÿä¸ä¼šå‡ºé”™ã€?
2. æ•°å€¼ç±»å?   COM å‚æ•°ç±»å‹æŠ¥é”™åŸºæœ¬éƒ½æ˜¯å› ä¸ºæ•°å€¼ç±»å‹ã€‚æˆ‘ä»¬è¦ç‰¹åˆ«æ³¨æ„ aardio å¯¹æ•°å€¼çš„è½¬æ¢è§„åˆ™ï¼šå•ä¸ªæ•´æ•°å€¼é»˜è®¤åœ¨ COM å‡½æ•°ä¸­ä¼šè½¬ä¸º 4 å­—èŠ‚ VT\_I4( int ) ç±»å‹å˜ä½“ï¼Œå¦‚æœæ•°å€¼åŒ…å«å°æ•°åˆ™é»˜è®¤è½¬ä¸º 8 å­—èŠ‚ \_VT\_R8ï¼ˆdouble) ç±»å‹å˜ä½“ã€?
3. æ•°ç»„ç±»å‹

   COM ä¸­çš„æ•°ç»„åˆ™ç§°ä¸ºå®‰å…¨æ•°ç»„ï¼ˆ SAFEARRAY ï¼‰ã€?
   SAFEARRAY å¯ä»¥æ˜¯å„ç§ç±»å‹çš„æ•°æ®ç»„æˆï¼Œä¾‹å¦‚æ•°å€¼æ•°ç»„ï¼Œå­—ç¬¦ä¸²æ•°ç»„ï¼Œæˆ–è€…ç”± Variant å¯¹è±¡ç»„æˆçš?Variant æ•°ç»„ã€‚å› ä¸?Variant å¯¹è±¡æœ¬èº«å¯ä»¥æ‰¿è½½ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œæ‰€ä»?Variant æ•°ç»„å½“ç„¶ä¹Ÿå°±å¯ä»¥åŒ…å«å„ç§ç±»å‹çš„æ•°ç»„æˆå‘˜äº†ã€?
   çº¯æ•°å€?aardio æ•°ç»„é»˜è®¤ä¼šè½¬ä¸?\_VT\_R8ï¼ˆdouble) ç±»å‹ SAFEARRAYï¼Œè¦ç‰¹åˆ«æ³¨æ„æ•°ç»„çš„é»˜è®¤è½¬æ¢ç±»å‹ä¸æ˜¯æ•´å‹ã€?
   çº¯å­—ç¬¦ä¸² aardio æ•°ç»„é»˜è®¤ä¼šè½¬ä¸?\_VT\_BSTR ç±»å‹ SAFEARRAYã€?   æ™®é€?COM å¯¹è±¡ï¼ˆIDispatch å¯¹è±¡ï¼?aardio æ•°ç»„ä¼šè½¬ä¸?\_VT\_DISPATCH ç±»å‹ SAFEARRAYã€?
   å…¶ä»–ç±»å‹ aardio æ•°ç»„ä¼šè½¬ä¸?\_VT\_VARIANT ç±»å‹ SAFEARRAYã€?

## å››ã€COM å®‰å…¨æ•°ç»„ï¼?SAFEARRAY ï¼?
åœ¨è°ƒç”?COM æ¥å£å‡½æ•°æ—¶ï¼Œå¦‚æœå‚æ•°æ˜¯ä¸€ä¸?table å¯¹è±¡å¹¶ä¸”åŒ…å«æ•°ç»„å…ƒç»„ï¼Œåˆ™è½¬æ¢ä¸?COM å®‰å…¨æ•°ç»„(SAFEARRAY)ã€?
éç©ºæ•°ç»„è½¬æ¢ä¸?COM å®‰å…¨æ•°ç»„æ—¶éµå®ˆä»¥ä¸‹è§„åˆ™ï¼š

1. å¦‚æœæ•°ç»„å…ƒç´ æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™è½¬æ¢ä¸?\_VT\_BSTR ç±»å‹çš?SAFEARRAY ã€?
2. å¦‚æœæ•°ç»„å…ƒç´ æ˜¯æ•°å€¼ï¼Œåˆ™è½¬æ¢ä¸º \_VT\_R8 ç±»å‹çš?SAFEARRAY ã€?
3. å¦‚æœæ•°ç»„å…ƒç´ æ˜¯æ™®é€?COM å¯¹è±¡ï¼ˆIDispatch å¯¹è±¡ï¼‰ï¼Œåˆ™è½¬æ¢ä¸º \_VT\_DISPATCH ç±»å‹çš?SAFEARRAY ã€?4. æ•°ç»„å…ƒç´ æ˜¯å…¶ä»–ç±»å‹æˆ–æ··åˆä¸åŒç±»å‹æ—¶ï¼Œåˆ™è½¬æ¢ä¸º \_VT\_VARIANT ç±»å‹çš?SAFEARRAY ã€?
ä¸Šé¢è¯´çš„ COM ç±»å‹å¾—äº†æ˜¯å˜ä½“ç±»å‹ï¼ˆ Variant Type ï¼‰ï¼Œä»?_VT_ å‰ç¼€çš„å¸¸é‡è¡¨ç¤ºã€?
### com.SafeArray

ä½¿ç”¨ `com.SafeArray(å˜ä½“ç±»å‹)` å¯ä»¥åˆ›å»º COM å®‰å…¨æ•°ç»„ã€?
com.SafeArray è¿”å›çš„å¯¹è±¡å°±æ˜¯ä¸€ä¸ªå£°æ˜äº† `_safearray_type` å…ƒå±æ€§çš„æ™®é€?aardio æ•°ç»„ï¼Œå¯ä»¥åƒæ™®é€šæ•°ç»„ä¸€æ ·ä½¿ç”¨ã€?
æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥æ„é€ ç¬¦åˆæ­¤è§„æ ¼çš„æ•°ç»„ï¼Œä¾‹å¦‚ï¼?
```aardio aardio
{ 1;2;3; @{_safearray_type=0x11/*_VT_UI1*/} }

```

å°†è¿™ç§æ•°ç»„ä¼ å…?COM å‡½æ•°ï¼?aardio ä¼šå°†å…¶ä½œä¸?COM å®‰å…¨æ•°ç»„ï¼ˆSAFEARRAYï¼‰ä½¿ç”¨ã€?
COM å¯¹è±¡è¿”å›åˆ?aardio ä¸­çš„å®‰å…¨æ•°ç»„ä¹Ÿè‡ªåŠ¨è½¬æ¢ä¸ºä»¥ä¸Šæ ¼å¼ï¼Œä¸€ä¸ªä¾‹å¤–æ˜¯ COM å­—èŠ‚æ•°ç»„ä¼šè½¬æ¢ä¸º aardio ä¸­çš„ buffer ç±»å‹ã€?
### com.SafeArrayV

ä½¿ç”¨ com.SafeArrayV å‡½æ•°å¯ä»¥åˆ›å»ºå¦å¤–ä¸€ç§æè¿?COM å®‰å…¨æ•°ç»„çš„å¯¹è±¡ï¼Œè¿™ç§æ ¼å¼è¾ƒå°‘ä½¿ç”¨ã€?
com.SafeArrayV ä¼šè¿”å›ä¸€ä¸ªè¡¨å¯¹è±¡ï¼Œå¹¶ä¸”ä½¿ç”¨è¡¨çš?\_safearray æˆå‘˜æŒ‡å®šè¦è½¬æ¢ä¸º COM å®‰å…¨æ•°ç»„çš„æ•°æ®ã€‚\_safearray å¯ä»¥æŒ‡å‘ä¸€ä¸ªæ•°ç»„ï¼Œä¹Ÿå¯ä»¥æŒ‡å‘ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºçš„å­—èŠ‚æ•°ç»„ã€æˆ–è€…ä¸€ä¸?buffer è¡¨ç¤ºçš„åŸç”Ÿå­—èŠ‚æ•°ç»„ã€?
com.SafeArrayV è¿”å›çš„å®‰å…¨æ•°ç»„åœ¨ä¼ å…¥ COM å‡½æ•°æ—¶åŒæ ·ä¼šè¢«è‡ªåŠ¨å¤„ç†ä¸º SAFEARRAY ã€‚com.SafeArrayV è¿”å›çš„ä¸æ˜¯çœŸæ­£çš„æ•°ç»„ä¸èƒ½ä½œä¸ºæ™®é€šæ•°ç»„ä½¿ç”¨ï¼Œå®ƒå”¯ä¸€çš„ä½œç”¨å°±æ˜¯ç”¨æ¥å‘Šè¯?COM å‡½æ•°è¿™æ˜¯ä¸€ä¸?SAFEARRAYã€?
com.SafeArrayV åˆ›å»ºçš„å¯¹è±¡é™¤äº†ç”¨ \_safearray æˆå‘˜è¡¨ç¤ºæ•°æ®ï¼Œä¹Ÿå¯é€‰ç”¨ \_type æˆå‘˜æ˜¾å¼æŒ‡å®šæ•°ç»„å…ƒç´ çš„å˜ä½“ç±»å‹ï¼ˆ Variant Type ï¼‰ï¼Œæˆ‘ä»¬å…¶å®å¯ä»¥æ‰‹åŠ¨æ„é€ ç›¸åŒæ ¼å¼çš„è¡¨å¯¹è±¡ï¼Œä¾‹å¦‚ï¼?
```aardio aardio
{ _safearray = { "æ•°ç»„æˆå‘˜1";"æ•°ç»„æˆå‘˜2"}; _type = 8/*_VT_BSTR*/ }

```

å¦‚æœä¸æŒ‡å®?\_type å±æ€§ï¼Œå­—ç¬¦ä¸²æˆ– buffer è¡¨ç¤ºçš„å­—èŠ‚æ•°ç»„ç´ å…ƒç´ çš„å˜ä½“ç±»å‹ä¸º VT\_UI1ï¼ˆå­—èŠ‚æ•°ç»„ï¼‰, å¦‚æœç”±å­—ç¬¦ä¸²æ•°ç»„è¡¨ç¤ºçš„æ•°ç»„å…ƒç´ çš„å˜ä½“ç±»å‹ä¸?VT\_BSTR ï¼Œæ•°å€¼æ•°ç»„å…ƒç´ çš„å˜ä½“ç±»å‹é»˜è®¤ä¸?\_VT\_R8ï¼Œå…¶ä»–ç±»å‹æˆ–æ··åˆä¸åŒç±»å‹æ—¶æ•°ç»„å…ƒç´ çš„å˜ä½“ç±»å‹ä¸?\_VT\_VARIANT ã€?
buffer æœ¬å°±å¯ä»¥ä½œä¸º COM å­—èŠ‚æ•°ç»„ç›´æ¥ä½¿ç”¨ï¼Œcom.SafeArrayV ç›®å‰å”¯ä¸€çš„ä½œç”¨å¯èƒ½æ˜¯åŒ…è£…å­—ç¬¦ä¸²ä¸º COM å®‰å…¨æ•°ç»„ã€?
com.SafeArray åœ¨å„æ–¹é¢æ¥è¯´éƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼?
### buffer ä¸å­—èŠ‚æ•°ç»?
å½?COM å‡½æ•°è¿”å›ç»?aardio çš„å€¼æ˜¯æ— ç¬¦å·å­—èŠ‚æ•°ç»„ï¼ˆç±»å‹ä¸?VT\_UI1 ï¼‰æ—¶ä¼šè‡ªåŠ¨è½¬æ¢ä¸º aardio ä¸­çš„ buffer ç±»å‹ï¼Œåè¿‡æ¥ aardio ä¸­çš„ buffer ç±»å‹å¯¹è±¡ä¼ å…¥COM å‡½æ•°æ—¶ä¹Ÿè‡ªåŠ¨è¡¨ç¤ºä¸?COM ä¸­çš„å­—èŠ‚å®‰å…¨æ•°ç»„ï¼ˆå…ƒç´ ç±»å‹ä¸ºVT\_UI1)ã€?
## äº”ã€è‡ªåŠ¨è½¬æ¢ä¸º IDispatch å¯¹è±¡çš?tableã€function å¯¹è±¡

å¦‚æœä¼ å…¥ COM å‡½æ•°çš„è¡¨å¯¹è±¡ä¸æ˜¯æ•°ç»„ã€COM å®‰å…¨æ•°ç»„ã€æˆ–è€?COM æ¥å£æ”¯æŒçš?time å¯¹è±¡ã€å˜ä½“å¯¹è±¡ã€IDispatch å¯¹è±¡ï¼Œå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„è¡¨å¯¹è±¡ï¼Œåˆ™ä¼šè‡ªåŠ¨è½¬æ¢ä¸?IDispatch æ¥å£å¯¹è±¡ã€?
å¦‚æœä¼ å…¥ COM å¯¹è±¡çš„æ˜¯ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œä¹Ÿä¼šè‡ªåŠ¨è½¬æ¢ä¸?IDispatch æ¥å£å¯¹è±¡ã€?
å…³äºå°?tableã€function å¯¹è±¡è‡ªåŠ¨è½¬æ¢ä¸?IDispatch æ¥å£çš„ç»†èŠ‚è¯·å‚è€?[com.ImplInterface](ImplInterface.html#IDispatch)

# å…­ã€æ”¹å?IDispatch æ¥å£ç±»å‹è½¬æ¢æ—¶çš„é»˜è®¤ç±»å‹

è‡ªåŠ¨è½¬æ¢ç±»å‹å¯¹äºä¸€èˆ¬çš„ COM å¯¹è±¡æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†ä»ç„¶ä¼šå‡ºç°ä¸€äº›ä¾‹å¤–ï¼Œä¾‹å¦‚æˆ‘ä»¬ç”?`com.CreateObject("ScriptControl")` åˆ›å»º VBScript çš„è„šæœ¬è§£é‡Šå™¨ï¼?åœ?VBScript é‡Œå°±åªèƒ½è¯†åˆ« Variant ç±»å‹çš„å¯¹è±¡ï¼Œæ•°ç»„ä¹Ÿåªèƒ½ä¸º Variant ç±»å‹æ•°ç»„ã€?
å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”?`com.Variant({1,2,3})` è¿™ç§æ–¹å¼åˆ›å»º Variant ç±»å‹çš„æ•°ç»„ï¼Œä½†è¿™æ ·æ˜¾ç„¶å¾ˆéº»çƒ¦ï¼Œå¯¹äºè¿™æ ·çš„ COM å¯¹è±¡ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ `com.SetPreferredArrayType(comObject,0xC/*_VT_VARIANT*/)` å°†å…¶è®¾ç½®ä¸ºå§‹ç»ˆä½¿ç”?Variant ç±»å‹è½¬æ¢å‚æ•°ï¼Œå¯æŸ¥çœ‹å°è£…äº?ScriptControl çš„æ ‡å‡†åº“ web.script å°±æ˜¯è¿™æ ·åšçš„ã€?
`com.SetPreferredArrayType(comObject,0xFFFF/*_VT_ILLEGAL*/)` åˆ™ä¼šå‘ŠçŸ¥ aardio ä½¿ç”¨é»˜è®¤è§„åˆ™è‡ªåŠ¨åˆ†ææ•°ç»„ç±»å‹ï¼Œè¿™æ˜?COM å¯¹è±¡çš„é»˜è®¤è®¾ç½®ã€‚æ˜¾ç„¶å‚æ•°æŒ‡å®šä¸º \_VT\_ILLEGAL æ˜¯æ— æ„ä¹‰çš„ï¼Œå› ä¸ºé»˜è®¤å°±æ˜¯è¿™ä¸ªå€¼ã€?
æ³¨æ„ `com.SetPreferredArrayType()` çš„ä½œç”¨å…·æœ‰ä¼ é€’æ€§ï¼ŒCOM å¯¹è±¡ä¼šå°†è¿™ä¸ªå‡½æ•°è®¾ç½®çš„å€¼ä¼ é€’ç»™å®ƒè¿”å›çš„å…¶ä»– COM å¯¹è±¡ã€?
# ä¸ƒã€æ˜ç¡®å£°æ˜?COM å‚æ•°ç±»å‹ï¼?[\#](\#explicit-typing)

æœ‰ä¸€äº?COM å¯¹è±¡åˆ™æ°æ°ç›¸åï¼Œè¦éå¸¸æ˜ç¡®çš„æŒ‡å®šæ•°ç»„çš„ç±»å‹ï¼Œ
ä¾‹å¦‚å‡½æ•°è¦æ±‚ 16ä½æ— ç¬¦å·æ•´å‹çš„æ•°ç»„ï¼Œä½ ä¼  32 ä½æ•´å‹æ•°ç»„å°±ä¼šæŠ¥é”™ï¼Œ
æ ‡å‡†åº“çš„ dotNet åŸºäº COM æ¥å£è°ƒç”¨ .Net ï¼?Net å°±æœ‰è¿™ä¸ªç‰¹æ€§ï¼Œéœ€è¦æ›´ä¸¥æ ¼åœ°åŒ¹é…å‚æ•°ç±»å‹ã€?
aardio å·²åœ¨ dotNet æ”¯æŒåº“å®ç°äº†æ¯”è¾ƒå®Œç¾çš„ç±»å‹è‡ªåŠ¨è½¬æ¢å’Œè‡ªåŠ¨å…¼å®¹ã€?ä½†æˆ‘ä»¬ä»ç„¶è¦äº†è§£å¦‚ä½•åœ?COM æ¥å£ä¸­æ˜ç¡®åœ°å£°æ˜æ•°å€¼æˆ–æ•°ç»„çš„ç±»å‹ã€?
å› ä¸ºæˆ‘ä»¬å¯èƒ½åœ¨å…¶ä»?COM å¯¹è±¡ä¸­é‡åˆ°è¿™ç§é—®é¢˜ï¼ˆè™½ç„¶å¹¶ä¸å¤šè§ï¼‰ï¼Œä¾‹å¦‚ AutoCAD çš„æ¥å£ã€?
aardio æä¾›äº†ä»¥ä¸‹å‡½æ•°å¯ä»¥æ˜ç¡®çš„å£°æ˜ COM å‚æ•°çš„ç±»å‹ï¼š

- com.byte() å°†å‚æ•°æŒ‡å®šçš„æ•°å€¼æˆ–æ•°ç»„å£°æ˜ä¸?8 ä½æ•´å‹æ•°å€¼ã€?- com.ubyte() å°†å‚æ•°æŒ‡å®šçš„æ•°å€¼æˆ–æ•°ç»„å£°æ˜ä¸?8 ä½æ— ç¬¦å·æ•´å‹æ•°å€¼ã€?- com.word() å°†å‚æ•°æŒ‡å®šçš„æ•°å€¼æˆ–æ•°ç»„å£°æ˜ä¸?16 ä½æ•´å‹æ•°å€¼ã€?- com.uword() å°†å‚æ•°æŒ‡å®šçš„æ•°å€¼æˆ–æ•°ç»„å£°æ˜ä¸?16 ä½æ— ç¬¦å·æ•´å‹æ•°å€¼ã€?- com.int() å°†å‚æ•°æŒ‡å®šçš„æ•°å€¼æˆ–æ•°ç»„å£°æ˜ä¸?32 ä½æ•´å‹æ•°å€¼ã€?- com.uint() å°†å‚æ•°æŒ‡å®šçš„æ•°å€¼æˆ–æ•°ç»„å£°æ˜ä¸?32 ä½æ— ç¬¦å·æ•´å‹æ•°å€¼ã€?- com.long() å°†å‚æ•°æŒ‡å®šçš„æ•°å€¼æˆ–æ•°ç»„å£°æ˜ä¸?64 ä½æ•´å‹æ•°å€¼ã€?- com.ulong() å°†å‚æ•°æŒ‡å®šçš„æ•°å€¼æˆ–æ•°ç»„å£°æ˜ä¸?64 ä½æ— ç¬¦å·æ•´å‹æ•°å€¼ã€?- com.float() å°†å‚æ•°æŒ‡å®šçš„æ•°å€¼æˆ–æ•°ç»„å£°æ˜ä¸?32 ä½æµ®ç‚¹æ•°å€¼ã€?- com.double() å°†å‚æ•°æŒ‡å®šçš„æ•°å€¼æˆ–æ•°ç»„å£°æ˜ä¸?64 ä½æµ®ç‚¹æ•°å€¼ã€?- com.Variant() å°†å‚æ•°æŒ‡å®šçš„å€¼æˆ–æ•°ç»„å£°æ˜ä¸ºå˜ä½“ç±»å‹ã€?
aardio ä¸­åŸç”Ÿç±»å‹ä½¿ç”¨å¤§å†™è¡¨ç¤ºæ— ç¬¦å·æ•°å€¼ç±»å‹ï¼Œ
åœ¨ä»¥ä¸Šå‡½æ•°åå­—ä¸­æˆ‘ä»¬åœ¨å°å†™çš„ç±»å‹åå‰åŠ ä¸Š"u" å–ä»£å¤§å†™ä»¥è¡¨ç¤ºæ— ç¬¦å·ç±»å‹ï¼?
è¦æ³¨æ„ä¸åŒç¼–ç¨‹è¯­è¨€ä¹‹é—´çš„å·®åˆ«ï¼š

> VB6/VBA ä¸?Integer æ˜?6ä½æ•°å€¼ï¼ŒLong æ˜?2ä½æ•°å€¼ï¼Œ
> è€Œåœ¨ C# ä¸?int æ˜?2ä½æ•°å€? long æ˜?4ä½æ•°å€¼ï¼Œ
> æ›´é‡è¦çš„ä¸æ˜¯ç±»å‹åå­—ï¼Œè€Œæ˜¯å­˜å‚¨é•¿åº¦ã€?
COM å‡½æ•°ä¹Ÿå¯ä»¥å…¼å®?raw åº“ä»¥ä¸‹å‡½æ•°åˆ›å»ºçš„ç±»å‹åŒ–æ•°å€¼ï¼š

- raw.byte()
- raw.ubyte()
- raw.word()
- raw.uword()
- raw.int()
- raw.uint()
- raw.long()
- raw.ulong()
- raw.float()
- raw.double()

# å…«ã€ç¤ºä¾?
```aardio aardio
import com;

//åˆ›å»ºç”¨äº COM å‡½æ•°çš?16ä½æ•°å€?var v = com.word(32)

//åˆ›å»ºç”¨äº COM å‡½æ•°çš?16ä½æ•°ç»?var v = com.word({1,2,3})

//åˆ›å»ºç”¨äº COM å‡½æ•°çš?Variant ç±»å‹å˜ä½“æ•°ç»„ï¼ˆæ³¨æ„æœ‰çš„å‚æ•°ä¸å…è®¸å­—ç¬¦ä¸²æ•°ç»„ï¼Œè¦æ±‚ä¼ å˜ä½“æ•°ç»„ï¼‰
var v = com.Variant({"test","test2"});

//ä¸‹é¢è¿™æ ·å†™ä¸ com.word({1,2,3}) çš„ä½œç”¨æ˜¯ä¸€æ ·çš„ã€?var v = com.Variant({1,2,3},2/*_VT_I2*/);

//åˆ›å»ºç”¨äº COM å‡½æ•°çš?Variant ç±»å‹å˜ä½“æ•°ç»„,
var v = com.SafeArrayV({1,2,3}); //è¿™ä¸ªå‡½æ•°è¿”å›çš„ä¸æ˜?Variant ä¹Ÿä¸æ˜?SAFEARRAY,åªæ˜¯åŒ…è£…å¯¹è±¡

//ä¸‹é¢è¿™æ ·å†™ä¸ com.word({1,2,3}) çš„ä½œç”¨æ˜¯ä¸€æ ·çš„ï¼Œä½†è¿”å›çš„ä¸æ˜?Variant å¯¹è±¡è€Œæ˜¯åŒ…è£…å¯¹è±¡
var v = com.SafeArrayV({1,2,3},2/*_VT_I2*/);

//ä¸‹é¢è¿™æ ·æ˜¯åˆ›å»?SAFEARRAY æ•°ç»„ï¼Œå¯ä»¥ä½œä¸ºæ™®é€?aardio æ•°ç»„ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸º COM å‚æ•°ç”?var v  = com.SafeArray(); //COM å¯¹è±¡è¿”å›çš„æ‰€æœ?SAFEARRAY æ•°ç»„ä¹Ÿæ˜¯è¿™ç§æ ¼å¼
table.push(v,1,2,3); //å®é™…ä¸?SAFEARRAY ä¹Ÿæ˜¯æ™®é€šæ•°ç»?
//ä¹Ÿå¯ä»¥åœ¨å‚æ•°ä¸­æŒ‡æ˜ç±»å‹ï¼Œä¸‹é¢ä»£ç ä½œç”¨ç±»ä¼¼ com.word({1,2,3})ï¼Œä½†è¿”å›çš„æ˜¯  SAFEARRAY è€Œé Variant å¯¹è±¡ã€?var v  = com.SafeArray(_VT_I2,1,2,3);

```

[Markdown æ ¼å¼](https://www.aardio.com/zh-cn/doc/library-guide/builtin/com/datatype.md)

