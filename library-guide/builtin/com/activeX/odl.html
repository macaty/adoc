
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£ - ODL è¯­æ³•æŒ‡å—'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£ - ODL è¯­æ³•æŒ‡å—</title> 
<link rel="stylesheet" href="../../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>ODL è¯­æ³•æŒ‡å—</h1>

<blockquote>
<p>åœ¨ aardio ä¸­ä¸€èˆ¬ä¸éœ€è¦æ”¹åŠ¨ *.odl ç±»å‹åº“å£°æ˜æ–‡ä»¶ã€‚ ä¿æŒé»˜è®¤å°±å¯ä»¥ï¼Œæ‰€æœ‰æ¥å£å‡½æ•°å¯ç”¨ com.activeX è‡ªåŠ¨å¯¼å‡ºã€‚</p>

<p>å¦‚æœè¦è‡ªå®šä¹‰ç±»å‹åº“ï¼Œå»ºè®®ç»§æ‰¿ aardio.idl æä¾›çš„ IDispeatchExecutable æ¥å£ã€‚ æ‰€æœ‰ DISPID ä¸åº”å¤§äº 10000 ï¼ˆaardio è‡ªåŠ¨ç”Ÿæˆ DISPID ä»¥ 10000 ä¸ºèµ·å§‹å€¼é€’å¢ï¼‰ã€‚</p>

<p>æ‰€æœ‰ aardio è¡¨å¯¹è±¡ã€å‡½æ•°å¯¹è±¡éƒ½å®ç°äº† IDispatch æ¥å£ï¼Œ è¡¨å¯¹è±¡å¯åœ¨ DISPID_NEWENUM è°ƒç”¨æ—¶è¿”å› IEnumVARIANT æšä¸¾æ¥å£ã€‚</p>
</blockquote>

<h2>ä¸€ã€å®šä¹‰ç±»å‹åº“ï¼ˆlibraryï¼‰</h2>

<h3>1.1 è¯­æ³•</h3>

<pre><code class="odl language-odl">[attributes]
library ç±»å‹åº“å { 
    importlib(&quot;åº“å&quot;);
    [attributes]
    interface/interface_name : IDispatch { 
        å‡½æ•°å®šä¹‰;
    };
};
</code></pre>

<h3>1.2 è¯­æ³•å…ƒç´ è¯´æ˜</h3>

<ul>
<li><code>attributes</code>: å¯ä»¥åŒ…æ‹¬ <code>helpstring</code>, <code>helpcontext</code>, <code>lcid</code>, <code>restricted</code>, <code>hidden</code>, <code>control</code>, <code>uuid</code>, <code>version</code> å±æ€§ï¼Œå…¶ä¸­ <code>uuid</code> æ˜¯å¿…é¡»çš„ã€‚</li>
<li><code>library</code>: ç±»å‹åº“çš„åå­—ã€‚</li>
<li><code>importlib</code>: å¼•å…¥æ ‡å‡†åº“ã€‚</li>
<li><code>interface</code>: æ¥å£å®šä¹‰ã€‚</li>
</ul>

<h3>1.3 å¤‡æ³¨</h3>

<ul>
<li><code>library</code> è¡¨è¾¾å¼å¿…é¡»å‡ºç°åœ¨ä»»ä½•ç±»å‹å®šä¹‰ä¹‹å‰ã€‚</li>
</ul>

<h3>1.4 ç¤ºä¾‹</h3>

<pre><code class="odl language-odl">import &quot;aardio.idl&quot;;

[
uuid(27A24EA2-F236-4FE4-A918-44AAB7A8DC5C),
version(1.0)
]
library aardioTestControl {

    importlib(&quot;stdole32.tlb&quot;);    

    [ uuid(EC32DF0E-0947-4DF1-827D-7073D376995D),control ]
    coclass Sample {

        //é»˜è®¤æ¥å£
        [default] dispinterface IDispatchExecutable;

        //é»˜è®¤äº‹ä»¶æºæ¥å£
        [default,source] dispinterface IDispatchExecutableEvent;
    }; 
};
</code></pre>

<h2>äºŒã€å®šä¹‰è‡ªåŠ¨åŒ–æ¥å£ï¼ˆdispinterfaceï¼‰</h2>

<h3>2.1 è¯­æ³•</h3>

<pre><code class="odl language-odl">[attributes]
dispinterface æ¥å£å { 
    å‡½æ•°åˆ—è¡¨ 
};
</code></pre>

<h3>2.2 è¯­æ³•å…ƒç´ è¯´æ˜</h3>

<ul>
<li><code>attributes</code>:  ä¸€èˆ¬åªè¦æŒ‡å®š <code>uuid</code> å°±å¯ä»¥äº†ã€‚</li>
<li><code>functionlist</code>: æ¥å£ä¸­æ¯ä¸ªå‡½æ•°çš„åŸå‹åˆ—è¡¨ã€‚</li>
</ul>

<h3>2.3 å‡½æ•°å®šä¹‰</h3>

<pre><code class="odl language-odl">[attributes] returntype [calling convention] funcname(params);
</code></pre>

<ul>
<li><code>attributes</code>: å¯åŒ…æ‹¬ <code>helpstring</code>, <code>helpcontext</code>, <code>string</code>, <code>propget</code>, <code>propput</code>, <code>propputref</code>, <code>bindable</code>, <code>defaultbind</code>, <code>displaybind</code>, <code>vararg</code> ç­‰ã€‚</li>
<li><code>params</code>: å‚æ•°åˆ—è¡¨ï¼Œå¯ä»¥åŒ…æ‹¬ <code>in</code>, <code>out</code>, <code>optional</code>, <code>string</code> å±æ€§ã€‚</li>
</ul>

<h3>2.4 å¤‡æ³¨</h3>

<ul>
<li>aardio é‡Œæœ€å¸¸ç”¨çš„æ˜¯ dispinterface æ¥å£ï¼Œå¦åˆ™å¿…é¡»æ˜¯ç»§æ‰¿è‡ª IDispatch çš„è‡ªåŠ¨åŒ–æ¥å£ã€‚</li>
<li>dispinterface æ¥å£ä¸èƒ½ç»§æ‰¿è‡ªå…¶ä»–æ¥å£ï¼ˆå› ä¸ºå¿…é¡»ç»§æ‰¿è‡ªIDispatchï¼‰ã€‚</li>
<li>dispinterface ä¸éœ€è¦åœ¨æœ€åä¸€ä¸ªå‚æ•°æŒ‡å®šè¿”å›å€¼ï¼Œå¹¶ä¸”ä¹Ÿä¸éœ€è¦è¿”å›  <code>HRESULT</code> å€¼ï¼Œè€Œæ˜¯ç›´æ¥æŒ‡å®šå®é™…éœ€è¦çš„è¿”å›å€¼å°±å¯ä»¥äº†ã€‚</li>
<li>æ·»åŠ  [out] æ ‡è®°å‚æ•°èƒ½å£°æ˜è¾“å‡ºå‚æ•°ï¼Œå®é™…ä¸Š COM æ¥å£å¾ˆå°‘ç”¨è¿™ç§è¾“å‡ºå‚æ•°ï¼Œç›´æ¥ä½¿ç”¨è¿”å›å€¼æ›´ç®€å•ã€‚</li>
<li>æ‰€æœ‰ DISPID çš„å€¼å¿…é¡»å°äº 10000 å¹¶å¤§äºç­‰äº 0 ï¼Œå¤§äº 10000 çš„ DISPID ç”± aardio è‡ªåŠ¨åˆ†é…ã€‚</li>
</ul>

<h3>2.5 ç¤ºä¾‹</h3>

<pre><code class="odl language-odl">    [ uuid(1C8736BC-8C0C-4DB6-9FAD-1C6A0CDF1FA2) ]
    dispinterface  IDispatchSample{ 
        properties:
        methods:  
            [ id(10) ]
            void Test( [in] BSTR str,[in,out] VARIANT *out1,[in,out] VARIANT *out2);
    } 
</code></pre>

<h2>ä¸‰ã€å®šä¹‰æ¥å£ï¼ˆinterfaceï¼‰</h2>

<h3>2.1 è¯­æ³•</h3>

<pre><code class="odl language-odl">[attributes]
interface æ¥å£å [: çˆ¶æ¥å£å] { 
    å‡½æ•°åˆ—è¡¨ 
};
</code></pre>

<h3>2.2 è¯­æ³•å…ƒç´ è¯´æ˜</h3>

<ul>
<li><code>attributes</code>: å¯ä»¥åŒ…æ‹¬ <code>dual</code>, <code>helpstring</code>, <code>helpcontext</code>, <code>hidden</code>, <code>odl</code>, <code>oleautomation</code>, <code>uuid</code>, <code>version</code> å±æ€§ï¼Œå…¶ä¸­ <code>odl</code> å’Œ <code>uuid</code> æ˜¯å¿…é¡»çš„ã€‚</li>
<li><code>functionlist</code>: æ¥å£ä¸­æ¯ä¸ªå‡½æ•°çš„åŸå‹åˆ—è¡¨ã€‚</li>
</ul>

<h3>2.3 å‡½æ•°å®šä¹‰</h3>

<pre><code class="odl language-odl">[attributes] returntype [calling convention] funcname(params);
</code></pre>

<ul>
<li><code>attributes</code>: å¯åŒ…æ‹¬ <code>helpstring</code>, <code>helpcontext</code>, <code>string</code>, <code>propget</code>, <code>propput</code>, <code>propputref</code>, <code>bindable</code>, <code>defaultbind</code>, <code>displaybind</code>, <code>vararg</code> ç­‰ã€‚</li>
<li><code>params</code>: å‚æ•°åˆ—è¡¨ï¼Œå¯ä»¥åŒ…æ‹¬ <code>in</code>, <code>out</code>, <code>optional</code>, <code>string</code> å±æ€§ã€‚</li>
</ul>

<h3>2.4 å¤‡æ³¨</h3>

<ul>
<li>æ¥å£é‡Œçš„å‡½æ•°è¿”å› <code>HRESULT</code> å€¼ï¼ŒçœŸå®è¿”å›å€¼æŒ‡å®šä¸ºè¿”å›å‚æ•°ï¼Œå§‹ç»ˆæ˜¯æœ€åä¸€ä¸ªå‚æ•°ã€‚</li>
<li>åŒé‡æ¥å£å¿…é¡»ä» <code>IDispatch</code> ç»§æ‰¿ã€‚</li>
</ul>

<h3>2.5 ç¤ºä¾‹</h3>

<pre><code class="odl language-odl">[uuid(BFB73347-822A-1068-8849-00DD011087E8), version(1.0)]
interface Hello : IUnknown { 
    void HelloProc([in, string] unsigned char* pszString); 
    void Shutdown(void); 
};

[dual]
interface IMyInt : IDispatch { 
    [propget] HRESULT MyMessage([in, lcid] LCID lcid, [out, retval] BSTR* pbstrRetVal); 
    [propput] HRESULT MyMessage([in] BSTR rhs, [in, lcid] DWORD lcid);
    HRESULT SayMessage([in] long NumTimes, [in, lcid] DWORD lcid, [out, retval] BSTR* pbstrRetVal); 
}
</code></pre>

<h2>å››ã€å®šä¹‰ç»„ä»¶ç±»ï¼ˆcoclassï¼‰</h2>

<h3>3.1 è¯­æ³•</h3>

<pre><code class="odl language-odl">[attributes]
coclass ç±»å { 
    [attributes2] [interface | dispinterface] æ¥å£å; 
};
</code></pre>

<h3>3.2 è¯­æ³•å…ƒç´ è¯´æ˜</h3>

<ul>
<li><code>attributes</code>: <code>uuid</code> å±æ€§æ˜¯å¿…é¡»çš„ï¼Œå…¶å®ƒå±æ€§åŒ…æ‹¬ <code>helpstring</code>, <code>helpcontext</code>, <code>version</code>, <code>licensed</code>, <code>control</code>, <code>hidden</code>, <code>appobject</code> ç­‰ã€‚</li>
<li><code>attributes2</code>: <code>interface</code> æˆ– <code>dispinterface</code> çš„å¯é€‰å±æ€§ï¼ŒåŒ…æ‹¬ <code>source</code>, <code>default</code>, <code>restricted</code> ç­‰ã€‚</li>
<li><code>interfacename</code>: ç”¨ <code>interface</code> æˆ– <code>dispinterface</code> å£°æ˜çš„æ¥å£åã€‚</li>
</ul>

<h3>3.3 å¤‡æ³¨</h3>

<ul>
<li><code>coclass</code> å®šä¹‰ä¸€ä¸ªç±»ä½œä¸ºä¸€ä¸ªå®ç°ï¼Œå…è®¸ <code>QueryInterface</code> åœ¨æ¥å£é›†ä¹‹é—´æŸ¥è¯¢ã€‚</li>
</ul>

<h3>3.4 ç¤ºä¾‹</h3>

<pre><code class="odl language-odl">[uuid(BFB73347-822A-1068-8849-00DD011087E8), version(1.0), helpstring(&quot;A class&quot;), helpcontext(2481), appobject]
coclass myapp {
    [source] interface IMydocfuncs; 
    dispinterface DMydocfuncs; 
};

[uuid(00000000-0000-0000-0000-123456789019)]
coclass foo {
    [restricted] interface bar;
    interface bar;
}
</code></pre>

<p>æ­¤æ–‡æ¡£ç²¾ç®€äº† ODL è¯­æ³•çš„å…³é”®è¦ç´ ï¼Œä¾¿äºå¿«é€Ÿå…¥é—¨å’ŒæŒæ¡åŸºæœ¬å†™æ³•ã€‚</p>

<p><a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/library-guide/builtin/com/activeX/odl.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ·şÎñÆ÷±¨¸æ·ÃÎÊµÄÎÄ¼şÊÇÒş²ØµÄ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/library-guide/builtin/com/activeX/odl.md'" tppabs="https://www.aardio.com/zh-cn/doc/library-guide/builtin/com/activeX/odl.md">Markdown æ ¼å¼</a></p>

</body> 
</html>