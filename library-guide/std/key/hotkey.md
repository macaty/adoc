[aardio æ–‡æ¡£](../../../index.htm "aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ")

# è¶…çº§çƒ­é”®ä½¿ç”¨æŒ‡å—

æ ‡å‡†åº?key.hotkey ç”¨äºåˆ›å»ºè¶…çº§çƒ­é”®ï¼Œè¶…çº§çƒ­é”®æ˜¯åŸºäºä½çº§é”®ç›˜é’©å­ [key.hook](../../../library-reference/key/hook.html) å®ç°çš„ç³»ç»Ÿå…¨å±€æœ‰æ•ˆçš„å¢å¼ºçƒ­é”®ã€?
ç›¸å…³æ–‡æ¡£ï¼?[key.hotkey åº“å‚è€ƒ](../../../library-reference/key/hotkey/_.html) \| [è¶…çº§çƒ­é”®èŒƒä¾‹](https://www.aardio.com/zh-cn/doc/example/Windows/Hotkey/key.hotkey.html) \| [è¾“å…¥æ³•ä¸é”®ç›˜çŠ¶æ€æ£€æµ‹](imeState.html)

## â–?æ£€æµ‹è¶…çº§çƒ­é”®çš„åŸºæœ¬è§„åˆ™

1. å¦‚æœé¦–ä¸ªæŒ‰ä¸‹çš„é”®ä¸æ˜¯æ§åˆ¶é”®ï¼Œåˆ™ä¸éœ€è¦åŒæ—¶æŒ‰ä½å¤šä¸ªé”®ã€?   å¦‚æœæŒ‰ä¸‹çš„é”®æ˜¯å·²æ³¨å†Œçš„çƒ­é”®å‰åŠéƒ¨åˆ†ï¼Œåˆ™é˜»æ­¢å½“å‰æŒ‰é”®ç»§ç»­å‘é€ã€?   å¦‚æœç»§ç»­æŒ‰é”®å·²ä¸ç¬¦åˆä»»ä½•çƒ­é”®ï¼Œåˆ™é‡Šæ”¾å·²æ•è·çš„æŒ‰é”®å¹¶æŒ‰åŸé¡ºåºé‡æ–°å‘é€ã€?2. å¦‚æœé¦–æ¬¡æŒ‰ä½çš„æ˜¯æ§åˆ¶é”®ï¼ˆ CTRL,ALT,SHIFT,WIN ä¹‹ä¸€ï¼‰ï¼Œåˆ™å¿…é¡»åŒæ—¶æŒ‰ä½å¤šä¸ªé”®æ‰ç®—å·²å®Œæˆçƒ­é”®ã€?   å¦‚æœè¿™æ ·åŒæ—¶æŒ‰ä½çš„å¤šä¸ªé”®æ˜¯ä¸€ä¸ªå·²å®Œæˆçš„çƒ­é”®ï¼Œä½†åŒæ—¶åˆæ˜¯å…¶ä»–çƒ­é”®çš„å‰åŠéƒ¨åˆ†ï¼Œåˆ™å¿…é¡»æ”¾å¼€æ‰€æœ‰é”®æ‰ä¼šç”Ÿæ•ˆã€?3. å¦‚æœæ³¨å†Œå•ä¸ªæ§åˆ¶é”®çƒ­é”®ï¼Œå¹¶ä¸”åŠ ä¸Š @ å‰ç¼€ï¼Œåˆ™æ”¾å¼€è¯¥é”®ï¼ˆä¸”ä¸­é—´æ²¡æœ‰æŒ‰å…¶ä»–é”®ï¼‰æ‰ç®—å®Œæˆçƒ­é”®ã€?4. æŒ‰é”®ä¿æŒæŒ‰ä¸‹ä¸æ”¾æ—¶ä¸ä¼šè§¦å‘å¤šæ¬¡è¶…çº§çƒ­é”®ã€?
è¶…é”®çƒ­é”®ä¸­ä»»ä½•é”®åéƒ½åªè¡¨ç¤ºè¯¥é”®åæ‰€åœ¨çš„å•ä¸ªæŒ‰é”®ï¼Œä¸åŒ…å«ä¸Šæ¡£é”®ã€‚ä¾‹å¦‚çƒ­é”?`~hi` æŒ‡è¿ç»­æŒ‰ 3 ä¸ªé”®ï¼Œå…¶ä¸?`~` ä¸æ˜¯æŒ‡åŒæ—¶æŒ‰ `Shift + ~` è¿™ä¸¤ä¸ªé”®ã€?
## â–?è¶…çº§çƒ­é”®æ ¼å¼è¯´æ˜

ä¾‹å¦‚æ³¨å†Œäº†ä»¥ä¸?4 ä¸ªçƒ­é”®ï¼Œåˆ™å¯¹åº”çƒ­é”®æ ¼å¼çš„çƒ­é”®è§¦å‘è§„åˆ™å¦‚ä¸‹ï¼?
- çƒ­é”® `~hi` ç”¨æ³•ï¼šè¿ç»­æŒ‰ 3 ä¸ªé”®ï¼Œæ¯ä¸ªé”®éƒ½è¦æ”¾å¼€ã€?- çƒ­é”® `SHIFT+Q,Q` ç”¨æ³•ï¼šæŒ‰ä¸?`Shift` ä¸æ”¾ï¼Œå†æŒ?2 ä¸?`Q`ã€?- çƒ­é”® `Ctrl+K` ç”¨æ³•ï¼šæŒ‰ä¸?`Ctrl` ä¸æ”¾ï¼Œå†æŒ?`K`, ç„¶åéƒ½æ”¾å¼€ã€?- çƒ­é”® `Ctrl+K,K` ç”¨æ³•ï¼šæŒ‰ä¸?`Ctrl` ä¸æ”¾ï¼Œå†æŒ?2 æ¬?`K`ï¼ˆå› ä¸ºä¸æ˜¯å…¶ä»–çƒ­é”®çš„å‰åŠéƒ¨åˆ†ï¼Œä¸éœ€è¦ç­‰å¾…æ”¾å¼€ï¼‰ã€?
## â–?æ³¨å†Œè¶…çº§çƒ­é”®

ä»¥ä¸‹æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„è¶…çº§çƒ­é”®ç¨‹åºç¤ºä¾‹ï¼?
```aardio aardio
import win.ui;
/*DSG{{*/
var winform = win.form(text="è¶…çº§çƒ­é”®ç¤ºä¾‹")
winform.add(
edit={cls="edit";left=32;top=35;right=725;bottom=414;edge=1;multiline=1}
)
/*}}*/

import key.hotkey;
import win.dlg.chineseNumber;

superHotkey = key.hotkey();
superHotkey.loadTable({
    // æŒ?Ctrl+ $ é”®æ‰“å¼€å¤§å†™é‡‘é¢ä¸ä¸­æ–‡æ•°å­—è¾“å…¥æ¡†
    ["Ctrl+$"] = function(hFocus){
        win.dlg.chineseNumber().show();
    };
})

winform.show();
win.loopMessage();

```

è¦æ³¨æ„å¿…é¡»åœ¨åŒ…å«çª—å£çš„ç•Œé¢çº¿ç¨‹ä¸­æ‰èƒ½ä½¿ç”¨ key.hotkey ï¼?åˆ›å»º key.hotkey å¯¹è±¡æ—¶å¿…é¡»æŒ‡å®šä¸€ä¸?winform çª—å£å¯¹è±¡ä½œä¸ºå‚æ•°ã€?
superHotkey.loadTable å‡½æ•°ç”¨äºæ‰¹é‡å¤„å†Œçƒ­é”®çƒ­é”®ï¼Œå‚æ•?@1 æŒ‡å®šçƒ­é”®é…ç½®è¡¨ã€‚çƒ­é…ç½®è¡¨ä¸­æ¯ä¸ªåå€¼å¯¹éƒ½ä¼šè°ƒç”¨ superHotkey.regStr å‡½æ•°æ³¨å†Œä¸ºçƒ­é”®ï¼Œé”®åæŒ‡å®šè¶…çº§çƒ­é”®ï¼Œå¯¹åº”çš„é”®å€¼æŒ‡å®šçƒ­é”®å›è°ƒå‡½æ•°ã€‚çƒ­é”®å›è°ƒå‡½æ•°ç”¨äºå“åº”çƒ­é”®å¹¶æ‰§è¡ŒæŒ‡å®šçš„ä»£ç ã€?
çƒ­é…ç½®è¡¨ä¸­æŒ‡å®šè¶…çº§çƒ­é”®çš„é”®åå¯ä»¥æ˜?[key.VK åº“](../../../library-reference/key/VK.html) å®šä¹‰çš„è‹±æ–‡é”®åå­—ç¬¦ä¸²ï¼Œå°¾éƒ¨å¯ç”?`'\0'` è¡¨ç¤ºç»ˆæ­¢é”®ã€‚çƒ­é”®ä¸åŒºåˆ†å¤§å°å†™ï¼Œå­—ç¬¦é—´ä¸èƒ½æœ‰ç©ºç™½ã€‚å¦‚æœè¶…çº§çƒ­é”®çš„ç¬¬ä¸€ä¸ªæŒ‰é”®æ˜¯æ§åˆ¶é”®å¹¶ç´§è·Ÿä¸€ä¸ªåŠ å·ï¼Œåé¢æ‰€æœ‰é”®åéƒ½è¦ä½¿ç”¨é€—å·åˆ†å¼€ï¼Œä¾‹å¦?`Ctrl+Q,Q` ã€?
çƒ­é”®å›è°ƒå‡½æ•°è¿”å› true è¡¨ç¤ºå…è®¸ç³»ç»Ÿç»§ç»­å‘é€æŒ‰é”®ï¼Œå¦åˆ™å–æ¶ˆè¯¥æŒ‰é”®ï¼Œä¸å†ç»§ç»­å‘é€ã€?å¦‚æœçƒ­é”®å›è°ƒå‡½æ•°è¿”å›ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œåˆ™å–æ¶ˆè¯¥æŒ‰é”®ä¸å†å‘é€ï¼Œå¹¶åœ¨è¿”å›å‡½æ•°ä»¥åå¼‚æ­¥å»¶æ—¶æ‰§è¡Œè¿”å›çš„å‡½æ•°å¯¹è±¡ã€?
## â–?ImTip çš„è¶…çº§çƒ­é”?[\#](\#imtip)

å¼€æºè½¯ä»?[ImTip](http://imtip.aardio.com/) çš„è¶…çº§çƒ­é”®åŸºäº?key.hotkey åº“ã€?
åœ?ImTip ä¸­ç‚¹å‡»ã€ç¼–è¾‘è¶…çº§çƒ­é”®ã€æŒ‰é’®å°±å¯ä»¥è°ƒç”¨ aardio ç¼–è¾‘å™¨æ‰“å¼€ ImTip çƒ­é”®é…ç½®ä»£ç ï¼?æ–‡ä»¶è·¯å¾„ä¸?`%LocalAppData%\aardio\std\ImTip\.hotkey\hotkey.aardio` ï¼‰ã€?
![ImTip è¶…çº§è¶…é”®](../../../../../../imtip.aardio.com/screenshots/hotkey.jpg)

åªè¦æ˜¯ä» ImTip ä¸­ç‚¹å‡»ã€ç¼–è¾‘è¶…çº§çƒ­é”®ã€æŒ‰é’®æ‰“å¼€ hotkey.aardio ï¼Œé‚£ä¹ˆåœ¨ aardio ä¸­ä¿å­˜å¯¹ hotkey.aardio çš„ä¿®æ”¹æ—¶æ–°çš„çƒ­é”®é…ç½®å°±ä¼šåœ?ImTip ä¸­ç«‹å³ç”Ÿæ•ˆã€?
ImTip è¿è¡Œè¶…çº§çƒ­é”®æ—¶ä¼šè‡ªåŠ¨æŸ¥æ‰¾ aardio å¼€å‘ç¯å¢ƒï¼Œå¹¶ä»¥ aardio ç›®å½•ä½œä¸ºè¿è¡Œè¶…çº§çƒ­é”®çš?[åº”ç”¨ç¨‹åºæ ¹ç›®å½•](../../builtin/io/path.html#app-path)ï¼Œå› æ­¤è¶…çº§çƒ­é”®å¯ä»¥è°ƒç”?aardio å¼€å‘ç¯å¢ƒçš„æ‰€æœ‰åº“ã€?
ç¤ºä¾‹ï¼?
```aardio aardio
import win.ui;

/*å¼€å‘ç¯å¢ƒï¼ˆè¯·å‹¿ä¿®æ”¹ï¼‰{{*/
import win.ui;

//å¦‚æœæ˜¯åœ¨å¼€å‘ç¯å¢ƒä¸­å¯åŠ¨ï¼Œè€Œä¸æ˜¯ç”± ImTip å¯åŠ¨
if(_STUDIO_INVOKED && ...!="ImTip"){

    //æ˜¾ç¤ºæµ‹è¯•çª—å£
    var winform = win.form(text="è¶…çº§çƒ­é”®";right=759;bottom=469)
    winform.add(
    edit={cls="edit";left=29;top=24;right=727;bottom=420;db=1;dl=1;dr=1;dt=1;edge=1;multiline=1;z=1}
    )

    //åœ?ImTip ä¸­å¯åŠ¨çƒ­é”®å°±ä¸å¿…è¦æ˜¾ç¤ºè¿™ä¸ªæµ‹è¯•çª—å?    winform.show();
}
/*}}*/

import key.hotkey;
import win.dlg.chineseNumber;

superHotkey = key.hotkey();
superHotkey.loadTable({
    // æŒ?Ctrl+ $ é”®æ‰“å¼€å¤§å†™é‡‘é¢ä¸ä¸­æ–‡æ•°å­—è¾“å…¥æ¡†
    ["Ctrl+$"] = function(hFocus){
        win.dlg.chineseNumber().show();
    };
})

win.loopMessage();

```

æ³¨æ„ä¸è¦åˆ é™¤ä¸Šé¢çš?hotkey.aardio ä»£ç ä¸­æ£€æµ?aardio å¼€å‘ç¯å¢ƒä¸ ImTip è¿è¡Œç¯å¢ƒçš„ä»£ç ã€?
ImTip åˆ›å»ºç‹¬ç«‹çš„å·¥ä½œçº¿ç¨‹è¿è¡Œè¶…çº§çƒ­é”®ï¼ˆ hotkey.aardio ï¼‰ï¼Œæ¯æ¬¡æ›´æ–°è¶…çº§çƒ­é”®é…ç½®éƒ½ä¼šé€€å‡ºåŸæ¥çš„è¶…çº§çƒ­é”®çº¿ç¨‹å¹¶ä¸”åˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚åœ¨è¶…çº§çƒ­é”®ä¸­å¯è°ƒç”¨ [processs.imTip](https://www.aardio.com/zh-cn/doc/language-reference/process/imTip/_.html) åº“å‘ ImTip ä¸»ç¨‹åºæˆ–ä¸»çª—å£å‘é€æŒ‡ä»¤ã€?
## â–?é¿å…é˜»å¡é”®ç›˜æ¶ˆæ¯çš„è€—æ—¶æ“ä½œ [\#](\#thread)

è¶…çº§çƒ­é”®åŸºäºä½çº§é”®ç›˜é’©å­ï¼Œæ‰€åœ¨çº¿ç¨‹å¿…é¡»è°ƒç”?`win.loopMessage()` å¯åŠ¨æ¶ˆæ¯å¾ªç¯ã€?
è¶…çº§çƒ­é”®æ‰€åœ¨çº¿ç¨‹åº”é¿å…é˜»å¡æ¶ˆæ¯å¾ªç¯çš„è€—æ—¶æ“ä½œï¼Œä»»ä½•é˜»å¡æ¶ˆæ¯å¾ªç¯æˆ–çƒ­é”®å›è°ƒå‡½æ•°çš„æ“ä½œæ‰§è¡Œæ—¶é—´ä¸åº”è¶…è¿?200 æ¯«ç§’ã€‚å¦‚æœé˜»å¡æ—¶é—´è¶…è¿‡ä¸€ç§’æˆ–è¶…è¿‡æ³¨å†Œè¡¨é™åˆ¶çš„æ›´å°æ—¶é—´ï¼Œç³»ç»Ÿå¯èƒ½ä¼šç›´æ¥åˆ é™¤é”®ç›˜é’©å­ï¼ˆå¯¼è‡´è¶…çº§çƒ­é”®ä¸å¯ç”¨ï¼‰ã€?
**å¦‚æœè¶…çº§çƒ­é”®å‡ºç°å¼‚å¸¸ï¼ˆä¾‹å¦‚çƒ­é”®å¤±æ•ˆï¼Œå¯¹æŒ‰é”®çš„æ‹¦æˆªå¤±æ•ˆï¼Œæœ¬åº”è¢«å–æ¶ˆçš„æŒ‰é”®å‘é€åˆ°äº†ç›®æ ‡çª—å£ç­‰ç­‰é—®é¢˜ï¼‰ï¼Œåº”å½“é¦–å…ˆæ£€æŸ¥è¶…çº§çƒ­é”®æ‰€åœ¨çº¿ç¨‹æ˜¯å¦æ‰§è¡Œäº†é˜»å¡é’©å­æ¶ˆæ¯çš„è€—æ—¶æ“ä½œã€?*

å»ºè®®ç”¨å•ç‹¬çš„çº¿ç¨‹è¿è¡Œè¶…çº§çƒ­é”®ï¼Œè¶…çº§çƒ­é”®å›è°ƒå‡½æ•°ä¸­åˆ›å»ºæ–°çš„çº¿ç¨‹æ‰§è¡Œè€—æ—¶æ“ä½œã€‚è¯·å‚è€ƒï¼š [åˆ›å»ºå¤šçº¿ç¨‹](../../../guide/language/thread.html)ã€?
## â–?ç¤ºä¾‹: æŒ?`Ctrl+I` è°ƒç”¨ AI åŠ©æ‰‹å¤„ç†é€‰åŒºæ–‡æœ¬ [\#](\#ai)

åœ¨ä¸‹é¢çš„è¶…çº§çƒ­é”®ç¤ºä¾‹ä¸­æˆ‘ä»¬è°ƒç”?web.rest.aiChat åˆ›å»ºäº†ä¸€ä¸?AI åŠ©æ‰‹ä»¥å¤„ç†é€šè¿‡ winex.selection è·å–çš„é€‰åŒºæ–‡æœ¬ã€‚AI åŠ©æ‰‹éœ€è¦è°ƒç”¨è¿œç¨‹æ¥å£ï¼Œå‘é€?HTTP è¯·æ±‚å±äºè€—æ—¶æ“ä½œä¸”ä¼šé˜»å¡æ¶ˆæ¯å¾ªç¯ï¼Œå› æ­¤æˆ‘ä»¬åˆ›å»ºå¤šçº¿ç¨‹æ‰§è¡Œè¿™äº›è€—æ—¶æ“ä½œä»¥é¿å…é˜»å¡é”®ç›˜é’©å­æ¶ˆæ¯ã€?
```aardio aardio

import win.ui;
/*DSG{{*/
var winform = win.form(text="è¶…çº§çƒ­é”®ç¤ºä¾‹")
winform.add(
edit={cls="edit";left=32;top=35;right=725;bottom=414;edge=1;multiline=1}
)
/*}}*/

import winex.selection;
import key.hotkey;
superHotkey = key.hotkey();

superHotkey.loadTable({
    // æŒ?Ctrl+ I è§¦å‘çƒ­é”®
    ["Ctrl+I"] = function(hFocus){
        //è·å–å½“å‰é€‰åŒºæ–‡æœ¬
        var txt = winex.selection.get(true);

        if(!#txt) {
            return true;
        }

        //åˆ›å»ºå¤šçº¿ç¨‹ä»¥æ‰§è¡Œè€—æ—¶æ“ä½œï¼Œä»¥é¿å…é˜»å¡é”®ç›˜é’©å­æ¶ˆæ¯å¯¼è‡´çƒ­é”®å¤±æ•ˆã€?        thread.invoke(
            function(txt){

                import web.rest.aiChat;
                import web.rest.aiChat.message;
                import key;

                var ai = web.rest.aiChat(
                    key = "sk-è¯·ä¿®æ”¹å¯†é’?;
                    url = "https://api.deepseek.com/v1";//æ¥å£åœ°å€
                    model = "deepseek-chat";//æ¨¡å‹åç§°é¦–å­—ç¬¦ä¸º @ åˆ™ä½¿ç”?Anthropic æ¥å£
                    temperature = 0.5;//æ¸©åº¦
                    maxTokens = 1024,//æœ€å¤§å›å¤é•¿åº?                )

                //åˆ›å»º AI ä¼šè¯æ¶ˆæ¯é˜Ÿåˆ—
                var msg = web.rest.aiChat.message();

                //æ·»åŠ ç³»ç»Ÿæç¤ºè¯?                msg.system("ä½ æ˜¯ä¸€ä¸ªç¿»è¯‘åŠ©æ‰‹ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥ä¸»è¦ä¸ºä¸­æ–‡è¯·ç¿»è¯‘ä¸ºè‹±æ–‡ï¼Œåä¹‹åˆ™å°†è¾“å…¥ç¿»è¯‘ä¸ºè‹±æ–‡ã€?)

                //æ·»åŠ ç”¨æˆ·æç¤ºè¯?                msg.prompt(txt);

                var ok,err = ai.messages(msg,function(delta){
                    //ä»¥æ‰“å­—æ–¹å¼é€æ­¥è¾“å‡º AI å›å¤çš„å¢é‡æ–‡æœ¬åˆ°ç›®æ ‡è¾“å…¥æ¡†ã€?                    key.sendString(delta)
                } );
            },txt
        )

    };
})

winform.show();
win.loopMessage();

```

## â–?ç¤ºä¾‹: æŒ?`Ctrl+I` åˆ›å»ºæµè§ˆå™¨æ§ä»¶å±•ç¤?AI æœç´¢ç»“æœ

åœ¨ä¸‹é¢çš„è¶…çº§çƒ­é”®ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨ web.view åˆ›å»º WebView2 æµè§ˆå™¨æ§ä»¶ä»¥å±•ç¤º AI æœç´¢ç»“æœã€?
åˆ›å»ºæµè§ˆå™¨æ§ä»¶å¯èƒ½ä¼šæœ‰ä¸æ˜“å¯Ÿè§‰çš„çŸ­æš‚é˜»å¡è¿‡ç¨‹ã€‚å¦‚æœä¸ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œé˜»å¡é”®ç›˜é’©å­æ¶ˆæ¯å°±å¯èƒ½å¯¼è‡´çƒ­é”®å¼‚å¸¸æˆ–å¤±æ•ˆã€‚ä¾‹å¦‚è·å–çš„é€‰åŒºæ–‡æœ¬éç©ºæ—¶æœ¬åº”å–æ¶ˆçš„ `Ctrl+I` è¢«å‘é€åˆ°ç›®æ ‡çª—å£ï¼Œæˆ–å¯¼è‡´åç»­çš„è¶…çº§çƒ­é”®å¤±æ•ˆã€?
ä¸‹é¢æˆ‘ä»¬åœ¨çƒ­é”®å›è°ƒå‡½æ•°ä¸­ç”?thread.invoke åˆ›å»ºå¤šçº¿ç¨‹å°±å¯ä»¥é¿å…ä¸Šè¿°çš„é—®é¢˜ã€?
```aardio aardio
import win.ui;
/*DSG{{*/
var winform = win.form(text="è¶…çº§çƒ­é”®ç¤ºä¾‹")
winform.add(
edit={cls="edit";left=32;top=35;right=725;bottom=414;edge=1;multiline=1}
)
/*}}*/

import winex.selection;
import key.hotkey;
superHotkey = key.hotkey();

superHotkey.loadTable({
    // æŒ?Ctrl+ I è§¦å‘çƒ­é”®
    ["Ctrl+I"] = function(hFocus){

        //è·å–å½“å‰é€‰åŒºæ–‡æœ¬
        var txt = winex.selection.get(true);
        if(!#txt) return true;//é€‰åŒºæ–‡æœ¬ä¸ºç©ºï¼Œç»§ç»­å‘é€æŒ‰é”?
        //åˆ›å»ºå¤šçº¿ç¨?        thread.invoke(
            function(txt){
                import win.ui;
                var winform = win.form(
                    text="ImTip - AI æœç´¢";right=759;bottom=469;
                    parent=win.getForeground();//å‰ç½®çª—å£
                    topmost=true;//çª—å£ä¿æŒåœ¨æœ€é¡¶å±‚
                );

                //åˆ›å»ºæµè§ˆå™?                import web.view;
                var wb = web.view(winform);
                wb.go("https://metaso.cn",{q=txt});
                winform.show();

                win.loopMessage()
            },txt
        );
    };
})

winform.show();
win.loopMessage();

```

è¿™é‡Œæœ‰ä¸€ä¸ªå°æŠ€å·§ï¼Œåœ¨åå°çº¿ç¨‹åˆ›å»ºçª—å£æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `parent=win.getForeground();` å‚æ•°å°†çˆ¶çª—å£æŒ‡å®šä¸ºå‰æ™¯çª—å£ä»¥é¿å…çª—å£å‡ºç°åœ¨åå°ã€‚è€?`topmost=true` å‚æ•°è®©çª—å£ä¿æŒæ˜¾ç¤ºåœ¨æœ€é¡¶å±‚ã€?
## â–?ç¤ºä¾‹: æŒ?`Ctrl+Shift+I` æŸ¥å•è¯ï¼Œè°ƒç”¨ AI ç¿»è¯‘

```aardio aardio
import win.ui;
import win.ui;
/*DSG{{*/
var winform = win.form(text="è¶…çº§çƒ­é”®ç¤ºä¾‹")
winform.add(
edit={cls="edit";left=32;top=35;right=725;bottom=414;edge=1;multiline=1}
)
/*}}*/

import winex.tooltip;
import winex.selection;
import winex.caret;
import key.hotkey;

superHotkey = key.hotkey();
superHotkey.loadTable({

    // æŒ?Ctrl + Shift + I è§¦å‘çƒ­é”®
    ["Ctrl+Shift+I"] = function(hFocus){

        //è·å–å½“å‰é€‰åŒºæ–‡æœ¬
        var txt = winex.selection.get(true);
        if(!#txt) return true;//é€‰åŒºæ–‡æœ¬ä¸ºç©ºï¼Œç»§ç»­å‘é€æŒ‰é”?
        //æœ¬åœ°è‹±ä¸­ç¿»è¯‘æŸ¥è¯
        import string.words;
        var cn,en = string.words(txt)
        if(cn){
            var x,y = winex.caret.getPos();
            winex.tooltip.popup(cn,x,y - 50);
        }

        //æœ—è¯»å•è¯
        if(en){
            //ç”?:= æ“ä½œç¬¦é¿å…é‡å¤åˆ›å»ºæ§ä»?            wmPlayer := com.CreateObject("WMPlayer.OCX");
            wmPlayer.url = "https://dict.youdao.com/dictvoice?audio="+txt+"&type=2";

            return;
        }

        //å¦‚æœä¸åŒ…å«ç©ºæ ¼åˆ†éš”çš„è‹±æ–‡å•è¯åˆ™é€€å‡?        if(!string.find(txt,"\a+\s+\a+")){
            return true;
        }

        //åˆ›å»ºå¤šçº¿ç¨‹ä»¥æ‰§è¡Œè€—æ—¶æ“ä½œï¼Œä»¥é¿å…é˜»å¡é”®ç›˜é’©å­æ¶ˆæ¯å¯¼è‡´çƒ­é”®å¤±æ•ˆã€?        thread.invoke(
            function(txt){
                import web.rest.aiChat;
                import web.rest.aiChat.message;
                import key;

                var ai = web.rest.aiChat(
                    key = "sk-è¯·ä¿®æ”¹å¯†é’?;
                    url = "https://api.deepseek.com/v1";//æ¥å£åœ°å€
                    model = "deepseek-chat";//æ¨¡å‹åç§°é¦–å­—ç¬¦ä¸º @ åˆ™ä½¿ç”?Anthropic æ¥å£
                    temperature = 0.5;//æ¸©åº¦
                    maxTokens = 1024,//æœ€å¤§å›å¤é•¿åº?                )

                //åˆ›å»º AI ä¼šè¯æ¶ˆæ¯é˜Ÿåˆ—
                var msg = web.rest.aiChat.message();

                //æ·»åŠ ç³»ç»Ÿæç¤ºè¯?                msg.system("ä½ æ˜¯ä¸€ä¸ªç¿»è¯‘åŠ©æ‰‹ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥ä¸»è¦ä¸ºä¸­æ–‡è¯·ç¿»è¯‘ä¸ºè‹±æ–‡ï¼Œåä¹‹åˆ™å°†è¾“å…¥ç¿»è¯‘ä¸ºè‹±æ–‡ã€?)

                //æ·»åŠ ç”¨æˆ·æç¤ºè¯?                msg.prompt("è¯·ç¿»è¯?"+txt);

                //è·å–æ–‡æœ¬é€‰åŒºåæ ‡
                import winex.caret;
                var x,y = winex.caret.getPos(,-50);

                import winex.tooltip;
                var ok,err = ai.messages(msg,function(delta){

                    //å¢é‡æ˜¾ç¤ºå±å¹•æç¤º
                    if( winex.tooltip.popupDelta(delta,x,y ) ){
                        thread.delay(3000);//å·²å®Œæˆè¾“å‡ºï¼Œå»¶æ—¶é¿å…çº¿ç¨‹é€€å‡ºå¯¼è‡´æç¤ºç«‹å³å…³é—­ã€?                    }
                } );

                //æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                if(err)winex.tooltip.popupDelta(err,x,y )
            },txt
        )
    }
})

win.loopMessage();

```

## â–?è°ƒç”¨ ImTip èŠå¤©åŠ©æ‰‹ [\#](\#imtip-ai-chat)

å¦‚æœä¸éœ€è¦ä¼šè¯ç•Œé¢ï¼Œå¯å‚è€ƒå‰é¢çš„èŒƒä¾‹ï¼?[è‡ªåŠ¨è¾“å…¥å›å¤æ–‡æœ¬åˆ°ç›®æ ‡çª—å£](#ai) ã€?
ä½¿ç”¨ [process.imTip](../../../library-reference/process/imTip/_.html) åº“å¯è‡ªåŠ¨æ‰“å¼€ ImTip çš?AI èŠå¤©åŠ©æ‰‹ä¼šè¯ç•Œé¢ï¼Œé€šè¿‡ chat å‚æ•°è‡ªåŠ¨é€‰æ‹©æŒ‡å®š AI åŠ©æ‰‹é…ç½®åç§°ï¼Œå¹¶ä¸”è‡ªåŠ¨å‘é€?q å‚æ•°æŒ‡å®šçš„é—®é¢˜ã€?
ç¤ºä¾‹ï¼?
```aardio aardio
import win.ui;
/*DSG{{*/
var winform = win.form(text="è¶…çº§çƒ­é”®ç¤ºä¾‹")
winform.add(
edit={cls="edit";left=32;top=35;right=725;bottom=414;edge=1;multiline=1}
)
/*}}*/

import process.imTip;
import winex.selection;
import key.hotkey;
superHotkey = key.hotkey();

superHotkey.loadTable({
    // æŒ?Ctrl+ I è§¦å‘çƒ­é”®
    ["Ctrl+I"] = function(hFocus){

        //è·å–å½“å‰é€‰åŒºæ–‡æœ¬
        var txt = winex.selection.get(true);
        if(!#txt) return true;//é€‰åŒºæ–‡æœ¬ä¸ºç©ºï¼Œç»§ç»­å‘é€æŒ‰é”?
        process.imTip(
            chat = "",//å¯æŒ‡å®?ImTip çš?AI åŠ©æ‰‹é…ç½®åï¼Œä¹Ÿå¯æŒ‡å®šç©ºå­—ç¬¦ä¸²
            q = txt //æŒ‡å®šè¦å‘é€çš„é—®é¢˜
        )
    };
})

winform.show();
win.loopMessage();

```

ImTip å¢åŠ  AI åŠ©æ‰‹é…ç½®å›¾è§£ï¼?
![ImTip å¢åŠ æˆ–ä¿®æ”?AI é…ç½®](../../../../../../imtip.aardio.com/screenshots/aiChat-setting.gif)

æˆ‘ä»¬è¿˜å¯ä»¥è°ƒç”?process.imTip å?ImTip å‘é€å…¶ä»–æŒ‡ä»¤ï¼Œä¾‹å¦‚è‡ªåŠ¨ç¦ç”¨æˆ–å¯ç”¨è¾“å…¥æ³•çŠ¶æ€æç¤ºï¼š

```aardio aardio
import process.imTip;
process.imTip.imeSwitch();

```

## â–?æ›´å¤šè¶…çº§çƒ­é”®ç¤ºä¾‹

å…ˆäº†è§£å‡ ä¸ªåœ¨è‡ªåŠ¨åŒ–ä¸­è¾ƒå¸¸ç”¨çš„å‘é€æŒ‰é”®ä¸å­—ç¬¦ä¸²çš„æ–¹æ³•ï¼?
```aardio aardio
//å‘é€å­—ç¬¦ä¸²
key.sendString("è¿™é‡Œæ˜¯è¦å‘é€çš„å­—ç¬¦ä¸?)

//å‘é€æŒ‰é”?key.send("/")

//å‘é€æŒ‰é”?key.press("ENTER")

```

ä¸‹é¢æ˜¯ä¸€äº›è¶…çº§çƒ­é”®ç¤ºä¾‹ï¼ŒImTip é»˜è®¤å·²ç»å¯¼å…¥äº†ä¸‹é¢èŒƒä¾‹ä¸­è¿™äº›å¸¸ç”¨çš„åº“ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œå°†æ–°çš?aardio åº“æŒ‰åŸè·¯å¾„æ”¾åˆ?ImTip.exe æ‰€åœ¨ç›®å½•çš„ /lib/ ç›®å½•ä¸‹ï¼Œç„¶åä½¿ç”¨ import è¯­å¥å¯¼å…¥ã€?
```aardio aardio
/*å¯¼å…¥åº“{{*/
import fsys;
import fsys.lnk;
import process;
import process.cache;
import process.popen;
import process.curl;
import win.ui.ctrl.pick;
import winex;
import winex.mouse;
import winex.key;
import winex.accObject;
import win.dlg.chineseNumber;
import win.clip;
import winex.tooltip;
import winex.selection;
import winex.caret;
import win.reg;
import mouse;
import key;
import key.ime;
import key.hotkey;
/*}}*/

superHotkey = key.hotkey();
superHotkey.loadTable({
["Ctrl+#"] = function(hFocus){
    //æ‰“å¼€è°ƒè‰²å™?    var dlg = win.ui.ctrl.pick();
    win.setTopmost(dlg.hwnd,true);
    dlg.doModal();
};

//å¤åˆ¶è¾“å…¥ç„¦ç‚¹æ‰€åœ¨çª—å£ç±»å?["Ctrl+F12"] = function(hFocus){
    var cls = win.getClass(hFocus);
    winex.tooltip.trackPopup(cls + " å·²å¤åˆ¶åˆ°å‰ªè´´æ?");
    win.clip.write(cls);
};

//è¿è¡ŒQQ
["Ctrl+Q,Q"] = function(hFocus){
    var qqPath = process.cache.find("qq.exe");
    process.execute( qqPath )
};

["@Shift"] = function(hFocus){
    /*
    å¦‚æœ Ctrl,Shift,Alt,Win ç­‰å•æ§åˆ¶é”®ä½œä¸ºçƒ­é”®ï¼Œæ˜¾åœ¨å‰é¢åŠ ä¸Š@ å­—ç¬¦ã€?    åˆ™ä»…åœ¨æŒ‰ä¸‹å¹¶æ”¾å¼€è¯¥é”®åï¼ˆä¸­é—´æ²¡æœ‰æŒ‰å…¶ä»–é”®ï¼‰æ‰ä¼šè§¦å‘çƒ­é”®ã€?    è¿™é€šå¸¸ä¸å¹²æ‰°è¯¥é”®åŸæœ‰çƒ­é”®ï¼ˆå› ä¸ºä¸€èˆ¬éƒ½æ˜¯æŒ‰ä¸‹è§¦å‘ï¼‰ã€?    */
}

//æŒ‰å¤§å†™è‡ªåŠ¨åˆ‡æ¢åˆ°è‹±æ–‡è¾“å…¥
["CAPSLK"]  = function(hFocus){
    key.ime.setOpenStatus(false);
    key.ime.setConversionMode(0);

    return true;//å…è®¸æŒ‰é”®ç»§ç»­å‘é€ï¼Œä¸æ”¹å˜å¤§å°å†™é”®çš„é»˜è®¤è¡Œä¸º
};

//æŒ?Ctrl + .  åˆ‡æ¢åˆ°ä¸­æ–‡è¾“å…?+ ä¸­æ–‡æ ‡ç‚¹ + å°å†™
["Ctrl+."]  = function(hFocus){
    var openState,mode = key.ime.state();
    if( openState && !key.ime.capital() ) return true; //å½“å‰å·²ç»æ˜¯ä¸­æ–‡è¾“å…¥æ¨¡å¼ï¼Œä¸æ”¹å˜é»˜è®¤è¡Œä¸?
    key.up("Ctrl");//å…ˆæ”¾å¼€ Ctrl é”?
    //å¦‚æœæ˜¯å¤§å†™çŠ¶æ€ï¼Œåˆ‡æ¢ä¸ºå°å†?    if(key.ime.capital())    key.press("CAPSLK")

    //è‹±æ–‡ç›´æ¥åˆ‡ä¸­æ–?+ ä¸­æ–‡æ ‡ç‚¹
    key.ime.setOpenStatus(true); //æ‰“å¼€è¾“å…¥æ³?    key.ime.setConversionMode(1|0x400); //åˆ‡æ¢åˆ°ä¸­æ–‡çŠ¶æ€ï¼Œè¿™ä¸€æ­¥ä¸èƒ½çœç•?
    //å†æ¬¡å°è¯•ç”¨é”®ç›˜åˆ‡æ¢ä¸­æ–‡æ ‡ç‚¹ï¼Œè¿™ä¸€æ­¥ä¸èƒ½çœç•?    key.combine("CTRL",".");

    //ç°åœ¨å†æ¬¡æ£€æµ‹ä¸­æ–‡æ ‡ç‚¹çŠ¶æ€?    var openState,mode = key.ime.state();
    if(mode!=3/*_IME_SYMBOLMODE_SYMBOL*/){
        //è¯´æ˜åˆ‡æ¢åˆ°äº†è‹±æ–‡æ ‡ç‚¹ï¼Œå†åˆ‡æ¢å›å»
            key.combine("CTRL",".")
    }
};

//æ”¹é”®æ¼”ç¤º
["Ctrl+."] = function(hFocus){
    key.up("Ctrl"); //å…ˆæŠŠå·²ç»æŒ‰ä¸‹çš„é”®å¼¹èµ·æ?    key.combine("CTRL","A"); //æ¢æˆåˆ«çš„é”®ï¼Œå…·ä½“çœ?aardio åº“å‡½æ•°æ–‡æ¡?    return false; //é˜»æ­¢æŒ‰é”®äº‹ä»¶
};

//å å­—é”®æ¼”ç¤?["`"]  = function(hFocus){
    var openState,mode = key.ime.state();//ç”¨æ³•è¯·æŸ¥çœ?aardio æ–‡æ¡£
    if(!openState
            ||  mode !=3 || key.getState("Shift")
            || key.getState("Ctrl")
            || key.getState("CAPSLK")  ) {
            return true; //å…è®¸æ­¤æŒ‰é”®ç»§ç»­å‘é€?    }

    key.combine("SHIFT","LEFT"); //å‘åé€‰ä¸€ä¸ªå­—
    key.combine("CTRL","C"); //å¤åˆ¶
    key.press("RIGHT"); //å–æ¶ˆé€‰ä¸­
    key.combine("CTRL","V"); //ç²˜è´´
};

//å–æ¶ˆæ¬¡é€‰é”®
[";"] = function(hFocus){
    if( winex.msCandidate.isVisible() ){
        key.send(" ;")
    }
    else return true;
};

//æŒ?shift + back å?ctrl + z
["SHIFT+BACK"] = function(hFocus){
    key.up("SHIFT"); //å…ˆæŠŠå·²ç»æŒ‰ä¸‹çš„é”®å¼¹èµ·æ?    key.combine("CTRL","Z")
};

//æŠŠæ–œæ â€?â€æ”¹ä¸ºé¡¿å?["/"] = function(hFocus){
    var openState,mode = key.ime.state();//
    if( !openState /*&&(mode==3) */ ) return true;
    key.sendString("ã€?)
};

//åˆ‡æ¢é¼ æ ‡å·¦å³é”®ï¼Œç»å¸¸æ¢å·¦å³æ‰‹è€é¼ æ ‡æ˜¯å¥½ä¹ æƒ?["Ctrl+SHIFT+RIGHT"] = function(hFocus){
    ::User32.SwapMouseButton(!::User32.GetSystemMetrics(23));
}

//æŒ?Shift + Back å?Ctrl + Zï¼Œå› ä¸ºè¿™æ—¶å€?Shift æ˜¯æŒ‰ä¸‹çŠ¶æ€ï¼Œæ‰€ä»¥å¯ä»¥å…ˆå‘ä¸€ä¸?key.up("SHIFT") å¼¹èµ·shifté”?["SHIFT+BACK"] = function(hFocus){
    key.up("SHIFT")
    key.combine("CTRL","Z")
};

//å¼•å·é…å¯¹
[`SHIFT+"`] = function(hFocus){
    var o,s = key.ime.state();
    key.sendString(s==3 ? `â€œâ€` : `""`);

    //ä¸ç›®æ ‡çª—å£å…±äº«è¾“å…¥çŠ¶æ€?    winex.attach(hFocus,true);

    //è®¾ç½®LSHIFT,RSHIFT ä¸ºå¼¹èµ·çŠ¶æ€?    key.up("RSHIFT","LSHIFT","SHIFT");
    key.setState(false,"RSHIFT","LSHIFT","SHIFT");

    //ç§»åŠ¨å…‰æ ‡
    key.press("LEFT");

    //å–æ¶ˆå…±äº«è¾“å…¥çŠ¶æ€?    winex.attach(hFocus,false);
}

//æ‹¬å·é…å¯¹
[`SHIFT+(`] = function(hFocus){
    key.sendString(`()`);
    key.up("SHIFT");
    key.press("LEFT");
}

//å?SHIFT é”®åˆ‡æ¢ä¸ºè‹±æ–‡
["RSHIFT"]  = function(hFocus){
    key.ime.setOpenStatus(false);
    key.ime.setConversionMode(0);
};

//å·?SHIFT é”®åˆ‡æ¢ä¸ºä¸­æ–‡
["LSHIFT"]  = function(hFocus){
    var openState,mode = key.ime.state();
    if( openState && !key.ime.capital() ) return true; //å½“å‰å·²ç»æ˜¯ä¸­æ–‡è¾“å…¥æ¨¡å¼ï¼Œä¸æ”¹å˜é»˜è®¤è¡Œä¸?
    key.up("SHIFT");//å…ˆæ”¾å¼€ SHIFT é”?
    //å¦‚æœæ˜¯å¤§å†™çŠ¶æ€ï¼Œåˆ‡æ¢ä¸ºå°å†?    if(key.ime.capital())    key.press("CAPSLK")

    //è‹±æ–‡ç›´æ¥åˆ‡ä¸­æ–?+ ä¸­æ–‡æ ‡ç‚¹
    key.ime.setOpenStatus(true); //æ‰“å¼€è¾“å…¥æ³?    key.ime.setConversionMode(1|0x400); //åˆ‡æ¢åˆ°ä¸­æ–‡çŠ¶æ€ï¼Œè¿™ä¸€æ­¥ä¸èƒ½çœç•?
    //å†æ¬¡å°è¯•ç”¨é”®ç›˜åˆ‡æ¢ä¸­æ–‡æ ‡ç‚¹ï¼Œè¿™ä¸€æ­¥ä¸èƒ½çœç•?    key.combine("CTRL",".");

    //ç°åœ¨å†æ¬¡æ£€æµ‹ä¸­æ–‡æ ‡ç‚¹çŠ¶æ€?    var openState,mode = key.ime.state();
    if(mode!=3/*_IME_SYMBOLMODE_SYMBOL*/){
        //è¯´æ˜åˆ‡æ¢åˆ°äº†è‹±æ–‡æ ‡ç‚¹ï¼Œå†åˆ‡æ¢å›å»
        key.combine("CTRL",".")
    }
};

//æŒ?`date è¾“å…¥å¤§å†™çš„å½“å‰æ—¥æœ?["~date"] = function(hFocus){
    var zh = string.chineseNumber('ã€‡ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹');
    key.sendString(zh.date()); //æ”¹ä¸º zh.time() è¾“å‡ºå¤§å†™çš„å½“å‰æ—¶é—?};

//å¢åŠ éŸ³é‡
["Ctrl+F6"] = function(hFocus){
    key.press("VOLUME_UP");
}

//é™ä½éŸ³é‡
["Ctrl+F7"] = function(hFocus){
    key.press("VOLUME_DOWN");
}

//åˆ‡æ¢é™éŸ³
["Ctrl+F8"] = function(){
    key.press("VOLUME_MUTE");
}

//è¿è¡Œè®¡ç®—å™?["~calc"] = function(hFocus){
    process.execute("calc.exe")
};

//è¿è¡Œword
["~word"] = function(hFocus){
    var word = com.CreateObject("Word.Application")
    if(word)word.Visible = true;
};

//å¾®è½¯äº”ç¬”æ‰“å¼€æˆ–å…³é—­æ‹¼éŸ³æ··è¾?["Ctrl+,"] = function(hFocus){
    var reg = win.reg("HKEY_CURRENT_USER\Software\Microsoft\InputMethod\Settings\CHS");
    var mode = !reg.queryValue("PinyinMixEnable") ? 1 : 0
    reg.setDwValue("PinyinMixEnable",mode)

    key.ime.changeRequest(0x4090409)
    key.ime.changeRequest(0x8040804)
};

//ä¸å¯ç›´æ¥åœ¨ä¸Šè¿°é”®ç›˜å›è°ƒå‡½æ•°ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œï¼Œè¿™ä¼šå¯¼è‡´æ“ä½œç³»ç»Ÿç¦ç”¨çƒ­é”®ã€?//å¦‚æœæœ‰è€—æ—¶æ“ä½œå¿…é¡»å¦‚ä¸‹è¿”å›ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå°†å¼‚æ­¥æ‰§è¡Œè¯¥å‡½æ•°ï¼Œå¹¶å–æ¶ˆå·²æŒ‰é”®ä¸å†æ‰§è¡Œé»˜è®¤æ“ä½?[`SHIFT+"`] = function(hFocus){
    return function(){
        key.waitUp("SHIFT")
        key.sendString(`"`);
        key.press("LEFT");
    } ;
}

};

```

## â–?onKeyDown,onKeyUp äº‹ä»¶ [\#](\#event)

è¶…çº§çƒ­é”®ï¼?key.hotkey å¯¹è±¡ï¼‰å…è®¸è‡ªå®šä¹‰ onKeyDown,onKeyUp äº‹ä»¶ã€?
```aardio aardio
import key.hotkey;
superHotkey = key.hotkey();

//æŒ‰é”®æ—¶è§¦å‘ï¼Œæ­¤äº‹ä»¶åœ¨æ£€æµ‹è¶…çº§çƒ­é”®è§„åˆ™å‰è§¦å‘
superHotkey.onKeyDown = function(vk){

    //vk å‚æ•°ä¸ºè™šæ‹Ÿé”®ç ?
    //è¿”å› true é˜»æ­¢æŒ‰é”®ç»§ç»­å‘é€ï¼Œä¹Ÿä¼šå–æ¶ˆç›¸å…³çš„è¶…çº§çƒ­é”®ã€?    return true;

}

//é‡Šæ”¾æŒ‰é”®æ—¶è§¦å‘ï¼Œæ­¤äº‹ä»¶åœ¨æ£€æµ‹è¶…çº§çƒ­é”®è§„åˆ™ä¹‹åè§¦å?superHotkey.onKeyUp = function(vk){

    //vk å‚æ•°ä¸ºè™šæ‹Ÿé”®ç ?
    //è¿”å› true é˜»æ­¢æŒ‰é”®ç»§ç»­å‘é€ã€?    return true;

}

win.loopMessage();

```

ä¸‹é¢çš„çƒ­é”®çƒ­é”®ç¤ºä¾‹é€šè¿‡ superHotkey.onKeyDown äº‹ä»¶å®ç°åœ¨ä¸­æ–‡è¾“å…¥æ¨¡å¼ä¸‹ï¼Œè¾“å…¥æ•°å­—åè‡ªåŠ¨æ”¯æŒ `.,_:` ç­‰å¸¸ç”¨æ•°å€¼åˆ†éš”ç¬¦ï¼Œé¿å…å°†å°æ•°ç‚¹ç­‰æ•°å€¼åˆ†éš”ç¬¦è¾“å…¥ä¸ºä¸­æ–‡å¥å·ã€?
```aardio aardio
import winex.candidate;
import key.number;
import key.hotkey;
superHotkey = key.hotkey();

//æŒ‰é”®æ—¶å›è°ƒæ­¤å‡½æ•°ï¼Œvk ä¸ºè™šæ‹Ÿé”®ç ?superHotkey.onKeyDown = function(vk){

    //æŒ‰ä¸‹ CTRL,ALT æ—¶å¿½ç•?    if(key.getStateX("CTRL") || key.getStateX("ALT") ) return;

    //è¾“å…¥æ³•å€™é€‰åˆ—è¡¨çª—å£æ­£åœ¨æ˜¾ç¤ºæ—¶å¿½ç•¥
    if( winex.candidate.visible() ) {
        superHotkey.prevKeyCode = null;
        return;
    }

    //å½“å‰è¾“å…¥æ˜¯å¦æ•°å€¼åˆ†éš”ç­”
    var sep = key.number.getSeparator(vk);

    if(sep){

        //åœ¨æ­¤ä¹‹å‰æ˜¯å¦è¾“å…¥äº†æ•°å­?        if( key.number.is(superHotkey.prevKeyCode)){

            //å‘é€æ•°å€¼åˆ†éš”ç¬¦åˆ°ç›®æ ‡çª—å?            key.sendString( sep );

            //å–æ¶ˆåŸæŒ‰é”®äº‹ä»?            return true;
        }
    }

    //è®°å½•ä¸Šæ¬¡çš„æŒ‰é”®ï¼Œä½†ä¸è®°å½• Shift é”?    if(vk!=0xA0/*_VK_LSHIFT*/ && vk!=0xA1/*_VK_RSHIFT*/){
        superHotkey.prevKeyCode = vk;
    }
}

win.loopMessage();

```

## â–?ä½¿ç”¨è™šæ‹Ÿé”®ç ä¸é”®åè·å–æŒ‰é”®çŠ¶æ€?
å¯è°ƒç”?key.getName(vk) å‡½æ•°å°†è™šæ‹Ÿé”®ç è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»å‹çš„é”®åï¼?ä¹Ÿå¯è°ƒç”¨ key.getCode(keyName) å‡½æ•°å°†é”®åè½¬æ¢ä¸ºæ•°å€¼ç±»å‹çš„è™šæ‹Ÿé”®ç ï¼Œæ­¤å‡½æ•°ä¼ å…¥é”®ç åˆ™ç›´æ¥è¿”å›ã€?
å…¨éƒ¨é”®åä¸é”®ç åœ¨ [key.VK](../../../library-reference/key/VK.html) åº“ä¸­å®šä¹‰ã€?
aardio ä¸­ä¸é”®ç›˜æ“ä½œæœ‰å…³çš„å‡½æ•°å¤šå…è®¸ä»¥é”®åæˆ–é”®ç ä½œä¸ºå‚æ•°æŒ‡å®šæŒ‰é”®ï¼Œä¾‹å¦‚è·å–æŒ‰é”®çŠ¶æ€çš„ key.getState(),key.getStateX() éƒ½æ”¯æŒä»¥é”®åæˆ–é”®ç ä½œä¸ºå‚æ•°ã€?
é¼ æ ‡æŒ‰é”®è¾ƒä¸ºç‰¹æ®Šï¼?
- ä½¿ç”¨ mouse.state() å‡½æ•°è·å–é¼ æ ‡å·¦é”®æ˜¯å¦æŒ‰ä¸‹ã€?- ä½¿ç”¨ mouse.rb.state() å‡½æ•°è·å–é¼ æ ‡å³é”®æ˜¯å¦æŒ‰ä¸‹ã€?- ä½¿ç”¨ mouse.mb.state() å‡½æ•°è·å–é¼ æ ‡ä¸­é”®æ˜¯å¦æŒ‰ä¸‹ã€?
å¦‚æœä¸æƒ³å¼•å…¥ mouse åº“ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨ APIï¼Œä¾‹å¦‚ä½¿ç”?`::User32.GetAsyncKeyState(1/*_VK_LBUTTON*/) & 0x8000` å¯åˆ¤æ–­é¼ æ ‡å·¦é”®æ˜¯å¦æŒ‰ä¸‹ã€?
[Markdown æ ¼å¼](https://www.aardio.com/zh-cn/doc/library-guide/std/key/hotkey.md)

