
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£ - inet.http ä½¿ç”¨æŒ‡å—'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£ - inet.http ä½¿ç”¨æŒ‡å—</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>inet.http ä½¿ç”¨æŒ‡å—</h1>

<h2>ä¸€ã€å¿«é€Ÿå…¥é—¨</h2>

<p>æ ‡å‡†åº“ä¸­çš„ inet.http ç”¨äºåˆ›å»º HTTP Â å®¢æˆ·ç«¯ï¼Œç”¨æ³•å…¶å®éå¸¸ç®€å•ï¼Œå…ˆæ¥ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼š  </p>

<pre><code class="aardio language-aardio">
//å¯¼å…¥ inet.http
import inet.http;

//åˆ›å»º HTTP å®¢æˆ·ç«¯å¯¹è±¡
var http = inet.http(); 

//å‘é€ GET è¯·æ±‚
var data = http.get(&quot;http://eu.httpbin.org/get?username=user&amp;password=pwd&quot;);

//å‘é€ POST è¯·æ±‚
var data = http.post(&quot;http://eu.httpbin.org/post&quot;,{
  username = &quot;user&quot;; password = &quot;pwd&quot;;
});
</code></pre>

<p>æ›´å¤šä¾‹å­è¯·å‚è€ƒ <strong>ã€Œaardio è‡ªå¸¦èŒƒä¾‹ / ç½‘ç»œåº”ç”¨ / inet / httpã€</strong> ã€‚  </p>

<p>å¯é€‰ç”¨ç¬¬ä¸€ä¸ªæ„é€ å‚æ•°æŒ‡å®š User Agentï¼Œå¯é€‰ç”¨ç¬¬äºŒä¸ªæ„é€ å‚æ•°æŒ‡å®šä»£ç†æœåŠ¡å™¨ï¼Œè¯·å‚è€ƒï¼š<a href="proxy.html" tppabs="https://www.aardio.com/zh-cn/doc/library-guide/std/inet/proxy.html">è®¾ç½®ä»£ç†æœåŠ¡å™¨</a></p>

<h2>äºŒã€åˆ†æ­¥è¯·æ±‚</h2>

<p>inet.http è¿˜æä¾›ã€Œåˆ†æ­¥è¯·æ±‚ã€çš„å†™æ³•ï¼Œå¯ä»¥æ›´çµæ´»åœ°æ§åˆ¶è¯·æ±‚ï¼Œä¾‹å¦‚è¯»å– HTTP å“åº”å¤´ï¼š  </p>

<pre><code class="aardio language-aardio">import inet.http;

//é¦–å…ˆåˆ›å»º HTTP å®¢æˆ·ç«¯å¯¹è±¡
var http = inet.http();

//åˆ›å»º HTTP è¯·æ±‚ï¼Œå‚æ•° @2æŒ‡å®šè¯·æ±‚æ–¹æ³•ï¼Œæ›´å¤šå‚æ•°è¯·æŸ¥çœ‹å‡½æ•°è¯´æ˜
http.beginRequest(&quot;http://www.aardio.com&quot;,&quot;GET&quot;);

//å‘é€è¯·æ±‚
http.send();

//è¯»å– HTTP å“åº”å¤´ï¼ˆè¦åœ¨å‘é€è¯·æ±‚å¤´åæ‰èƒ½è¯»å– ï¼‰ã€‚
var headers = http.readHeader();
</code></pre>

<p>æ³¨æ„è¦åœ¨å‘é€è¯·æ±‚ä»¥åï¼Œè¯·æ±‚ç»“æŸä»¥å‰è¯»å– HTTP å“åº”å¤´ã€‚è¿™å°±åƒç”µè¯æ¥é€šä»¥åã€æŒ‚æ–­ä»¥å‰ä½ æ‰èƒ½å¬åˆ°å¯¹æ–¹çš„å£°éŸ³Â â€”â€” ä¸éš¾ç†è§£å§ï¼Ÿï¼  </p>

<p>è¿™ç§æ–¹æ³•çœ‹èµ·æ¥ä»£ç å¤šäº†ä¸€ç‚¹ç‚¹ï¼Œä½†æ˜¯å¯ä»¥æ›´çµæ´»åœ°æ§åˆ¶ç»†èŠ‚ã€‚å¦‚æœæƒ³æŠŠè¿™äº›ä»£ç ç®€åŒ–ï¼Œåªè¦å°è£…ä¸€ä¸ªåº“å‡½æ•°å°±å¯ä»¥äº†ã€‚aardio åšè¿™äº›äº‹ç‰¹åˆ«ç®€å•ï¼Œæ¥ä¸ªåŠ¨ç”»æ¼”ç¤ºä¸€ä¸‹ï¼š  </p>

<p>ç”¨èµ·æ¥å°±ç®€å•äº†ï¼š  </p>

<pre><code class="aardio language-aardio">import httpUtil;
var ret = httpUtil.getHeader(&quot;http://www.aardio.com&quot;)
</code></pre>

<p>å¦å¤– inet.http ä¹Ÿæä¾›äº†ç›´æ¥è¯»å– HTTP å“åº”å¤´çš„ http.head() å‡½æ•°ï¼š  </p>

<pre><code class="aardio language-aardio">import inet.http;

var http = inet.http();
http.head(&quot;http://www.aardio.com&quot;);
var headers = http.readHeader();
</code></pre>

<p>åªè¦è°ƒç”¨ http.head() å‘é€ HEAD è¯·æ±‚ï¼Œé‚£ä¹ˆ inet.http å°±ä¼šæŠŠå…¨éƒ¨ HTTP å“åº”å¤´ç¼“å­˜èµ·æ¥ï¼Œåœ¨è¯·æ±‚ç»“æŸåä»ç„¶å¯ä»¥ä½¿ç”¨ http.readHeader()Â ã€‚</p>

<h2>ä¸‰ã€HTTP æ–¹æ³•</h2>

<p>GET,POST,HEAD,PUT,DELETE,PATCH â€¦â€¦ è¿™äº›éƒ½æ˜¯ HTTP æ–¹æ³•( HTTP method )ï¼Œå¦‚æœå°† HTTP æœåŠ¡å™¨æ¯”ä½œé“¶è¡Œï¼Œé‚£ä¹ˆ GET å°±ç›¸å½“äºå»é“¶è¡Œå–æ¬¾ï¼ŒPOST å°±ç›¸å½“äºå»é“¶è¡Œå­˜æ¬¾ï¼ŒHEAD å°±ç›¸å½“äºå»é“¶è¡Œå’¨è¯¢ä¸€ä¸‹ â€”â€” ä½†ä»€ä¹ˆä¹Ÿä¸å¹²ã€‚  </p>

<p>æˆ‘ä»¬å¯ä»¥ç”¨ TCP å®¢æˆ·ç«¯æ¨¡æ‹Ÿä¸€ä¸‹ HTTP åè®®çš„ HEAD è¯·æ±‚ï¼Œä»£ç å¦‚ä¸‹ï¼š  </p>

<pre><code class="aardio language-aardio">import wsock.tcp.client; 
var tcp = wsock.tcp.client() 
tcp.connect(&quot;www.aardio.com&quot;,80) 

sendData =/***********
HEAD /  HTTP/1.1
Host: www.aardio.com 
Connection: close
User-Agent: Mozilla/5.0  
Accept: */*;   
***********/

tcp.write( sendData,&#39;\r\n\r\n&#39; );
headers = tcp.readTo(&#39;\r\n\r\n&#39;);//HTTPå¤´ä»¥ä¸¤ä¸ªå›è½¦æ¢è¡Œç»“æŸ
tcp.close() ;

import console;
console.log( headers  )
console.pause();
</code></pre>

<h2>å››ã€åœ¨è¯·æ±‚ç»“æŸåè¯»å– HTTP å“åº”å¤´</h2>

<p>é‚£ä¹ˆå¦‚æœè¯´ä¸æƒ³å†™æ‰©å±•åº“ï¼Œä¹Ÿä¸æƒ³å‘é€ HEAD è¯·æ±‚ï¼Œä¹Ÿä¸æƒ³åˆ†æ­¥è¯·æ±‚Â â€¦â€¦Â å°±æ˜¯æƒ³è¦åœ¨ http.get() æˆ– http.post() ç»“æŸè¯·æ±‚ä»¥åè¿˜èƒ½ç»§ç»­è¯»å– HTTP å“åº”å¤´è¡Œä¸è¡Œï¼Ÿï¼å…¶å®ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä»£ç å¦‚ä¸‹ï¼š  </p>

<pre><code class="aardio language-aardio">import inet.http;

//åˆ›å»º HTTP å¯¹è±¡
var http = inet.http();

//å‘é€è¯·æ±‚åä¼šè‡ªåŠ¨è¯»å–æ‰€æœ‰ HTTP å“åº”å¤´
http.afterSend = lambda() http.readHeader(); 

//å‘é€ POST è¯·æ±‚
var data = http.post(&quot;http://eu.httpbin.org/post&quot;,{
  username = &quot;user&quot;; password = &quot;pwd&quot;;
});

/*
åªè¦è¯·æ±‚ç»“æŸå‰è¯»å–è¿‡å…¨éƒ¨ HTTP å“åº”å¤´ï¼Œ
aardio å°±ä¼šç¼“å­˜èµ·æ¥ï¼Œè¯·æ±‚ç»“æŸåå¯ä»¥ç»§ç»­è¯»å– HTTP å“åº”å¤´
*/
var contentType = http.readHeader(&quot;Content-Type:&quot;)
</code></pre>

<p>åªè¦è¯·æ±‚ç»“æŸå‰è¯»å–è¿‡å…¨éƒ¨ HTTP å“åº”å¤´ï¼Œ</p>

<p>aardio å°±ä¼šç¼“å­˜èµ·æ¥ï¼Œè¯·æ±‚ç»“æŸåå¯ä»¥ç»§ç»­è¯»å– HTTP å“åº”å¤´ã€‚</p>

<h2>äº”ã€æ‰©å±•åº“è€Œä¸æ˜¯ä¿®æ”¹åº“</h2>

<p>é‚£ä¹ˆå¦‚æœä¸æƒ³å¤šå†™ä¸€å¥ http.afterSend â€¦â€¦ è¯¥æ€ä¹ˆåŠï¼Ÿï¼è¦ä¸è¦æ‰“å¼€ inet.http ä¿®æ”¹ä¸€ä¸‹æºä»£ç ï¼Œè®©æ‰€æœ‰ HTTP è¯·æ±‚éƒ½è¯»å–æ‰€æœ‰ HTTP è¯·æ±‚å¤´å¹¶ç¼“å­˜èµ·æ¥å‘¢ï¼Ÿï¼  </p>

<p>å…¶å®å¤§å¤šæ•° HTTP è¯·æ±‚ä¸éœ€è¦ä¹Ÿä¸åº”è¯¥æ‰§è¡Œè¿™ä¸ªå¤šä½™çš„æ­¥éª¤ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±è¦æ€è€ƒä¸€ä¸‹äº†ï¼š  </p>

<p>1ã€æŸä¸€æ—¶åˆ»çš„å•ç‚¹éœ€æ±‚ï¼Œå¹¶ä¸ç­‰äºä»»ä½•äººä»»ä½•æ—¶å€™éƒ½éœ€è¦ã€‚Â Â </p>

<p>2ã€æŠŠæ‰€æœ‰éœ€æ±‚éƒ½ç›²ç›®åœ°å¡è¿›ä¸€ä¸ªåº“ï¼Œè¿™ä¼šè®©ä¸€ä¸ªåº“æ¸æ¸å˜å¾—ç¬¨æ‹™ã€å¤æ‚ä¸”éš¾ä»¥æ‰©å±•ã€‚</p>

<p>â€œæ‰©å±•è€Œä¸æ˜¯ä¿®æ”¹åº“â€Â â€”â€”é€šå¸¸æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚å¦‚æœä½ ä¸æƒ³å¤šå†™è¿™å¥ http.afterSend â€¦ ï¼Œåªè¦ç®€å•åœ°å†™ä¸€ä¸ªæ–°åº“æ‰©å±•ä¸€ä¸‹ inet.http å°±å¯ä»¥ï¼Œä»£ç éå¸¸ç®€å•ï¼Œä¾‹å¦‚ï¼š  </p>

<pre><code class="aardio language-aardio">import inet.http;

class myHttp{
  ctor( ... ){
    this = ..inet.http( ... );
    this.afterSend = lambda() this.readHeader(); 
  }; 
}
</code></pre>

<p>web.rest.client å°±æ˜¯ä¸€ä¸ªåŸºäº inet.http è€Œå°è£…çš„ä¸Šå±‚åº“ã€‚è€ŒåŸºäº web.rest.client åˆæ‰©å±•äº†æ›´å¤šçš„åº“ï¼Œå¦‚ä¸‹ï¼š  </p>

<pre><code class="aardio language-aardio">web.rest.jsonClient
web.rest.jsonLiteClient
web.rest.xmlClient 
web.rest.htmlClient 
</code></pre>

<p>åŸºäºä¸Šé¢è¿™äº›åº“å†æ¬¡æ‰©å±•å‡ºæ¥çš„åº“å°±æ›´å¤šäº†â€¦â€¦Â   </p>

<p>aardio åŸºäº inet.http æ‰©å±•çš„åº“éå¸¸å¤šï¼Œè¶³è§ inet.http æœ‰è‰¯å¥½çš„æ‰©å±•èƒ½åŠ›ã€‚å¯ä»¥è®¾æƒ³ä¸€ä¸‹ï¼Œå¦‚æœ inet.http ä¸æ˜¯æŠŠæ›´å¤šçš„æœºä¼šç•™ç»™å…¶ä»–åº“å»å‘æŒ¥ï¼Œè€Œæ˜¯ä»€ä¹ˆäº‹éƒ½æŠ¢ç€å¹²ï¼Œæå‰å¹²ï¼Œä¸ç®¡åˆ«äººéœ€ä¸éœ€è¦çš„åŠŸèƒ½éƒ½å¼ºè¡Œå¹²äº†Â â€”â€”Â è¿™å¤šä¹ˆå¯æ€•ï¼Ÿï¼  </p>

<p>inet.http æœ‰ä¸ªè‡ªåŠ¨è§£å‹ gzip å‹ç¼©æ•°æ®çš„åŠŸèƒ½ï¼ŒåŒæ ·éœ€è¦å¤šå†™ä¸€å¥ä»£ç ï¼Œå…ˆçœ‹ä¾‹å­ï¼š  </p>

<pre><code class="aardio language-aardio">import zlib;
import inet.http;

var http = inet.http();
var str = http.get(&quot;http://eu.httpbin.org/gzip&quot;,&quot;Accept-Encoding:gzip&quot;);
</code></pre>

<p>åªæœ‰æå‰å¤šå†™ä¸€å¥ import zlib ï¼Œinet.http æ‰ä¼šæ”¯æŒ gzip è‡ªåŠ¨è§£å‹ã€‚å…¶å®æˆ‘ä»¬å†™ HTTP è¯·æ±‚ä¸åƒåœ¨æµè§ˆå™¨é‡Œçœ‹ç½‘é¡µï¼Œå¤§å¤šæ—¶å€™æˆ‘ä»¬ä¸éœ€è¦ gzip å‹ç¼©ä¼ è¾“ã€‚ä»…ä»…å› ä¸ºä¸ªä¾‹éœ€è¦ä»€ä¹ˆä¸œè¥¿ï¼Œå°±å¼ºåˆ¶æ‰€æœ‰äººåœ¨æ‰€æœ‰æ—¶å€™éƒ½å¸¦ä¸Šå®ƒÂ â€”â€” è¿™ä¸æ˜¯å¥½ä¹ æƒ¯ã€‚  </p>

<p>æ‰€ä»¥å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¸è¦åœ¨ä¹æ˜¯ä¸æ˜¯å¤šå†™äº†å‡ å¥ä»£ç ã€‚</p>

<h2>å…­ã€POST ç”¨æ³•</h2>

<p>ç°åœ¨æˆ‘ä»¬å›åˆ°æœ¬æ–‡å¼€å§‹çš„ä»£ç ï¼š  </p>

<pre><code class="aardio language-aardio">import inet.http;
var http = inet.http(); 

//å‘é€ POST è¯·æ±‚
var data = http.post(&quot;http://eu.httpbin.org/post&quot;,{
    username = &quot;user&quot;; password = &quot;pwd&quot;;
});
</code></pre>

<p>ä¸Šé¢ http.post çš„ç¬¬ 2 ä¸ªå‚æ•°å¦‚æœæ˜¯ä¸€ä¸ªè¡¨å¯¹è±¡ï¼Œä¼šè‡ªåŠ¨è½¬æ¢ä¸ºå¦‚ä¸‹çš„è°ƒç”¨ï¼š  </p>

<pre><code class="aardio language-aardio">http.post(&quot;http://eu.httpbin.org/post&quot;
   ,&quot;username=user&amp;password=pwd&quot;);
</code></pre>

<p>å¦‚æœè¦å‘æœåŠ¡å™¨æäº¤ JSON ï¼Œä»£ç éœ€è¦ä¿®æ”¹å¦‚ä¸‹ï¼š  </p>

<pre><code class="aardio language-aardio">import web.json;
import inet.http;

//å‘é€ POST è¯·æ±‚ 
var http = inet.http(); 
var data = http.post(&quot;http://eu.httpbin.org/post&quot;,
  web.json.stringify({ username = &quot;user&quot;; password = &quot;pwd&quot; })
);
</code></pre>

<p>ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨ web.json.stringify()Â å‡½æ•°å°†è¡¨å¯¹è±¡è½¬æ¢ä¸ºäº† JSON å­—ç¬¦ä¸²ï¼Œhttp.post å¦‚æœæ£€æµ‹åˆ° POST æ•°æ®æ˜¯ JSON ï¼Œå¹¶ä¸” HTTP è¯·æ±‚å¤´ä¸­ä¸åŒ…å« Content-Type çš„å®šä¹‰ï¼Œå°±ä¼šè‡ªåŠ¨æ·»åŠ ä»¥ä¸‹è¯·æ±‚å¤´ï¼š  </p>

<pre><code class="aardio language-aardio">Content-Type: application/json; charset=utf-8
</code></pre>

<p>å…¶å® inet.http å·²ç» é»˜é»˜åœ°åšäº†å¾ˆå¤šäº‹ï¼Œä»¥ç®€åŒ–æˆ‘ä»¬çš„è°ƒç”¨ä»£ç ï¼Œä½†ä»ç„¶è¦æ³¨æ„è¿™ç§ç®€åŒ–æ˜¯æœ‰åº•çº¿å’Œè¾¹ç•Œçš„ã€‚</p>

<h2>ä¸ƒã€web.rest</h2>

<p>å¦‚æœæˆ‘ä»¬å¸Œæœ›æ›´å¥½åœ°æ”¯æŒ JSONï¼Œä½¿ç”¨åŸºäº inet.http çš„ web.rest.jsonClient ä¼šæ›´ç®€å•ï¼š  </p>

<pre><code class="aardio language-aardio">import web.rest.jsonClient;
var http = web.rest.jsonClient();

var data = http.post(&quot;http://eu.httpbin.org/post&quot;
    ,{ username = &quot;user&quot;; password = &quot;pwd&quot; });
</code></pre>

<p>web.rest.jsonClient ä¼šå°†å‚æ•°è¡¨è‡ªåŠ¨è½¬æ¢ä¸º JSONï¼Œå¹¶å°†æœåŠ¡å™¨è¿”å›çš„ JSON è‡ªåŠ¨è§£æä¸ºè¡¨å¯¹è±¡ã€‚  </p>

<p>å¦‚æœ HTTP è¯·æ±‚ä¸éœ€è¦å‘é€ JSONï¼Œè€ŒæœåŠ¡å™¨å“åº”æ•°æ®æ˜¯ JSONï¼Œè¿™æ—¶å€™åªè¦æŠŠä¸Šé¢çš„Â  web.rest.jsonClient æ›¿æ¢ä¸º web.rest.jsonLiteClient å°±å¯ä»¥äº†ã€‚  </p>

<p>web.rest éå¸¸é‡è¦ï¼Œè¯·å‚è€ƒã€Œaardio èŒƒä¾‹ / Web åº”ç”¨ / RESTã€  </p>

<p>å¼ºçƒˆæ¨èå¤§å®¶ä»”ç»†çœ‹çœ‹ ï¼š<a href="../web/rest/client.html" tppabs="https://www.aardio.com/zh-cn/doc/library-guide/std/web/rest/client.html">ã€Š web.rest ä½¿ç”¨æŒ‡å— ã€‹</a>Â ã€‚ä¸è¿‡è¿˜æ˜¯å…ˆçœ‹å®Œè¿™ç¯‡æ–‡ç« å†å»çœ‹ä¼šæ›´å¥½ã€‚Â </p>

<h2>å…«ã€HTTP è¯·æ±‚è¿”å›å€¼</h2>

<p>å®é™…ä¸Š inet.http å¯¹è±¡å‘é€è¯·æ±‚çš„å‡½æ•°åŸºæœ¬éƒ½æœ‰ 3 ä¸ªè¿”å›å€¼ï¼šå“åº”æ•°æ®ï¼Œé”™è¯¯ä¿¡æ¯ï¼Œé”™è¯¯ä»£ç ã€‚æˆ‘ä»¬å‰é¢çš„ç¤ºä¾‹éƒ½åªä½¿ç”¨äº†ç¬¬ 1 ä¸ªè¿”å›å€¼ã€‚æ¥æ”¶æ‰€æœ‰è¿”å›å€¼çš„ç¤ºä¾‹ï¼š  </p>

<pre><code class="aardio language-aardio">import console;  
import inet.http;

//åˆ›å»º HTTP å¯¹è±¡
var http = inet.http();

//3 ä¸ªè¿”å›å€¼ï¼šå“åº”æ•°æ®,é”™è¯¯ä¿¡æ¯,é”™è¯¯ä»£ç 
var data,err,errCode = http.post( &quot;http://eu.httpbin.org/post&quot; 
  ,&quot;username=user&amp;password=pwd&quot; );

if( data ){ 
  console.log(data);
}
else {
  if( http.statusCode ){
    //æœåŠ¡ç«¯è¿”å›é”™è¯¯ä¿¡æ¯
    console.log( http.lastResponse(), &quot;HTTPé”™è¯¯ä»£ç :&quot; + http.statusCode )
  }
  else{
    //æœ¬åœ°å†…éƒ¨é”™è¯¯
    console.log( err,errCode );
  }
}

http.close();
console.pause();
</code></pre>

<p>å¯ä»¥ä½¿ç”¨ã€Œ <strong>aardio å·¥å…· / ç½‘ç»œ / HTTP çŠ¶æ€ç æ£€æµ‹</strong>ã€æŸ¥è¯¢ HTTP é”™è¯¯ä»£ç ï¼ˆÂ  ä¸Šé¢çš„ errCode ï¼‰ä¸ HTTP çŠ¶æ€ç ï¼ˆ http.statusCode ï¼‰çš„è¯¦ç»†ä¿¡æ¯ï¼š  </p>

<h2>ä¹ã€æŒ‡å®šÂ HTTP è¯·æ±‚å¤´</h2>

<p>å‰é¢æˆ‘ä»¬è®²äº†å¦‚ä½•è·å– HTTP å“åº”å¤´ï¼Œä¸‹é¢æˆ‘ä»¬è®²ä¸€ä¸‹å¦‚ä½•è‡ªå®šä¹‰ HTTP è¯·æ±‚å¤´ã€‚å…¶å® inet.http å·²ç»é»˜è®¤è®¾ç½®å¥½äº†å¿…è¦çš„ HTTP è¯·æ±‚å¤´ï¼Œä¸€èˆ¬å¹¶ä¸éœ€è¦è‡ªå·±æŒ‡å®š HTTP è¯·æ±‚å¤´å‚æ•°ã€‚æˆ‘å‘ç°å¾ˆå¤šäººåœ¨å†™è¿™ç±» HTTP è¯·æ±‚ä»£ç æ—¶ï¼Œéƒ½å–œæ¬¢å¤åˆ¶ç²˜è´´ä¸€å¤§å †æ ¹æœ¬å°±æ²¡ç”¨çš„ HTTP è¯·æ±‚å¤´ã€‚ä¾‹å¦‚ inet.httpï¼Œinet.whttpÂ  éƒ½æä¾›äº†ä¸“ç”¨çš„Â refererÂ å±æ€§ï¼ˆÂ è‡ªåŠ¨è®¾ç½®å€¼ï¼Œä¸€èˆ¬ä¸åº”ä¿®æ”¹Â ï¼‰ï¼Œå‘é€è¯·æ±‚çš„ get,post ç­‰å‡½æ•°ä¹Ÿéƒ½å¯ä»¥æŒ‡å®šÂ referer å‚æ•° ï¼Œå¾ˆæ˜æ˜¾é€šè¿‡ HTTP å¤´å»æŒ‡å®š referer æ—¢ä¸å¿…è¦ä¹Ÿä¼šé”™ä¹±ã€‚</p>

<p>inet.http å…¶å®å·²ç»å¸®æˆ‘ä»¬åšå¥½äº†å¾ˆå¤šäº‹ï¼Œå¹¶ä¸éœ€è¦æ¯ä¸€ä¸ª HTTP å¤´éƒ½å»å†™ä¸€éã€‚æ‰€ä»¥å¤§å®¶çœ‹å‰é¢æˆ‘å†™çš„ä»£ç éƒ½æ²¡æœ‰è‡ªå®šä¹‰ä»»ä½• HTTP è¯·æ±‚å¤´ï¼Œè¿™æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚  </p>

<p>inet.http å¯¹è±¡çš„æ‰€æœ‰ HTTP è¯·æ±‚å¤´å±æ€§ã€å‚æ•°éƒ½ä¼šç»è¿‡ web.joinHeaders() å‡½æ•°å¤„ç†å¹¶è½¬åŒ–ã€‚è¿™äº› HTTP è¯·æ±‚å¤´éƒ½å…è®¸ä¼ å…¥å­—ç¬¦ä¸²ã€è¡¨ï¼ˆé”®å€¼å¯¹æˆ–æ•°ç»„ï¼‰ã€‚å…ˆçœ‹ä¸ªä¾‹å­ï¼š  </p>

<pre><code class="aardio language-aardio">import inet.http;
var http = inet.http(); 

//è®¾ç½®æ‰€æœ‰è¯·æ±‚é»˜è®¤æ·»åŠ çš„ HTTP å¤´ï¼Œè¯·æ±‚ç»“æŸä¸æ¸…ç©º 
http.addHeaders = &quot;Name1:value1\r\nName2:value2&quot;;
</code></pre>

<p>ä¹Ÿå¯ä»¥ä½¿ç”¨è¡¨ï¼ˆé”®å€¼å¯¹ï¼‰æŒ‡å®š HTTP å¤´ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code class="aardio language-aardio">http.addHeaders = {
  &quot;Name1&quot;:&quot;value1&quot;, &quot;Name2&quot;:&quot;value2&quot;
}
</code></pre>

<p>ä¹Ÿå¯ä»¥åœ¨ beforeSend äº‹ä»¶å›è°ƒå†…å†™ HTTP è¯·æ±‚å¤´ã€‚  </p>

<pre><code class="aardio language-aardio">http.beforeSend = function(){  
  http.writeHeader(&quot;Name2:value2&quot;); //å†™ HTTP è¯·æ±‚å¤´ 
}
</code></pre>

<p>ä¹Ÿå¯ä»¥é€šè¿‡ http.get() , http.post() ç­‰å‡½æ•°çš„å‚æ•°æŒ‡å®š HTTP è¯·æ±‚å¤´ï¼š  </p>

<pre><code class="aardio language-aardio">var data = http.post(&quot;http://www.httpbin.org/post&quot;, ,{ 
  &quot;Accept-Language&quot;:&quot;zh-CN,zh&quot;;  
});
</code></pre>

<h2>åã€å¤šçº¿ç¨‹ä¸ç•Œé¢</h2>

<p>å¦‚æœåœ¨ç•Œé¢çº¿ç¨‹ä¸­è°ƒç”¨ inet.http ï¼Œè¦æ³¨æ„ inet.http æ‰§è¡Œè¯·æ±‚å±äºè€—æ—¶æ“ä½œ â€”â€” ä¼šé˜»å¡ç•Œé¢çº¿ç¨‹ã€‚ä¸è¿‡Â  aardio åˆ›å»ºå¤šçº¿ç¨‹éå¸¸æ–¹ä¾¿ï¼Œå°† HTTP è¯·æ±‚æ”¾åˆ°å·¥ä½œçº¿ç¨‹é‡Œå°±ä¸ä¼šå¡ç•Œé¢äº†ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š  </p>

<pre><code class="aardio language-aardio">import win.ui;
/*DSG{{*/
var winform = win.form(text=&quot;è·å– HTML&quot;;right=759;bottom=469)
winform.add(
btnGetUrl={cls=&quot;button&quot;;text=&quot;è·å– HTML&quot;;left=481;top=376;right=713;bottom=432;color=14120960;db=1;dr=1;font=LOGFONT(h=-14);note=&quot;åˆ›å»ºå·¥ä½œçº¿ç¨‹è¯·æ±‚ç›®æ ‡ç½‘å€&quot;;z=2};
editHtml={cls=&quot;edit&quot;;left=29;top=24;right=735;bottom=361;db=1;dl=1;dr=1;dt=1;edge=1;hscroll=1;multiline=1;vscroll=1;z=1};
editUrl={cls=&quot;edit&quot;;text=&quot;http://www.aardio.com&quot;;left=33;top=385;right=453;bottom=413;db=1;dl=1;dr=1;edge=1;multiline=1;z=3}
)
/*}}*/

winform.btnGetUrl.oncommand = function(id,event){
  winform.btnGetUrl.disabled = true;

  //åˆ›å»ºå·¥ä½œçº¿ç¨‹
  thread.invoke( 
    function(winform){
      import inet.http;
      var http = inet.http();
      var data  = http.get(winform.editUrl.text);

      //æ˜¾ç¤ºæŠ“å–ç»“æœ
      winform.editHtml.text = data;

      //å¯ç”¨æŒ‰é’®
      winform.btnGetUrl.disabled = false;
    },winform /*å°†çª—å£å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ å…¥çº¿ç¨‹å‡½æ•°*/
  )
}

winform.show();
win.loopMessage();
</code></pre>

<p>åœ¨ç•Œé¢çº¿ç¨‹ä¸­ç®€å•åœ°è¯·æ±‚ä¸€ä¸ªç½‘å€ä¹Ÿå¯ä»¥ä½¿ç”¨ inet.http.get( url )Â ï¼Œè¿™ä¸ªå‡½æ•°ä¹Ÿä¼šåˆ›å»ºçº¿ç¨‹æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œä¸å¡ç•Œé¢ä¸”ä»£ç æ›´å°‘ä¸€äº›ã€‚</p>

<h2>åä¸€ã€æ–­ç‚¹ç»­ä¼ </h2>

<p>å¦‚æœéœ€è¦ä¸‹è½½æ–‡ä»¶å¹¶æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œå¯ä»¥ä½¿ç”¨åŸºäº inet.http å®ç°çš„ inet.httpFileï¼Œæ¥ä¸ªæ–­ç‚¹ç»­ä¼ ä¸‹è½½çš„ä¾‹å­ï¼š  </p>

<pre><code class="aardio language-aardio">import console;
import console.progress;
import inet.httpFile;

var remoteFile = inet.httpFile(
  &quot;http://wubi.aardio.com/update/wubiLex.7z&quot; ,&quot;/.download/&quot;
)

var progress = console.progress();
remoteFile.onReceive = function(data,downSize,contentLength){
  progress.addProgress((downSize/contentLength)*100
    ,&quot;æ­£åœ¨ä¸‹è½½ æ–‡ä»¶å¤§å°ï¼š&quot; + math.size64(contentLength).format() )   
}

//ä¸‹è½½æ–‡ä»¶
if(remoteFile.download()  ){
  console.log(&quot;ä¸‹è½½æˆåŠŸ&quot;)
}
console.pause();
</code></pre>

<p>å¦‚æœè¿˜æƒ³ç»™ä¸‹è½½ç‚¹åŠ ä¸ªçª—å£ç•Œé¢ä»€ä¹ˆçš„ï¼Œæˆ‘ä»¬ä¸å¿…æ”¹åŠ¨Â  inet.httpFile ï¼Œä½¿ç”¨åŸºäº inet.httpFile çš„ inet.downBox å°±å¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºä¸‹è½½å¯¹è¯æ¡†ï¼š  </p>

<pre><code class="aardio language-aardio">import inet.downBox;

var downBox = inet.downBox(winform,&quot;ä¸‹è½½æµ‹è¯•ç½‘é¡µ...&quot;,true )
if( downBox.download( &quot;http://download.aardio.com/v10.files/exlibs/tcc.tar.lzma&quot; 
  , &quot;~/download/lib/tcc.tar.lzma&quot; ) ){
  win.msgbox(&quot;download complete&quot;);
}
</code></pre>

<h2>åäºŒã€ä¸‹è½½å¹¶è§£å‹è¿œç¨‹å‹ç¼©åŒ…</h2>

<p>å¦‚æœæˆ‘ä»¬ä¸ä½†è¦ä¸‹è½½å¯¹è¯æ¡†ï¼Œè¿˜æƒ³ä¸‹è½½å‹ç¼©åŒ…ï¼Œé¡ºå¸¦è§£å‹ç¼©Â â€¦â€¦Â æˆ–è€…é¡ºå¸¦å®‰è£…ç¨‹åº â€”â€” åŒæ ·ä¸å¿…ä¿®æ”¹Â  inet.downBox ï¼Œæœ‰å¾ˆå¤šåŸºäºÂ  inet.downBox çš„åº“å¯ä»¥å®ç°è¿™äº›åŠŸèƒ½ï¼š</p>

<pre><code class="aardio language-aardio">zlib.httpFile //ä¸‹è½½ + zip è§£å‹ç¼©
sevenZip.lzma.httpFile //ä¸‹è½½ + lzma è§£å‹ç¼©
sevenZip.decoder2.httpFile //ä¸‹è½½ + 7z è§£å‹ç¼©
inet.installer //ä¸‹è½½  + è‡ªåŠ¨å®‰è£…ç¨‹åº
</code></pre>

<p>æ ‡å‡†åº“è¿˜æœ‰ä¸€ä¸ª inet.whttpï¼Œç”¨æ³•ä¸æ¥å£ä¸ inet.http åŸºæœ¬ç›¸åŒï¼Œä¸€èˆ¬å¯ç›¸äº’æ›¿ä»£ã€‚inet.http åŸºäº WinINetï¼Œè€Œ inet.whttp åŸºäº WinHTTPã€‚ä¸€èˆ¬æ™®é€šæ¡Œé¢å®¢æˆ·ç«¯è½¯ä»¶(éNTæœåŠ¡)åº”å½“ä½¿ç”¨ inet.httpã€‚</p>

<h2>åä¸‰ã€HTML è§£æ</h2>

<p>å¯¹äºæœåŠ¡å™¨è¿”å›çš„ HTML ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ web.mshtml æˆ–è€… string.html è§£æï¼Œè°ƒç”¨ string.html ç¤ºä¾‹ï¼š  </p>

<pre><code class="aardio language-aardio">import console;
import string.html;

var html =  /* 
&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;&lt;/head&gt;
&lt;body&gt;
&lt;table id=&quot;container&quot;&gt;
&lt;tr&gt;&lt;td rowspan=&quot;1&quot; class=&quot;tab_time tab_time102540630&quot;&gt;06:30&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/body&gt;
*/

var htmlDoc = string.html( html )

//è·å– body èŠ‚ç‚¹
var body = htmlDoc.queryEles( tagName = &quot;body&quot;); 

//éå† body èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹
for(index,tagName,childCount,xNode in body[1].eachChild() ){
  console.log( index,tagName,childCount,xNode.outerXml() ) 
}

console.pause()
</code></pre>

<p>string.html çš„æ›´å¤šç”¨æ³•è¯·å‚è€ƒã€ŒèŒƒä¾‹ / Web åº”ç”¨ / HTML ã€  </p>

<p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ web.rest.htmlClientï¼Œä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š  </p>

<pre><code class="aardio language-aardio">import console; 
import web.rest.htmlClient;
var http = web.rest.htmlClient();

var translate = http.api(&quot;https://translate.*****.cn/m?hl=zh-CN&quot;);

var htmlDoc = translate.get(q=&quot;hello&quot;,sl=&quot;en&quot;,tl=&quot;zh-CN&quot;);
if(htmlDoc){
  var resultContainer = htmlDoc.queryEle({&quot;class&quot;:&quot;result-container&quot;})
  if(resultContainer){
    console.log(resultContainer.innerText());
  }
}  

console.pause(true);
</code></pre>

<p><a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/library-guide/std/inet/http.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª Ëü²»ÔÚÏîÄ¿ÎÄ¼şÀàĞÍ¹æ·¶ÄÚ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/library-guide/std/inet/http.md'" tppabs="https://www.aardio.com/zh-cn/doc/library-guide/std/inet/http.md">Markdown æ ¼å¼</a></p>

</body> 
</html>