
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£ - AES å¤šè¯­è¨€é€šç”¨åŠ å¯†ç®—æ³•æŒ‡å—'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£ - AES å¤šè¯­è¨€é€šç”¨åŠ å¯†ç®—æ³•æŒ‡å—</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>AES å¤šè¯­è¨€é€šç”¨åŠ å¯†ç®—æ³•æŒ‡å—</h1>

<p>aardio,PHP,C#,Java ç­‰ä¸åŒç¼–ç¨‹è¯­è¨€ä¸­ AES åŠ è§£å¯†ç»“æœè¦ä¿æŒä¸€è‡´è¦æ³¨æ„ä»¥ä¸‹ä¸€äº›è¦ç‚¹ï¼š</p>

<ol>
<li>å·¥ä½œæ¨¡å¼ CBC ï¼Œå¡«å……æ¨¡å¼ PKCS7ï¼Œä¸åŒè¯­è¨€è¦ä¿æŒä¸€è‡´ã€‚
è¦æ³¨æ„ PKCS5 ä¸ PKCS7 çš„å¡«å……è§„åˆ™æ˜¯ç›¸åŒçš„ï¼ŒåŒºåˆ«æ˜¯PKCS5å¡«å……1åˆ°8å­—èŠ‚,PKCS7å¡«å……1åˆ°255å­—èŠ‚ï¼Œè€ŒAESå®é™…ä½¿ç”¨çš„æ•°æ®åŒºåˆ†ç»„ä¸º 16 å­—èŠ‚ï¼ˆ128ä½ï¼‰ï¼Œæ‰€ä»¥å³ä½¿å¡«å……æ¨¡å¼æŒ‡å®š PKCS5 - å®é™…ä½¿ç”¨çš„ä¹Ÿæ˜¯ PKCS7ã€‚ä¸‹é¢çš„ JAVAä»£ç é‡Œåªèƒ½é€‰ PKCS5 ï¼Œè€Œ C#ä»£ç é‡Œåªèƒ½é€‰ PKCS7, è¿™éƒ½æ˜¯å…¼å®¹çš„æ²¡æœ‰é—®é¢˜ã€‚</li>
<li>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼ŒåŠ å¯†å‘é‡ç»Ÿä¸€è®¾ä¸ºä¸å¯†é’¥ç›¸åŒã€‚</li>
<li>ä¸åŒç¼–ç¨‹è¯­è¨€ä½¿ç”¨çš„æ–‡æœ¬ç¼–ç è¦ä¸€è‡´ï¼ŒåŒä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½¿ç”¨UTF8æˆ–GBKç¼–ç åœ¨å†…å­˜ä¸­å­˜å‚¨çš„å®é™…æ•°æ®å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚åœ¨aardioä¸­é»˜è®¤ç¼–ç ä¸ºUTF-8,ä½¿ç”¨ string.fromtoè¿›è¡Œè½¬æ¢ä¸ºå…¶ä»–ç¼–ç ã€‚</li>
<li>å¦‚æœåŠ å¯†åè¿”å›çš„å¯†æ–‡ç”¨äº†BASE64æˆ–16è¿›åˆ¶ç¼–ç ï¼Œé‚£ä¹ˆåœ¨è§£å¯†æ—¶åŒæ ·ä¹Ÿå…ˆåšå¯¹åº”çš„é€†å‘è§£ç ã€‚</li>
</ol>

<h2>aardio å®ç° AES åŠ å¯†ã€è§£å¯†çš„ä»£ç ï¼š</h2>

<pre><code class="aardio language-aardio">import console;  
import crypt.bin;
import crypt.aes;

//åˆ›å»ºAESåŠ å¯†ç®—æ³•å®¹å™¨
var aes = crypt.aes();

//è®¾ç½®å¯†é’¥(æœ€å¤§32ä¸ªå­—èŠ‚)
aes.setPassword(&quot;1234567812345678&quot;);

//ä¸æŒ‡å®šåŠ å¯†å‘é‡æ—¶é»˜è®¤è®¾ä¸ºå¯†é’¥çš„å€¼
//aes.setInitVector(&quot;1234567812345678&quot;)

//åŠ å¯†
var str = aes.encrypt(&quot;Test String&quot;);

//BASE64ç¼–ç åŠ å¯†ç»“æœ
console.log( crypt.bin.encodeBase64( str ) );

//è§£å¯†
str = aes.decrypt(str);
console.log(str);

console.pause(true);
</code></pre>

<h2>è¦ä¿æŒ AES åŠ è§£å¯†ç»“æœä¸ä¸Šé¢çš„ aardio ä»£ç ä¸€è‡´ï¼Œ C# è¯­è¨€ AES åŠ è§£å¯†ä»£ç å¦‚ä¸‹ï¼š</h2>

<pre><code class="csharp language-csharp">using System;
using System.Text;
using System.Security.Cryptography;

namespace TestApp
{
    class Aes
    {
        static void Main(string[] args)
        {
            String str = &quot;Test String&quot;;
            String encryptData = Aes.Encrypt(str, &quot;1234567812345678&quot;, &quot;1234567812345678&quot;);
            Console.WriteLine(encryptData);

            String dstr = Aes.Decrypt(&quot;xL1eEwu9WCDRiscUbPPPSA==&quot;, &quot;1234567812345678&quot;, &quot;1234567812345678&quot;);
            Console.WriteLine(dstr);
            Console.ReadKey();
        }

        public static string Encrypt(string toEncrypt, string key, string iv)
        {
            byte[] keyArray = UTF8Encoding.UTF8.GetBytes(key);
            byte[] ivArray = UTF8Encoding.UTF8.GetBytes(iv);
            byte[] toEncryptArray = UTF8Encoding.UTF8.GetBytes(toEncrypt);

            RijndaelManaged rm = new RijndaelManaged();
            rm.Key = keyArray;
            rm.IV = ivArray;
            rm.Mode = CipherMode.CBC;
            rm.Padding = PaddingMode.PKCS7;

            ICryptoTransform cTransform = rm.CreateEncryptor();
            byte[] resultArray = cTransform.TransformFinalBlock(toEncryptArray, 0, toEncryptArray.Length);
            return Convert.ToBase64String(resultArray, 0, resultArray.Length);
        }

        public static string Decrypt(string toDecrypt, string key, string iv)
        {
            byte[] keyArray = UTF8Encoding.UTF8.GetBytes(key);
            byte[] ivArray = UTF8Encoding.UTF8.GetBytes(iv);
            byte[] toEncryptArray = Convert.FromBase64String(toDecrypt);

            RijndaelManaged rm = new RijndaelManaged();
            rm.Key = keyArray;
            rm.IV = ivArray;
            rm.Mode = CipherMode.CBC;
            rm.Padding = PaddingMode.PKCS7;

            ICryptoTransform cTransform = rm.CreateDecryptor();
            byte[] resultArray = cTransform.TransformFinalBlock(toEncryptArray, 0, toEncryptArray.Length);
            return UTF8Encoding.UTF8.GetString(resultArray);
        }
    }
}
</code></pre>

<h2>è¦ä¿æŒ AES åŠ è§£å¯†ç»“æœä¸ä¸Šé¢çš„ aardio ä»£ç ä¸€è‡´ï¼Œ PHP è¯­è¨€ AES åŠ è§£å¯†ä»£ç å¦‚ä¸‹ï¼š</h2>

<pre><code class="php language-php">
import console;
import php;

php.code =/***

//AESåŠ å¯†
function aes_encrypt($encryptKey,$encryptStr) {
    $localIV = $encryptKey;
    $encryptKey = $encryptKey;

    $module = mcrypt_module_open(MCRYPT_RIJNDAEL_128, &#39;&#39;, MCRYPT_MODE_CBC, $localIV);
    mcrypt_generic_init($module, $encryptKey, $localIV);

    $block = mcrypt_get_block_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC);
    $pad = $block - (strlen($encryptStr) % $block);
    $encryptStr .= str_repeat(chr($pad), $pad);

    $encrypted = mcrypt_generic($module, $encryptStr);
    mcrypt_generic_deinit($module);
    mcrypt_module_close($module);

    return base64_encode($encrypted);

}

//AESè§£å¯†
function aes_decrypt($encryptKey,$encryptStr) {
    $localIV = $encryptKey;
    $encryptKey = $encryptKey;

    $module = mcrypt_module_open(MCRYPT_RIJNDAEL_128, &#39;&#39;, MCRYPT_MODE_CBC, $localIV);
    mcrypt_generic_init($module, $encryptKey, $localIV);

    $encryptedData = base64_decode($encryptStr);
    $encryptedData = mdecrypt_generic($module, $encryptedData);

    $e = ord($encryptedData[strlen($encryptedData)-1]);
    if($e&lt;=16)$encryptedData=substr($encryptedData, 0,strlen($encryptedData)-$e);
    return $encryptedData;
}


$result = aes_encrypt(&quot;1234567812345678&quot;,&#39;Test String&#39;);
$decryptString = aes_decrypt(&quot;1234567812345678&quot;,$result);

echo $result;
echo $decryptString;
</code></pre>

<p>å› ä¸º PHP7.1 åºŸå¼ƒäº†mcryptï¼Œæ‰€ä»¥å†™æ³•ä¸ä¸€æ ·ï¼Œ
è¦ä¿æŒåŠ è§£å¯†ç»“æœä¸ä¸Šé¢çš„aardioä»£ç ä¸€è‡´ï¼Œéœ€è¦è¿™æ ·å†™ï¼š</p>

<pre><code class="php language-php">&lt;?php

//AESåŠ å¯†
function aes_encrypt($key,$str)
{  
    return base64_encode( openssl_encrypt($str, &#39;AES-128-CBC&#39;,$key,OPENSSL_RAW_DATA,$key) );;
}

//AESè§£å¯†
function aes_decrypt($key,$str)
{
    return openssl_decrypt(base64_decode($str), &#39;AES-128-CBC&#39;, $key, OPENSSL_RAW_DATA, $key);
}

$result = aes_encrypt(&quot;1234567812345678&quot;,&#39;Test String&#39;);
$str = aes_decrypt(&quot;1234567812345678&quot;,$result);

echo $result.&quot;&lt;br&gt;&quot;;
echo $str;
?&gt;
</code></pre>

<h2>è¦ä¿æŒ AES åŠ è§£å¯†ç»“æœä¸ä¸Šé¢çš„ aardio ä»£ç ä¸€è‡´ï¼Œ Java è¯­è¨€ AES åŠ è§£å¯†ä»£ç å¦‚ä¸‹ï¼š</h2>

<pre><code class="java language-java">import javax.crypto.spec.IvParameterSpec;
import javax.crypto.Cipher;  
import javax.crypto.KeyGenerator;  
import javax.crypto.SecretKey;  
import javax.crypto.spec.SecretKeySpec;  
import sun.misc.BASE64Decoder;  
import sun.misc.BASE64Encoder;

public class AESCrypt {   

    public static String encrypt(String source, String key) throws Exception { 

        byte[] sourceBytes = source.getBytes(&quot;UTF-8&quot;);  
        byte[] keyBytes = key.getBytes(&quot;UTF-8&quot;); 

        Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5Padding&quot;);   
        IvParameterSpec ivParameterSpec = new IvParameterSpec(keyBytes);
        cipher.init(Cipher.ENCRYPT_MODE, new SecretKeySpec(keyBytes, &quot;AES&quot;),ivParameterSpec);   

        byte[] decrypted = cipher.doFinal(sourceBytes);  
        return new sun.misc.BASE64Encoder().encode(decrypted);  
    }  

    public static String decrypt(String encryptStr, String key) throws Exception {  
        byte[] sourceBytes = new sun.misc.BASE64Decoder().decodeBuffer(encryptStr);  
        byte[] keyBytes = key.getBytes(&quot;UTF-8&quot;); 

        Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5Padding&quot;);   
        IvParameterSpec ivParameterSpec = new IvParameterSpec(keyBytes); 
        cipher.init(Cipher.DECRYPT_MODE, new SecretKeySpec(keyBytes, &quot;AES&quot;),ivParameterSpec); 

        byte[] decoded = cipher.doFinal(sourceBytes);    
        return new String(decoded, &quot;UTF-8&quot;);  
    }  

}  
</code></pre>

<p><a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/library-guide/std/crypt/aes.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª Ëü²»ÔÚÏîÄ¿ÎÄ¼şÀàĞÍ¹æ·¶ÄÚ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/library-guide/std/crypt/aes.md'" tppabs="https://www.aardio.com/zh-cn/doc/library-guide/std/crypt/aes.md">Markdown æ ¼å¼</a></p>

</body> 
</html>