
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£ - DES å¤šè¯­è¨€é€šç”¨åŠ å¯†ç®—æ³•æŒ‡å—'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£ - DES å¤šè¯­è¨€é€šç”¨åŠ å¯†ç®—æ³•æŒ‡å—</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>DES å¤šè¯­è¨€é€šç”¨åŠ å¯†ç®—æ³•æŒ‡å—</h1>

<p>ä¸åŒç¼–ç¨‹è¯­è¨€ä¸­DESåŠ è§£å¯†ç»“æœè¦ä¿æŒä¸€è‡´è¦æ³¨æ„ä»¥ä¸‹ä¸€äº›è¦ç‚¹ï¼š</p>

<ol>
<li>å·¥ä½œæ¨¡å¼é»˜è®¤ CBCï¼Œå¡«å……æ¨¡å¼ PKCS5ï¼ˆå…¼å®¹  PKCS7ï¼‰ï¼Œä¸åŒè¯­è¨€è¦ä¿æŒä¸€è‡´ã€‚
aardio å¯è°ƒç”¨ setKeyParamMode å‡½æ•°åˆ‡æ¢åˆ° ECB æ¨¡å¼è§ä¸‹é¢çš„ç¤ºä¾‹ï¼ŒECB æ¨¡å¼ä¸ä½¿ç”¨å‘é‡ IV ã€‚</li>
<li>å‘é‡è¦ä¸€è‡´ï¼Œé»˜è®¤ä½¿ç”¨&#39;\x12\x34\x56\x78\x90\xAB\xCD\xEF&#39;</li>
<li>å¯†é’¥è¦ä¸€è‡´ï¼ŒDESå¯†é’¥ä¸º8ä½ï¼Œ3DESå¯ä»¥ä½¿ç”¨24ä½å¯†é’¥</li>
<li>ä½¿ç”¨çš„æ–‡æœ¬ç¼–ç è¦ä¸€è‡´ï¼ŒåŒä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½¿ç”¨ UTF8 æˆ– GBK ç¼–ç åœ¨å†…å­˜ä¸­å­˜å‚¨çš„å®é™…æ•°æ®å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚åœ¨ aardio ä¸­ä½¿ç”¨ string.fromtoè¿›è¡Œè½¬æ¢ã€‚</li>
<li>å¦‚æœåŠ å¯†åè¿”å›çš„å¯†æ–‡ç”¨äº†BASE64æˆ–16è¿›åˆ¶ç¼–ç ï¼Œé‚£ä¹ˆåœ¨è§£å¯†æ—¶åŒæ ·ä¹Ÿå…ˆåšå¯¹åº”çš„é€†å‘è§£ç ã€‚</li>
</ol>

<h2>å¯†é’¥é•¿åº¦æœ‰ä»€ä¹ˆå½±å“ï¼Œä¸åŒè¯­è¨€å¯†é’¥é•¿åº¦ä¸ºä»€ä¹ˆä¸ä¸€æ ·</h2>

<p>è¦ç‰¹åˆ«æ³¨æ„ aardio æ ¹æ®å¯†é’¥é•¿åº¦è‡ªåŠ¨é€‰æ‹©ç®—æ³•ï¼Œè§„åˆ™å¦‚ä¸‹ï¼š</p>

<ul>
<li>å°äºç­‰äº 8 å­—èŠ‚ä½¿ç”¨ DES ç®—æ³•ã€‚</li>
<li>å°äºç­‰äº 16 å­—èŠ‚ä½¿ç”¨ 2DES ç®—æ³•ã€‚</li>
<li>å°äºç­‰äº 24 å­—èŠ‚ä½¿ç”¨ 3DES ç®—æ³•ã€‚</li>
</ul>

<p>æ‰€ä»¥ä¸€å®šè¦æŠŠå¯†é’¥é•¿åº¦å…ˆå¤„ç†å¥½ã€‚</p>

<p>ä½†æ˜¯åœ¨å…¶ä»–ä¸€äº›è¯­è¨€é‡Œï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ° des, 2des ä½¿ç”¨ 32 ä½å¯†é’¥ï¼Œ
å…¶å®éå¸¸ç®€å•ï¼Œç›´æ¥å–å‰å‡ ä½å¯†é’¥ï¼Œåé¢å‡‘å­—æ•°çš„å¯†é’¥ç›´æ¥ä¸è¦å°±å¯ä»¥ã€‚</p>

<p>åœ¨ aardio é‡Œå°±è¿™æ ·å¤„ç†ï¼š</p>

<ul>
<li>DES ç®—æ³•å°±æ˜¯ <code>key = string.left(key,8)</code></li>
<li>2DES ç®—æ³•å°±æ˜¯ <code>key = string.left(key,16)</code></li>
<li>3DES ç®—æ³•å°±æ˜¯ <code>key = string.left(key,24)</code></li>
</ul>

<p>å¦‚æœå¯¹æ–¹çš„å¯†é’¥ç”¨ BASE64 ç¼–ç äº†ï¼Œåœ¨ aardio é‡Œè¿™æ ·è§£ç ï¼š
<code>key = crypt.decodeBin(base64Key)</code></p>

<h2>DES åŠ è§£å¯†çš„ aardio ä»£ç å¦‚ä¸‹ï¼š</h2>

<pre><code class="aardio language-aardio">import console;  
import crypt.des; 

var des = crypt.des(); 

//å¯é€‰ä¿®æ”¹å·¥ä½œæ¨¡å¼ä¸º å·¥ä½œæ¨¡å¼ ECB ï¼ˆECB ä¸ä½¿ç”¨å‘é‡ IV ï¼‰
//des.setKeyParamMode(2/*_CRYPT_MODE_ECB*/);

des.setPassword(&quot;abcd1234&quot; ) 

//åŠ å¯†
var sstr = des.encrypt(&quot;æµ‹è¯•å­—ç¬¦ä¸²&quot;);

//è§£å¯†
var str = des.decrypt(sstr);

console.log( str, sstr ) 
console.pause(true);
</code></pre>

<h2>å…¼å®¹ aardio DES åŠ è§£å¯†çš„ PHP ä»£ç å¦‚ä¸‹ï¼š</h2>

<pre><code class="php language-php">
&lt;?
class CryptDes
{
    public $key = &quot;&quot;;
    public $iv = &quot;\x12\x34\x56\x78\x90\xAB\xCD\xEF&quot;;
    public function init_crypt($key)
    {
        $this-&gt;key = $key; 
    }
    public function encrypt($str)
    { 
        $size = mcrypt_get_block_size(MCRYPT_DES, MCRYPT_MODE_CBC);
        $str = $this-&gt;pkcs5Pad($str, $size);
        $hexString = bin2hex(mcrypt_cbc(MCRYPT_DES, $this-&gt;key, $str, MCRYPT_ENCRYPT, $this-&gt;iv));
        return strtoupper($hexString);
    }
    public function decrypt($str)
    { 
        $strBin = $this-&gt;hex2bin(strtolower($str));
        $str = mcrypt_cbc(MCRYPT_DES, $this-&gt;key, $strBin, MCRYPT_DECRYPT, $this-&gt;iv);
        $str = $this-&gt;pkcs5Unpad($str);
        return $str;
    }
    public function hex2bin($hexData)
    {
        $binData = &#39;&#39;;
        for ($i = 0; $i &lt; strlen($hexData); $i += 2) {
            $binData .= chr(hexdec(substr($hexData, $i, 2)));
        }
        return $binData;
    }
    public function pkcs5Pad($text, $blocksize)
    {
        $pad = $blocksize - strlen($text) % $blocksize;
        return $text . str_repeat(chr($pad), $pad);
    }
    public function pkcs5Unpad($text)
    {
        $pad = ord($text[strlen($text) - 1]);
        if ($pad &gt; strlen($text)) {
            return false;
        }
        if (strspn($text, chr($pad), strlen($text) - $pad) != $pad) {
            return false;
        }
        return substr($text, 0, -1 * $pad);
    }
} 
$des = new CryptDes(); 
$des-&gt;init_crypt(&quot;abcd1234&quot;); 
$sstr = $des-&gt;encrypt(&quot;defæµ‹è¯•&quot;); //åŠ å¯†
$str = $des-&gt;decrypt($sstr); //è§£å¯†
echo $sstr;
?&gt;
</code></pre>

<p>æ„ä¸Šé¢çš„PHPç‰ˆæœ¬å°†åŠ å¯†ç»“æœè½¬æ¢ä¸ºäº† 16 è¿›åˆ¶å­—ç¬¦ï¼Œ</p>

<p>åœ¨ aardio ä¸­ä½¿ç”¨ string.unhex() å‡½æ•°è½¬å›æ¥ï¼Œ æ³¨æ„ aardio  ä½¿ç”¨ UTF8 ç¼–ç ï¼Œä¸Šé¢çš„ PHP æ–‡ä»¶ä¹Ÿåº”è¯¥å­˜ä¸º UTF8 ç¼–ç ï¼Œå¦‚æœP HP ä½¿ç”¨ GBK ç¼–ç ï¼Œé‚£ä¹ˆç›¸åº”çš„åœ¨ aardio ä¸­ ä¹Ÿè¦åš GBK ç¼–ç è½¬æ¢ã€‚</p>

<p>aardio ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>

<pre><code class="aardio language-aardio">import console;

import crypt.des;
var des = crypt.des();
des.setPassword(&quot;abcd1234&quot; )

var phpsstr = &quot;077E5E400A140170&quot;;//æœåŠ¡ç«¯è¿”å›çš„åŠ å¯†æ•°æ®
phpsstr = string.unhex( phpsstr,&quot;&quot; ); //åå…­è¿›åˆ¶è§£ç 

var str = des.decrypt(phpsstr) ; //DESè§£ç 
str = string.fromto(str,0,65001) //PHPé¡µé¢ä½¿ç”¨äº†UTF8ï¼Œç”¨è¿™å¥è½¬å›æ¥

console.log( str )
console.pause()
</code></pre>

<h2>å…¼å®¹ aardio DES åŠ è§£å¯†çš„ JAVA ä»£ç å¦‚ä¸‹ï¼š</h2>

<pre><code class="java language-java">
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.security.Key;
import java.security.SecureRandom;
import javax.crypto.Cipher;
import javax.crypto.KeyGenerator;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;
import sun.misc.BASE64Decoder;
import sun.misc.BASE64Encoder;

public class Encrypt {

    SecretKeySpec key;

    public Encrypt(String str) {
        setKey(str);// ç”Ÿæˆå¯†åŒ™
    }

    public Encrypt() {
        setKey(&quot;ABCDEFGH&quot;);
    }

    // æ ¹æ®å‚æ•°ç”ŸæˆKEY
    public void setKey(String strKey) {
        this.key = new SecretKeySpec(strKey.getBytes(), &quot;DES&quot;);  ;
    }

    //åŠ å¯†Stringæ˜æ–‡è¾“å…¥,Stringå¯†æ–‡è¾“å‡º
    public String getEncString(String strMing) {
        byte[] byteMi = null;
        byte[] byteMing = null;
        String strMi = &quot;&quot;;
        BASE64Encoder base64en = new BASE64Encoder();
        try {
            byteMing = strMing.getBytes(&quot;UTF8&quot;);
            byteMi = this.getEncCode(byteMing);
            strMi = base64en.encode(byteMi);
        } catch (Exception e) {
            throw new RuntimeException(
                    &quot;DESåŠ è§£å¯†å¼‚å¸¸: &quot; + e);
        } finally {
            base64en = null;
            byteMing = null;
            byteMi = null;
        }
        return strMi;
    }

    // è§£å¯† ä»¥Stringå¯†æ–‡è¾“å…¥,Stringæ˜æ–‡è¾“å‡º
    public String getDesString(String strMi) {
        BASE64Decoder base64De = new BASE64Decoder();
        byte[] byteMing = null;
        byte[] byteMi = null;
        String strMing = &quot;&quot;;
        try {
            byteMi = base64De.decodeBuffer(strMi);
            byteMing = this.getDesCode(byteMi);
            strMing = new String(byteMing, &quot;UTF8&quot;);
        } catch (Exception e) {
            throw new RuntimeException(
                    &quot;DESåŠ è§£å¯†å¼‚å¸¸: &quot; + e);
        } finally {
            base64De = null;
            byteMing = null;
            byteMi = null;
        }
        return strMing;
    }

    // åŠ å¯†ä»¥byte[]æ˜æ–‡è¾“å…¥,byte[]å¯†æ–‡è¾“å‡º

    private static byte[] iv = {0x12,0x34,0x56,0x78,(byte)0x90,(byte)0xAB,(byte)0xCD,(byte)0xEF};
    private byte[] getEncCode(byte[] byteS) {
        IvParameterSpec zeroIv = new IvParameterSpec(iv);
        byte[] byteFina = null;
        Cipher cipher;
        try {
            cipher = Cipher.getInstance(&quot;DES/CBC/PKCS5Padding&quot;);
            cipher.init(Cipher.ENCRYPT_MODE, this.key, zeroIv);
            byteFina = cipher.doFinal(byteS);
        } catch (Exception e) {
            throw new RuntimeException(
                    &quot;DESåŠ è§£å¯†å¼‚å¸¸: &quot; + e);
        } finally {
            cipher = null;
        }
        return byteFina;
    }

    //è§£å¯†ä»¥byte[]å¯†æ–‡è¾“å…¥,ä»¥byte[]æ˜æ–‡è¾“å‡º

    private byte[] getDesCode(byte[] byteD) {
        IvParameterSpec zeroIv = new IvParameterSpec(iv);
        byte[] byteFina = null;
        Cipher cipher;
        try {
            cipher = Cipher.getInstance(&quot;DES/CBC/PKCS5Padding&quot;);
            cipher.init(Cipher.DECRYPT_MODE, this.key, zeroIv);
            byteFina = cipher.doFinal(byteD);
        } catch (Exception e) {
            throw new RuntimeException(
                    &quot;DESåŠ è§£å¯†å¼‚å¸¸: &quot; + e);
        } finally {
            cipher = null;
        }
        return byteFina;
    }

    public static void main(String args[]) {
        Encrypt des = new Encrypt();
        try {
            BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(&quot;è¯·è¾“å…¥æ˜æ–‡: &gt;&quot;);

            String str1 = in.readLine().trim();
            PrintWriter out = new PrintWriter(new BufferedWriter(new FileWriter(str1)));
            String str2 = des.getEncString(str1);
            String deStr = des.getDesString(str2);
            System.out.println(&quot;å¯†æ–‡:&quot; + str2);
            System.out.println(&quot;æ˜æ–‡:&quot; + deStr);

            out.println(&quot;å¯†æ–‡:&quot; + str2);
            out.println(&quot;æ˜æ–‡:&quot; + deStr);
            out.close();
        }catch(Exception e) {
            System.out.println(e);
        }
    }
}
</code></pre>

<h2>å…¼å®¹ aardio DES åŠ è§£å¯†çš„ C# ä»£ç å¦‚ä¸‹ï¼š</h2>

<pre><code class="csharp language-csharp">
using System;
using System.Collections.Generic;
using System.Text;
using System.Security.Cryptography;
using System.IO;

namespace CSharpLibrary  
{  
    public class CSharpObject  
    { 
        private static byte[] DES_IV = { 0x12, 0x34, 0x56, 0x78, 0x90, 0xAB, 0xCD, 0xEF };
        public static string Encrypt4Base64(string pToEncrypt, string sKey)
        { 
            DESCryptoServiceProvider des = new DESCryptoServiceProvider();
            des.Key = Encoding.GetEncoding(&quot;GBK&quot;).GetBytes(sKey);
            des.IV = DES_IV;

            MemoryStream ms = new MemoryStream();
            CryptoStream cs = new CryptoStream(ms, des.CreateEncryptor(), CryptoStreamMode.Write);

            byte[] inputByteArray = Encoding.GetEncoding(&quot;GBK&quot;).GetBytes(pToEncrypt);
            cs.Write(inputByteArray, 0, inputByteArray.Length);
            cs.FlushFinalBlock();

            return Convert.ToBase64String(ms.ToArray());
        }
    }   
} 

</code></pre>

<p><a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/library-guide/std/crypt/des.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª Ëü²»ÔÚÏîÄ¿ÎÄ¼şÀàĞÍ¹æ·¶ÄÚ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/library-guide/std/crypt/des.md'" tppabs="https://www.aardio.com/zh-cn/doc/library-guide/std/crypt/des.md">Markdown æ ¼å¼</a></p>

</body> 
</html>