
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言文档 - sys.acl 库模块帮助文档'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言文档 - sys.acl 库模块帮助文档</title> 
<link rel="stylesheet" href="../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>sys.acl 库模块帮助文档</h1>

<p><a id="sys.acl"></a></p>

<h2>sys.acl 成员列表</h2>

<p>系统用户访问权限控制接口</p>

<p><a id="sys.acl.daclGrant"></a></p>

<h3>sys.acl.daclGrant(sid,objName,objType,trusteeType,premissions)</h3>

<p>对@objName指定名称的对象获取@sid指定用户的@premissions参数指定的权限,<br>
@objType可省略，默认值为_SE_FILE_OBJECT,<br>
其他参数请参考函数源码与MSDN</p>

<p><a id="sys.acl.daclGrantAdmin"></a></p>

<h3>sys.acl.daclGrantAdmin(objName,objType,premissions)</h3>

<p>对@objName指定名称的对象获取管理员用户组的@premissions参数</p>

<p><a id="sys.acl.daclGrantEveryone"></a></p>

<h3>sys.acl.daclGrantEveryone(objName,objType,premissions)</h3>

<p>对@objName指定名称的对象获取Everyone用户的@premissions参数指定的权限</p>

<p><a id="sys.acl.getUserName"></a></p>

<h3>sys.acl.getUserName()</h3>

<p>返回当前系统用户名</p>

<p><a id="sys.acl.sidAdmin"></a></p>

<h3>sys.acl.sidAdmin()</h3>

<p>创建SID，返回管理员用户组SID句柄</p>

<p><a id="sys.acl.sidCreate"></a></p>

<h3>sys.acl.sidCreate(identifierAuthority,...)</h3>

<p>创建SID，返回SID句柄<br>
参数@1使用数值数组指定SID_IDENTIFIER_AUTHORITY结构体的值,<br>
后续可使用1到8个参数指定SID子权限</p>

<p><a id="sys.acl.sidEveryone"></a></p>

<h3>sys.acl.sidEveryone()</h3>

<p>创建SID，返回Everyone用户SID句柄</p>

<p><a id="sys.acl.sidFromString"></a></p>

<h3>sys.acl.sidFromString(sidStr)</h3>

<p>参数传入文本格式SID,<br>
返回SID内存句柄</p>

<p><a id="sys.acl.sidFromUserName"></a></p>

<h3>sys.acl.sidFromUserName(userName,systemName)</h3>

<p>参数@userName传入系统用户名,,省略取当前登录用户名,<br>
@systemName参数可省略,<br>
返回SID内存句柄</p>

<p><a id="sys.acl.sidStringFromUserName"></a></p>

<h3>sys.acl.sidStringFromUserName(userName,systemName)</h3>

<p>参数@userName传入系统用户名,省略取当前登录用户名<br>
@systemName参数可省略,<br>
返回文本格式SID</p>

<p><a id="sys.acl.sidStringToUserName"></a></p>

<h3>sys.acl.sidStringToUserName(sidStr,systemName)</h3>

<p>参数传入文本格式 SID，@systemName 参数可省略。<br>
返回账户名，账户所在域名，账户类型（SID_NAME_USE 枚举）</p>

<p><a id="sys.acl.sidToString"></a></p>

<h3>sys.acl.sidToString(sid)</h3>

<p>参数传入SID句柄,<br>
返回SID文本格式字符串</p>

<p><a id="sys.acl.sidToUserName"></a></p>

<h3>sys.acl.sidToUserName(sid,systemName)</h3>

<p>参数传入SID，@systemName参数可省略。<br>
返回账户名，账户所在域名，账户类型（SID_NAME_USE 枚举）</p>

<p><a id="sys.acl.sidWellKnown"></a></p>

<h3>sys.acl.sidWellKnown(sidType,domainSid)</h3>

<p>获取通用SID,<br>
参数@1参考::Advapi32.CreateWellKnownSid函数说明<br>
参数@2可省略,<br>
返回buffer对象不需要释放</p>

<p><a id="sys.acl.takeOwnByAdmin"></a></p>

<h3>sys.acl.takeOwnByAdmin(objName,objType)</h3>

<p>对objName指定名称的对象获取管理员用户组的所有者权限,\@nobjType可省略，默认值为_SE_FILE_OBJECT</p>

<p><a id="sys.acl.takeOwnBySid"></a></p>

<h3>sys.acl.takeOwnBySid(sid,objName,objType)</h3>

<p>对@objName指定名称的对象获取sid指定用户的所有者权限,<br>
sid应当是sid句柄或内存指针,<br>
@objType可省略，默认值为_SE_FILE_OBJECT</p>

<p><a id="sys.acl.takeOwnBySidString"></a></p>

<h3>sys.acl.takeOwnBySidString(sid,objName,objType)</h3>

<p>对@objName指定名称的对象获取@sid指定用户的所有者权限,<br>
@si参数指定文本格式SID,注意不是内存指针或句柄,<br>
@objType可省略，默认值为_SE_FILE_OBJECT</p>

<p><a id="sys.acl.takeOwnByUserName"></a></p>

<h3>sys.acl.takeOwnByUserName(userName,objName,objType)</h3>

<p>对@objName指定名称的对象获取@userName参数指定用户的所有者权限,<br>
@objType可省略，默认值为_SE_FILE_OBJECT</p>

<p><a href="https://www.aardio.com/zh-cn/doc/library-reference/sys/acl.md">Markdown 格式</a></p>

</body> 
</html>