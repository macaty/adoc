
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言文档 - com.interface 库模块帮助文档'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言文档 - com.interface 库模块帮助文档</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>com.interface 库模块帮助文档</h1>

<p><a id="com"></a></p>

<h2>com 成员列表</h2>

<p><a id="com.interface"></a></p>

<h3>com.interface(com对象,原生接口类)</h3>

<p>参数一可以是com对象、com指针、托管com指针<br>
参数二是com.interface名字空间下的接口类或类名<br>
注意com.interface下接口类中的自定义函数必须用owner代替this,<br>
owner才是com实例对象,this指向的是接口定义结构体</p>

<p><a id="com.interface"></a></p>

<h2>com.interface 成员列表</h2>

<p>所有 COM 原生原生接口定义在此名字空间，<br>
所有 COM 原生接口类中的自定义函数必须用 owner 代替 this,<br>
owner 才是实例对象,this指向的是接口定义结构体<br>
COM 原生接口类在构造函数中使用 this 引用 COM 接口定义结构体</p>

<p><a id="com.interface.IUnknown"></a></p>

<h3>com.interface.IUnknown</h3>

<p>COM 原生接口基类,<br>
所有 COM 原生原生接口必须直接继承此接口,<br>
所有 COM 原生接口类中的自定义函数必须用 owner 代替 this,<br>
owner 才是实例对象,this指向的是接口定义结构体<br>
COM 原生接口类在构造函数中使用 this 引用 COM 接口定义结构体</p>

<p><a id="com.interface.checkError"></a></p>

<h3>com.interface.checkError(/*请输入COM原生接口函数返回值+函数返回值*/,2)</h3>

<p>如果有错误调用error函数抛出异常<br>
参数2指定抛出异常的调用级别<br>
2表示调用当前函数的函数</p>

<p><a id="com.interface.checkError"></a></p>

<h3>com.interface.checkError(请输入COM原生接口函数返回值)</h3>

<p>如果有错误调用error函数抛出异常</p>

<p><a id="com.interface.checkInterface"></a></p>

<h3>com.interface.checkInterface(接口类)</h3>

<p>检查是否com.interface名字空间下的接口类或类名,<br>
不合法则抛出异常,可使用参数2指定调用级别,<br>
成功返回类对象</p>

<p><a id="com.interface.create"></a></p>

<h3>com.interface.create(clsid,原生接口类)</h3>

<p>创建原生接口对象</p>

<p><a id="com.interface.loadTypelibrary"></a></p>

<h3>com.interface.loadTypelibrary(类型库,接口类名)</h3>

<p>自类型库加载接口类,<br>
并在com.interface名字空间创建参数@2指定名称的类,<br>
类型库可以是路径等可传入com.LoadTypeLibrary函数的参数,<br>
也可以是该函数创建的类型库对象,<br>
可选在定义接口类以后,<br>
在该类的名字空间下使用_funtions对象补全函数原型</p>

<p><a id="interfaceObject"></a></p>

<h2>interfaceObject 成员列表</h2>

<p><a id="interfaceObject.AddRef"></a></p>

<h3>interfaceObject.AddRef()</h3>

<p>引用计数加一,返回引用计数</p>

<p><a id="interfaceObject.QueryInterface"></a></p>

<h3>interfaceObject.QueryInterface(接口数)</h3>

<p>参数是接口类,参考com.interface.IUnknown源码</p>

<p><a id="interfaceObject.Release"></a></p>

<h3>interfaceObject.Release()</h3>

<p>引用计数减一,返回引用计数</p>

<h3>自动完成常量</h3>

<p><em>CLSCTX_INPROC=3<br>
_CLSCTX_INPROC_HANDLER=2<br>
_CLSCTX_INPROC_SERVER=1<br>
_CLSCTX_LOCAL_SERVER=4<br>
_CLSCTX_SERVER=5<br>
_FAILED=</em>_/*hr*/ &lt; 0<br>
<em>SUCCEEDED=</em>_/*hr*/ &gt;= 0<br>
_VT_ARRAY=0x2000<br>
_VT_BLOB=0x41<br>
_VT_BLOB_OBJECT=0x46<br>
_VT_BOOL=0xB<br>
_VT_BSTR=8<br>
_VT_BSTR_BLOB=0xFFF<br>
_VT_BYREF=0x4000<br>
_VT_CARRAY=0x1C<br>
_VT_CF=0x47<br>
_VT_CLSID=0x48<br>
_VT_CY=6<br>
_VT_DATE=7<br>
_VT_DECIMAL=0xE<br>
_VT_DISPATCH=9<br>
_VT_EMPTY=0<br>
_VT_ERROR=0xA<br>
_VT_FILETIME=0x40<br>
_VT_HRESULT=0x19<br>
_VT_I1=0x10<br>
_VT_I2=2<br>
_VT_I4=3<br>
_VT_I8=0x14<br>
_VT_ILLEGAL=0xFFFF<br>
_VT_ILLEGALMASKED=0xFFF<br>
_VT_INT=0x16<br>
_VT_INT_PTR=0x25<br>
_VT_LPSTR=0x1E<br>
_VT_LPWSTR=0x1F<br>
_VT_NULL=1<br>
_VT_PTR=0x1A<br>
_VT_R4=4<br>
_VT_R8=5<br>
_VT_RECORD=0x24<br>
_VT_RESERVED=0x8000<br>
_VT_SAFEARRAY=0x1B<br>
_VT_STORAGE=0x43<br>
_VT_STORED_OBJECT=0x45<br>
_VT_STREAM=0x42<br>
_VT_STREAMED_OBJECT=0x44<br>
_VT_TYPEMASK=0xFFF<br>
_VT_UI1=0x11<br>
_VT_UI2=0x12<br>
_VT_UI4=0x13<br>
_VT_UI8=0x15<br>
_VT_UINT=0x17<br>
_VT_UINT_PTR=0x26<br>
_VT_UNKNOWN=0xD<br>
_VT_USERDEFINED=0x1D<br>
_VT_VARIANT=0xC<br>
_VT_VECTOR=0x1000<br>
_VT_VERSIONED_STREAM=0x49<br>
_VT_VOID=0x18  </p>

<p><a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/library-reference/com/interface/_.md  \n\nļ޷ Teleport Ultra , Ϊ Ŀļ͹淶ڡ  \n\nڷϴ?'))window.location='https://www.aardio.com/zh-cn/doc/library-reference/com/interface/_.md'" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/com/interface/_.md">Markdown 格式</a></p>

</body> 
</html>