
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言文档 - dotNet.ps 库模块帮助文档'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言文档 - dotNet.ps 库模块帮助文档</title> 
<link rel="stylesheet" href="../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>dotNet.ps 库模块帮助文档</h1>

<p><a id="dotNet"></a></p>

<h2>dotNet 成员列表</h2>

<p><a id="dotNet.ps"></a></p>

<h3>dotNet.ps(script,parameters,useLocalScope)</h3>

<p>执行PowerShell脚本，返回输出字符串。<br>
@script 参数指定PowerShell脚本或脚本路径，<br>
可选用@parameters参数指定一个表，包含调用参数名值对，<br>
@parameters参数既可以包含名值对，也可以包含仅指定参数名的数组，<br>
表里的参数名不需要加 $或 - 前缀，PowerShell里要加$前缀，<br>
参数值可以使用任何 .Net 支持的数据类型，<br>
如果 @parameters 是字符串，则后面可以添加任意个数字符串参数，<br>
@useLocalScope 为可选参数，@parameters 为字符串时无 @useLocalScope 参数<br>
PowerShell 脚本用 param 接收命名参数,<br>
用 args 接收匿名参数</p>

<p><a id="dotNet.ps"></a></p>

<h2>dotNet.ps 成员列表</h2>

<p>支持 Windows PowerShell 2.0 以上。<br>
Win7 自带 PowerShell 2.0，可回调 dotNet.ps.export 导出的 aardio 参数对象。<br>
Win10/Win11 自带 PowerShell 5.1，已支持直接回调 aardio 参数对象。</p>

<p><a id="dotNet.ps.command"></a></p>

<h3>dotNet.ps.command(command,parameters,useLocalScope)</h3>

<p>执行 PowerShell 命令，<br>
成功返回输出字符串,失败返回null,错误信息。<br>
可选用@parameters参数指定一个表，包含调用参数名值对，<br>
@parameters参数既可以包含名值对，也可以包含仅指定参数名的数组，<br>
表里的参数名不需要加 $或 - 前缀，<br>
参数值可以使用任何 .Net 支持的数据类型，<br>
如果 @parameters 是字符串，则后面可以添加任意个数字符串参数，<br>
@useLocalScope 为可选参数，@parameters 为字符串时无 @useLocalScope 参数</p>

<p><a id="dotNet.ps.export"></a></p>

<h3>dotNet.ps.export()</h3>

<p>将参数 @1 指定的 aardio 表对象转换为 PowerShell 参数对象<br>
在 PowerShell 中可使用  InvokeMember 调用成员函数，参数@1为成员函数名，<br>
也可以使用下标读写对象属性值。  </p>

<p>Win10/Win11 自带 PowerShell 5.1 已经直接支持回调 aardio 对象，<br>
如果不需要兼容旧版 PowerShell 则不需要使用此函数</p>

<p><a id="dotNet.ps.json"></a></p>

<h3>dotNet.ps.json(ps,parameters,useLocalScope)</h3>

<pre><code class="aardio language-aardio">dotNet.ps.json(`ConvertTo-Json /*执行 PowerShell 脚本，所有参数与 dotNet.ps 相同。  
ConvertTo-Json 兼容到 PowerShell 2.0，  
返回文本作为 JSON 自动解析为 aardio 对象*/`)
</code></pre>

<p><a id="dotNet.ps.onWrite"></a></p>

<h3>dotNet.ps.onWrite</h3>

<pre><code class="aardio language-aardio">dotNet.ps.onWrite = function(str){
    /*PowerShell 输出文本回调此函数，  
参数 @str 为待输出的字符串*/
}
</code></pre>

<p><a id="dotNet.ps.onWriteProgress"></a></p>

<h3>dotNet.ps.onWriteProgress</h3>

<pre><code class="aardio language-aardio">dotNet.ps.onWriteProgress = function(sourceId,record){
    /*PowerShell 进度条回调此函数，  
参数 record.Activity 为任务标题，  
参数 record.StatusDescription 为进度描述，  
参数 record.PercentComplete 为进度百分比，  
PowerShell 回调出错不会抛出异常，  
如果有需要在函数内部自行 try catch 捕获代码错误*/
    winform.plus.text = record.StatusDescription;
    winform.plus.progressPercentage = record.PercentComplete; 
}
</code></pre>

<p><a href="https://www.aardio.com/zh-cn/doc/library-reference/dotNet/ps.md">Markdown 格式</a></p>

</body> 
</html>