
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言文档 - inet.http 库模块帮助文档'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言文档 - inet.http 库模块帮助文档</title> 
<link rel="stylesheet" href="../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>inet.http 库模块帮助文档</h1>

<p><details>  <summary>入门教程</summary>  <p>
inet.http 与 inet.whttp 用法与接口基本相同，一般可相互替代。
普通桌面客户端软件(非NT服务)请使用 inet.http（WinINet） 而不应该使用 inet.whttp（WinHTTP）。
基于 inet.http 而封装的 web.rest.client 可能在很多应用中都是更好的选择。</p>

<p>inet.http 入门教程：
<a href="../../library-guide/std/inet/http.html" tppabs="https://www.aardio.com/zh-cn/doc/library-guide/std/inet/http.html">https://www.aardio.com/zh-cn/doc/library-guide/std/inet/http.html</a></p>

<p>inet.http 错误代码请参考库 inet.errorMessage
</p></details></p>

<p><a id="inet"></a></p>

<h2>inet 成员列表</h2>

<p><a id="inet.http"></a></p>

<h3>inet.http(&quot;UserAgent&quot;,&quot;代理服务器&quot;,&quot;绕过代理的主机&quot;,连接选项)</h3>

<p>创建 HTTP 客户端，所有参数可选。<br>
UserAgent 用于自定义 User-Agent 请求标头，用于服务器识别请求程序特征。<br>
代理服务器指定为&quot;&quot;或&quot;IE&quot;使用系统代理设置（默认值）。<br>
HTTP 代理服务器请指定为 &quot;代理服务器地址:端口&quot; 格式，  </p>

<p>SOCKS 代理服务器请指定为 &quot;socks=代理服务器地址:端口&quot; 格式<br>
└──  <a href="../../library-guide/std/inet/proxy.html" tppabs="https://www.aardio.com/zh-cn/doc/library-guide/std/inet/proxy.html">代理格式说明</a>  </p>

<p>&quot;绕过代理的主机&quot; 用法参考 inet.setProxy 源码的示例，一般不需要指定。<br>
连接选项可用一个数值参数指定打开会话的选项，一般不需要指定。</p>

<p><a id="inet.http"></a></p>

<h3>inet.http(&quot;UserAgent&quot;,false)</h3>

<p>禁用代理，UserAgent 为可选参数</p>

<p><a id="inet.http"></a></p>

<h3>inet.http()</h3>

<p><a href="#inetHttpObject">返回对象:inetHttpObject</a></p>

<p><a id="inet.http"></a></p>

<h2>inet.http 成员列表</h2>

<p>WinINet 支持库<br>
支持进程内多对象共享会话 cookie,支持持久化 cookie<br>
与 web.form 浏览器控件,IE 浏览器共享 cookie 与代理设置。  </p>

<p>inet.http 错误代码请参考库 inet.errorMessage</p>

<p>创建HTTP会话对象,所有参数可选，<br>
注意提前导入zlib库，readAll 函数才能支持 gzip 自动解压。</p>

<p><a id="inet.http.get"></a></p>

<h3>inet.http.get(url,headers,referer)</h3>

<p>用于界面线程创建线程并获取 @url 指定网址的数据,<br>
此函数等待下载完成但不会阻塞界面消息循环,<br>
可选用 @headers 指定 HTTP 头,<br>
可选用 @referer 指定引用网址,<br>
所有参数用法与 格式请参考 inet.http 对象的 get 函数相同</p>

<p><a id="inet.http.import"></a></p>

<h3>inet.http.import(url)</h3>

<p>自url指定的网址自远程导入单页扩展库<br>
网址尾部的文件名必须以&quot;扩展库名字空间&quot; + &quot;.aardio&quot; 结尾<br>
例如: inet.http.import(&quot;<a href="http://download.aardio.com/inetlib/remote.test.aardio%22">http://download.aardio.com/inetlib/remote.test.aardio&quot;</a>)<br>
远程库代码里只能导入执行文件已经自带的库</p>

<p><a id="inet.http.isAlive"></a></p>

<h3>inet.http.isAlive(&quot;UserAgent&quot;,&quot;代理服务器&quot;,&quot;绕过代理的主机&quot;,连接选项)</h3>

<p>当前是否能正常访问互联网,所有参数可选</p>

<p><a id="inet.http.status"></a></p>

<h3>inet.http.status(url,noAutoRedirect,httpMethod)</h3>

<p>对 @url 指定网址发送请求并返回 HTTP 状态码。<br>
如果未成功发送请求则返回 null。<br>
可选参数 @noAutoRedirect 为 true 则禁止自动重定向，默认为 false。<br>
可选用 @httpMethod 参数指定 HTTP 请求方法，默认为 &quot;HEAD&quot;。  </p>

<p>大部分网址请求成功会返回 200 状态码。<br>
部分网址会返回 2xx 状态码，重定向返回 3xx 状态码。<br>
可用状态码请参考 inet.httpStatusCode 库</p>

<p><a id="inet.http.userAgent"></a></p>

<h3>inet.http.userAgent</h3>

<p>创建 inet.http 对象且未明确指定 user agent 参数时使用的默认值 。<br>
适用于 inet.http 以及所有基于 inet.http 创建的对象，例如：<br>
 inet.httpFile, inet.downBox, web.rest, inet.installer 等</p>

<p><a id="httpheadercontentObject"></a></p>

<h2>httpheadercontentObject 成员列表</h2>

<p><a id="httpheadercontentObject.disposition.filename"></a></p>

<h3>httpheadercontentObject.disposition.filename</h3>

<p>下载文件名</p>

<p><a id="httpheadercontentObject.disposition.type"></a></p>

<h3>httpheadercontentObject.disposition.type</h3>

<p>文件类型,该值可能为空,<br>
inline表示用于网页显示<br>
attachment表示需要下载存储的附件</p>

<p><a id="httpheadercontentObject.type"></a></p>

<h3>httpheadercontentObject.type</h3>

<p>返回MIME类型</p>

<p><a id="httprangeheadersObject"></a></p>

<h2>httprangeheadersObject 成员列表</h2>

<p><a id="httprangeheadersObject.acceptRanges"></a></p>

<h3>httprangeheadersObject.acceptRanges</h3>

<p>如果值为：&quot;bytes&quot; 则表示该文件支持断点续传</p>

<p><a id="httprangeheadersObject.eTag"></a></p>

<h3>httprangeheadersObject.eTag</h3>

<p>该文件唯一的标志值,用于验证</p>

<p><a id="httprangeheadersObject.lastModified"></a></p>

<h3>httprangeheadersObject.lastModified</h3>

<p>存放服务端文件的最后修改时间,用于验证</p>

<p><a id="inetHttpObject"></a></p>

<h2>inetHttpObject 成员列表</h2>

<p><a id="inetHttpObject._defaultRequestErrHandle"></a></p>

<h3>inetHttpObject._defaultRequestErrHandle</h3>

<pre><code class="aardio language-aardio">inetHttpObject._defaultRequestErrHandle[0x2F06/*_ERROR_INTERNET_SEC_CERT_CN_INVALID*/] = function() { 
    owner.setRequestOption(0x1F/*_INTERNET_OPTION_SECURITY_FLAGS*/,0x1000|0x2000|0x100|0x200|0x80);
    return true;/*添加 HTTP 请求错误处理程序，已清除错误并允许重试请返回 true */
}
</code></pre>

<p><a id="inetHttpObject.accept"></a></p>

<h3>inetHttpObject.accept</h3>

<p>指定可选择的文件类型,多个类型使用逗号分隔<br>
默认无需指定,也可以在参数中指定</p>

<p><a id="inetHttpObject.addHeaders"></a></p>

<h3>inetHttpObject.addHeaders</h3>

<p>设置所有请求默认添加的HTTP头<br>
请求结束时不会清空此属性<br>
该值可以是 web.joinHeaders 函数支持的字符串、表（数组、键值对）</p>

<p><a id="inetHttpObject.afterSend"></a></p>

<h3>inetHttpObject.afterSend</h3>

<pre><code class="aardio language-aardio">inetHttpObject.afterSend = function(statusCode,contentLength){
    /*向服务器发送数据结束触发此回调函数  
如果在这里读取全部HTTP头则会自动保存到 inetHttpObject.responseHeaders属性  
即使结束请求所有读取HTTP头的函数将继续有效*/
    owner.readHeader();  
}
</code></pre>

<p><a id="inetHttpObject.beforeSend"></a></p>

<h3>inetHttpObject.beforeSend</h3>

<pre><code class="aardio language-aardio">inetHttpObject.beforeSend = function(){
    /*已准备向服务器发送数据触发此回调函数*/ 
}
</code></pre>

<p><a id="inetHttpObject.beginRequest"></a></p>

<h3>inetHttpObject.beginRequest(url,method,referer,accept,flags,connectFlags)</h3>

<p>打开连接并准备发送请求<br>
除URL以外,所有参数可选<br>
method参数指定HTTP请求方法，<br>
referer参数指定引用页,默认使用上一次访问的网址作为下一次的引用网址<br>
accept指定客户端接受的MIME内容类型,参考HTTP请求头该字段说明<br>
flags参数为_INTERNET_FLAG_开头的常量用于指定请求选项,<br>
connectFlags用于指定调打开连接选项,<br>
flags,connectFlags一般用不到，详细的用法请参考此函数源码以及相关API文档</p>

<p><a id="inetHttpObject.beginSendData"></a></p>

<h3>inetHttpObject.beginSendData(数据长度)</h3>

<p>发送请求,参数为待上传的数据总长度,默认为0<br>
失败返回:null,错误信息,错误代码</p>

<p><a id="inetHttpObject.bufferSize"></a></p>

<h3>inetHttpObject.bufferSize</h3>

<p>默认缓冲区大小<br>
默认为10KB</p>

<p><a id="inetHttpObject.bufferTotal"></a></p>

<h3>inetHttpObject.bufferTotal</h3>

<p>上传数据总长度<br>
即beginSendData()参数传入的数值</p>

<p><a id="inetHttpObject.close"></a></p>

<h3>inetHttpObject.close()</h3>

<p>释放资源<br>
http对象支持自动析构,即使不调用此函数资源也会自动释放</p>

<p><a id="inetHttpObject.codepage"></a></p>

<h3>inetHttpObject.codepage</h3>

<p>设置post函数上传参数为表并转换为字符串时UrlEncode的输出代码页</p>

<p><a id="inetHttpObject.connectFlags"></a></p>

<h3>inetHttpObject.connectFlags</h3>

<p>指定打开服务端连接的默认选项<br>
此选项一般用户不需要了解，如果需要请参考beginRequest函数的源码以及相关API文档</p>

<p><a id="inetHttpObject.contentLength"></a></p>

<h3>inetHttpObject.contentLength</h3>

<p>send()函数执行后返回的文件长度</p>

<p><a id="inetHttpObject.disableCache"></a></p>

<h3>inetHttpObject.disableCache()</h3>

<p>强制刷新<br>
可在参数中指定是否禁用缓存</p>

<p><a id="inetHttpObject.disableCookies"></a></p>

<h3>inetHttpObject.disableCookies()</h3>

<p>禁止自动添加、管理cookie的功能,<br>
需要自行在HTTP请求头、响应头中分析处理cookie<br>
可在参数中指定是否禁用cookies</p>

<p><a id="inetHttpObject.disableRedirects"></a></p>

<h3>inetHttpObject.disableRedirects()</h3>

<p>禁用重定向<br>
可在参数中指定是否禁用重定向</p>

<p><a id="inetHttpObject.down"></a></p>

<h3>inetHttpObject.down(url,postdata,headers,referer,accept,method,flags,connectFlags,noReceiveData)</h3>

<p>发送请求并下载数据,get,post等调用此函数<br>
不建议直接调用此函数，参数:  </p>

<p>url:网址,除这个参数必须指定以外，后面其他参数都是可选参数<br>
postdata:提交数据<br>
headers:http头,可以是web.joinHeaders支持的字符串、键值对、数组等格式<br>
referer:http引用网址,默认使用上一次访问的网址作为下一次的引用网址<br>
accept: 此参数用于HTTP请求头accept字段，用于指定可识别的内容类型列表<br>
flags: 用于设置请求选项,参考beginRequest函数说明<br>
connectFlags:用于打开连接选项,参考beginRequest函数说明<br>
noReceiveData: 指定为真则不下载服务器回应数据  </p>

<p>本地内部错误返回值为:null,错误信息,错误代码<br>
服务端返回HTTP错误时返回值为:false,错误信息,HTTP错误代码<br>
成功返回字符串对象</p>

<p><a id="inetHttpObject.eachLine"></a></p>

<h3>inetHttpObject.eachLine</h3>

<pre><code class="aardio language-aardio">for(str,size in inetHttpObject.eachLine() ){ 
    /*每次读取一行数据，忽略回车，去掉换行符*/ 
}
</code></pre>

<p><a id="inetHttpObject.eachRead"></a></p>

<h3>inetHttpObject.eachRead</h3>

<pre><code class="aardio language-aardio">for(str,size in inetHttpObject.eachRead() ){ 
    /*循环读取数据，可选在 eachRead 的参数@1 指定缓冲区大小*/  
}
</code></pre>

<p><a id="inetHttpObject.eachReadBuffer"></a></p>

<h3>inetHttpObject.eachReadBuffer(缓冲区,长度)</h3>

<pre><code class="aardio language-aardio">var buffer = .raw.bufferc( 1024 * 10 );  
for( size in inetHttpObject.eachReadBuffer( buffer ) ){ 

}
</code></pre>

<p><a id="inetHttpObject.enable"></a></p>

<h3>inetHttpObject.enable(flags,enabled)</h3>

<p>是否启用指定的请求选项<br>
此函数修改对象的flags属性,但不会影响参数中未指定的选项</p>

<p><a id="inetHttpObject.endRequest"></a></p>

<h3>inetHttpObject.endRequest()</h3>

<p>关闭请求,与beginRequest配对使用.</p>

<p><a id="inetHttpObject.endSendData"></a></p>

<h3>inetHttpObject.endSendData()</h3>

<p>write()函数写完所有上传数据以后,<br>
必须调用此函数结束上传,<br>
成功返回: true,状态码,文件长度<br>
出错返回:null,错误信息,错误代码<br>
注意只有在调用此函数以后,才能使用其他读写HTTP头的函数.</p>

<p><a id="inetHttpObject.flags"></a></p>

<h3>inetHttpObject.flags</h3>

<pre><code class="aardio language-aardio">inetHttpObject.flags = _INTERNET_FLAG_/*  
指定打开网址请求的默认选项  
禁用自动cookie管理请指定_INTERNET_FLAG_NO_COOKIE  

此选项一般用户不需要了解，  
请参考beginRequest函数的源码以及相关API文档  
*/
</code></pre>

<p><a id="inetHttpObject.get"></a></p>

<h3>inetHttpObject.get(url,http头,引用网址,MIME)</h3>

<p>向服务器发送GET请求并下载服务器返回的数据,<br>
此函数会顺序调用 beginRequest(), send()，<br>
如果指定了onReceive回调函数,则调用该函数接收数据(成功返回true)<br>
否则，调用readAll()等函数并返回下载数据，  </p>

<p>除URL外,其他为可选参数<br>
http头可以是web.joinHeaders支持的字符串、键值对、数组等格式<br>
默认使用上一次访问的网址作为下一次的引用网址<br>
本地内部错误返回值为:null,错误信息,错误代码<br>
服务端返回HTTP错误时返回值为:false,错误信息,HTTP错误代码<br>
成功返回字符串对象</p>

<p><a id="inetHttpObject.getTime"></a></p>

<h3>inetHttpObject.getTime()</h3>

<p>返回目标文件最后修改时间(不支持动态网页)</p>

<p><a id="inetHttpObject.getUserAgent"></a></p>

<h3>inetHttpObject.getUserAgent()</h3>

<p>返回HTTP客户端请求HTTP头中用户代理头的值,<br>
该值可在创建HTTP客户端的构造参数中指定</p>

<p><a id="inetHttpObject.head"></a></p>

<h3>inetHttpObject.head</h3>

<p>发送 HEAD 请求获取 HTTP 头<br>
此函数不会直接返回 HTTP 头，<br>
但函数返回后可使用 readHeader 函数读取 HTTP 响应头</p>

<p><a id="inetHttpObject.head"></a></p>

<h3>inetHttpObject.head(url,http头,引用网址,MIME)</h3>

<p>发送 HEAD 请求获取 HTTP 头<br>
此函数不会直接返回 HTTP 头，<br>
但函数返回后可使用 readHeader 函数读取 HTTP 响应头  </p>

<p>除URL外,其他为可选参数<br>
默认使用上一次访问的网址作为下一次的引用网址<br>
本地内部错误返回值为:null,错误信息,错误代码,<br>
服务端返回 HTTP 错误代码时返回值为:false，<br>
成功返回 true</p>

<p><a id="inetHttpObject.headEx"></a></p>

<h3>inetHttpObject.headEx(url,请求方法,提交数据,http头,引用网址,MIME)</h3>

<p>使用指定的请求方法模拟HEAD方法,用于拒绝HEAD请求的网址<br>
除网址以外所有参数可以省略,默认为使用GET方法</p>

<p><a id="inetHttpObject.headers"></a></p>

<h3>inetHttpObject.headers</h3>

<p>设置本次请求的HTTP头<br>
此属性会在每次发送请求以后,接收数据以前,初始化为空值<br>
该值可以是 web.joinHeaders 函数支持的字符串、表（数组、键值对）</p>

<p><a id="inetHttpObject.lastReadErrCode"></a></p>

<h3>inetHttpObject.lastReadErrCode</h3>

<p>最后一次读取数据是否遇到错误,例如网络断开连接等等</p>

<p><a id="inetHttpObject.lastRequestUrl"></a></p>

<h3>inetHttpObject.lastRequestUrl</h3>

<p>最后一次请求成功的URL</p>

<p><a id="inetHttpObject.lastResponse"></a></p>

<h3>inetHttpObject.lastResponse()</h3>

<p>获取最后一次服务器返回的原始数据,<br>
仅在调用了readAll函数、或在get,post函数中间接调用readAll函数时设置该值</p>

<p><a id="inetHttpObject.location"></a></p>

<h3>inetHttpObject.location(url,请求方法,提交数据,http头,引用网址,MIME)</h3>

<p>获取最后一次重定向URL<br>
如果省略url参数,则取最后一次请求成功的网址<br>
如果发生了重定向,返回重定向后的网址<br>
如果不存在重定向返回原网址</p>

<p><a id="inetHttpObject.mergeHeader"></a></p>

<h3>inetHttpObject.mergeHeader(&quot;Name:value&quot;)</h3>

<p>写入请求 HTTP 头,<br>
参数可以是 web.joinHeaders 函数支持的字符串、表（数组、键值）。<br>
如果存在同名 HTTP 头则合并，<br>
可使用第二个参数指定分隔符为逗号或分号，默认为逗号。<br>
函数执行成功返回 true  </p>

<p>必须在 send 发送请求以前调用,<br>
可在 beforeSend 事件内调用</p>

<p><a id="inetHttpObject.onReceive"></a></p>

<h3>inetHttpObject.onReceive</h3>

<pre><code class="aardio language-aardio">inetHttpObject.onReceive = function(str,size,contentLength){
    /*定义了此函数循环接收数据,则 get,post 等函数返回布尔值*/
}
</code></pre>

<p><a id="inetHttpObject.onReceiveBegin"></a></p>

<h3>inetHttpObject.onReceiveBegin</h3>

<pre><code class="aardio language-aardio">inetHttpObject.onReceiveBegin = function(statusCode,contentLength){
    if( statusCode == 206/*断点续传*/  ){
        /*该事件函数在接收数据以前触发*/
    }
}
</code></pre>

<p><a id="inetHttpObject.onSend"></a></p>

<h3>inetHttpObject.onSend</h3>

<pre><code class="aardio language-aardio">inetHttpObject.onSend = function(remainSize){
    /*如果不指定上传数据,send函数会自动调用该函数获取数据直至此函数返回空值为止*/
    return str,len;
}
</code></pre>

<p><a id="inetHttpObject.onSendBegin"></a></p>

<h3>inetHttpObject.onSendBegin</h3>

<pre><code class="aardio language-aardio">inetHttpObject.onSendBegin = function(){
    return len/*上传长度*/;
}
</code></pre>

<p><a id="inetHttpObject.parseStreamData"></a></p>

<h3>inetHttpObject.parseStreamData</h3>

<pre><code class="aardio language-aardio">inetHttpObject.parseStreamData = function(data){
    /*如果 ContentType 响应类型为 text/event-stream，  
则 eachRead 与 onReceive 回调会自动调用 parseStreamData 提前转换数据。  
如果 ContentType 响应类型为 application/x-ndjson，  
则 onReceive 回调会自动调用 parseStreamData 提前转换数据  
web.rest.client 会自动设定此回调*/
    return data;
}
</code></pre>

<p><a id="inetHttpObject.password"></a></p>

<h3>inetHttpObject.password</h3>

<p>默认登录密码,<br>
支持 Basic , Digest 认证</p>

<p><a id="inetHttpObject.post"></a></p>

<h3>inetHttpObject.post(url,post数据,http头,引用网址,MIME)</h3>

<p>向服务器发送POST请求并下载服务器返回的数据,<br>
如果post数据是一个表，则自动调用 inet.url.stringifyParameters 转换为字符串,<br>
此函数会顺序调用 beginRequest(), send()，<br>
如果指定了onReceive回调函数,则调用该函数接收数据(成功返回true)<br>
否则，调用readAll()等函数并返回下载数据，  </p>

<p>除URL与post数据以外,其他为可选参数<br>
http头可以是web.joinHeaders支持的字符串、键值对、数组等格式<br>
默认使用上一次访问的网址作为下一次的引用网址<br>
本地内部错误返回值为:null,错误信息,错误代码<br>
服务端返回HTTP错误时返回值为:false,错误信息,HTTP错误代码<br>
成功返回字符串对象</p>

<p><a id="inetHttpObject.queryNumber"></a></p>

<h3>inetHttpObject.queryNumber(_HTTP_QUERY_FLAG指定要返回的头信息)</h3>

<p>取HTTP头数值</p>

<p><a id="inetHttpObject.read"></a></p>

<h3>inetHttpObject.read(读取长度)</h3>

<p>长度参数可选<br>
返回读取字符串,以及长度<br>
失败返回false,错误信息<br>
该函数必须在send请求以后调用</p>

<p><a id="inetHttpObject.readAll"></a></p>

<h3>inetHttpObject.readAll()</h3>

<p>读取所有返回数据<br>
该函数必须在send请求以后调用</p>

<p><a id="inetHttpObject.readBuffer"></a></p>

<h3>inetHttpObject.readBuffer(buffer,写入长度)</h3>

<p>下载文件数据<br>
参数一必须是使用 buffer 对象<br>
长度参数可选,默认为缓冲区长度</p>

<p><a id="inetHttpObject.readHeader"></a></p>

<h3>inetHttpObject.readHeader</h3>

<p>获取返回的HTTP头</p>

<p><a id="inetHttpObject.readHeader"></a></p>

<h3>inetHttpObject.readHeader(&quot;Content-Length:&quot;)</h3>

<p>获取单个指定的 HTTP 服务器响应头，返回字符串。<br>
参数指定HTTP头名字或部分名字，忽略大小写，忽略冒号以后部分。  </p>

<p>必须在 send 发送请求以后才能调用此函数。<br>
如果调用 get,post,down 函数可在 afterSend 事件中调用此函数。   </p>

<p>默认在请求结束后此函数不可用。<br>
除非调用 head 函数发送请求，或调用 down 函数指定不返回数据，<br>
则请求结束 readHeader 等读取 HTTP 头的函数仍然可用。  </p>

<p>如果无参数调用了此函数，则返回全部请求头（以回车换行作为分隔符）。<br>
并且直到下次请求以前，HTTP 响应头都会缓存在 responseHeaders 属性中，<br>
后续就可以自由使用所有读取 HTTP 头的函数</p>

<p><a id="inetHttpObject.readHeader"></a></p>

<h3>inetHttpObject.readHeader()</h3>

<p>获取服务器返回的 HTTP 响应头，<br>
必须在 send 发送请求以后才能调用此函数。<br>
如果调用 get,post,down 函数可在 afterSend 事件中调用此函数。   </p>

<p>默认在请求结束后此函数不可用。<br>
除非调用 head 函数发送请求，或调用 down 函数指定不返回数据，<br>
则请求结束 readHeader 等读取 HTTP 头的函数仍然可用。  </p>

<p>如果无参数调用了此函数，则返回全部请求头（以回车换行作为分隔符）。<br>
并且直到下次请求以前，HTTP 响应头都会缓存在 responseHeaders 属性中，<br>
后续就可以自由使用所有读取 HTTP 头的函数</p>

<p><a id="inetHttpObject.readHeaderContent"></a></p>

<h3>inetHttpObject.readHeaderContent()</h3>

<p>读取HTTP头中文件下载相关信息  </p>

<p><a href="#httpheadercontentObject">返回对象:httpheadercontentObject</a></p>

<p><a id="inetHttpObject.readHeaderList"></a></p>

<h3>inetHttpObject.readHeaderList(&quot;字符串参数&quot;)</h3>

<p>获取所有指定字符串作为开始段的 HTTP 头。<br>
忽略大小写，不忽略冒号以后部分。<br>
不指定参数则读取全部响应头。<br>
返回键值对组成的表对象，键名转为小写，每个值都是一个数组。<br>
必须在 send 发送请求以后才能调用此函数。<br>
如果调用 get,post,down 函数可在 afterSend 事件中调用此函数。   </p>

<p>默认在请求结束后此函数不可用。<br>
除非调用 head 函数发送请求，或调用 down 函数指定不返回数据，<br>
则请求结束 readHeader 等读取 HTTP 头的函数仍然可用。  </p>

<p>如果无参数调用了此函数，则返回全部请求头（以回车换行作为分隔符）。<br>
并且直到下次请求以前，HTTP 响应头都会缓存在 responseHeaders 属性中，<br>
后续就可以自由使用所有读取 HTTP 头的函数</p>

<p><a id="inetHttpObject.readHeaderRange"></a></p>

<h3>inetHttpObject.readHeaderRange()</h3>

<p>读取HTTP头中断点续传相关验证信息  </p>

<p><a href="#httprangeheadersObject">返回对象:httprangeheadersObject</a></p>

<p><a id="inetHttpObject.referer"></a></p>

<h3>inetHttpObject.referer</h3>

<p>引用页地址,此属性会自动设置为上次打开的网址<br>
建议在参数中指定</p>

<p><a id="inetHttpObject.replaceHeader"></a></p>

<h3>inetHttpObject.replaceHeader(&quot;Name:value&quot;)</h3>

<p>写入请求 HTTP 头,<br>
参数可以是 web.joinHeaders 函数支持的字符串、表（数组、键值）。<br>
如果存在相同的 HTTP 头则覆盖，否则忽略。<br>
函数执行成功返回 true  </p>

<p>必须在 send 发送请求以前调用,<br>
可在 beforeSend 事件内调用</p>

<p><a id="inetHttpObject.responseContentEncoding"></a></p>

<h3>inetHttpObject.responseContentEncoding</h3>

<p>应答HTTP头的Content-Encoding值<br>
如果该值为&quot;gzip&quot;,通过readAll函数一次读取下载数据时会自动解压,<br>
解压后该值将设为null值</p>

<p><a id="inetHttpObject.responseContentType"></a></p>

<h3>inetHttpObject.responseContentType</h3>

<p>每次发送请求后重置该值为服务器应答Content-Type头<br>
使用该值获取服务器返回的文档类型</p>

<p><a id="inetHttpObject.responseHeaders"></a></p>

<h3>inetHttpObject.responseHeaders</h3>

<p>无参数调用 readHeader 函数时会保存HTTP头在该属性中<br>
即使在请求结束以后，所有读取HTTP头的函数都可以继续使用<br>
调用head函数发送请求时会自动读取所有HTTP头到该属性中<br>
该属性值每次发送新的请求前会自动清空</p>

<p><a id="inetHttpObject.securityFlagIgnoreCertCnInvalid"></a></p>

<h3>inetHttpObject.securityFlagIgnoreCertCnInvalid</h3>

<p>HTTPS请求自动忽略无效CN名称</p>

<p><a id="inetHttpObject.securityFlagIgnoreCertDateInvalid"></a></p>

<h3>inetHttpObject.securityFlagIgnoreCertDateInvalid</h3>

<p>HTTPS请求自动忽略过期证书</p>

<p><a id="inetHttpObject.securityFlagIgnoreRevocation"></a></p>

<h3>inetHttpObject.securityFlagIgnoreRevocation</h3>

<p>忽略服务器证书吊销</p>

<p><a id="inetHttpObject.securityFlagIgnoreUnknownCa"></a></p>

<h3>inetHttpObject.securityFlagIgnoreUnknownCa</h3>

<p>HTTPS请求自动忽略无效CA证书</p>

<p><a id="inetHttpObject.securityFlagIgnoreWrongUsage"></a></p>

<h3>inetHttpObject.securityFlagIgnoreWrongUsage</h3>

<p>HTTPS请求自动忽略错误用法</p>

<p><a id="inetHttpObject.send"></a></p>

<h3>inetHttpObject.send(上传数据)</h3>

<p>参数可选,调用beginSendData(上传数据),然后调用endSendData()<br>
成功返回: true,状态码,文件长度<br>
出错返回:null,错误信息,错误代码</p>

<p><a id="inetHttpObject.send"></a></p>

<h3>inetHttpObject.send(可选输入postdata)</h3>

<p>此函数顺序调用 beginSendData() writeData() endSendData() 发送请求<br>
成功返回: true,状态码,文件长度<br>
出错返回:null,错误信息,错误代码</p>

<p><a id="inetHttpObject.setAuth"></a></p>

<h3>inetHttpObject.setAuth(&quot;用户名&quot;,&quot;密码&quot;)</h3>

<p>为当前打开请求设置登录信息<br>
成功返回true</p>

<p><a id="inetHttpObject.setProxyAuth"></a></p>

<h3>inetHttpObject.setProxyAuth(&quot;用户名&quot;,&quot;密码&quot;)</h3>

<p>设置代理服务器登录用户名,密码</p>

<p><a id="inetHttpObject.setRequestOption"></a></p>

<h3>inetHttpObject.setRequestOption( _INTERNET_OPTION, )</h3>

<p>设置会话选项,<br>
参数可以是数值或结构体<br>
用法参数MSDN</p>

<p><a id="inetHttpObject.setSessionOption"></a></p>

<h3>inetHttpObject.setSessionOption( _INTERNET_OPTION, )</h3>

<p>设置会话选项,<br>
参数可以是数值或结构体<br>
用法参数MSDN</p>

<p><a id="inetHttpObject.setTimeouts"></a></p>

<h3>inetHttpObject.setTimeouts(连接超时,请求超时,接收超时)</h3>

<p>设置超时,以亳秒为单位(1秒为1000毫秒)</p>

<p><a id="inetHttpObject.statusCode"></a></p>

<h3>inetHttpObject.statusCode</h3>

<p>最后一次发送请求后服务端返回的HTTP状态码<br>
100 ~ 101 为信息提示<br>
200 ~ 206 表示请求成功<br>
300 ~ 305 表示重定向<br>
400 ~ 415 表求客户端请求出错<br>
500 ~ 505 表示服务端错误<br>
注意每次HTTP请求开始该值初始化为空,服务器应答后才会设置该值</p>

<p><a id="inetHttpObject.username"></a></p>

<h3>inetHttpObject.username</h3>

<p>默认登录用户名,<br>
支持 Basic , Digest 认证</p>

<p><a id="inetHttpObject.writeBuffer"></a></p>

<h3>inetHttpObject.writeBuffer(buffer,写入长度)</h3>

<p>上传文件数据<br>
参数一必须是使用 buffer 对象<br>
长度参数可选,默认为缓冲区长度</p>

<p><a id="inetHttpObject.writeData"></a></p>

<h3>inetHttpObject.writeData(上传数据)</h3>

<p>上传文件数据,支持一个或多个参数,<br>
返回写入数据的总长度,失败返回空或0<br>
调用此函数前必须调用beginSendData()<br>
写完所有数据后 必须调用 endSendData();</p>

<p><a id="inetHttpObject.writeHeader"></a></p>

<h3>inetHttpObject.writeHeader(&quot;Name:value&quot;)</h3>

<p>写入请求 HTTP 头,<br>
参数可以是 web.joinHeaders 函数支持的字符串、表（数组、键值）。<br>
如果存在相同的 HTTP 头则覆盖，否则添加 HTTP 头。<br>
函数执行成功返回 true  </p>

<p>必须在 send 发送请求以前调用,<br>
可在 beforeSend 事件内调用</p>

<p><a id="inetHttpObject.writeHeaderRange"></a></p>

<h3>inetHttpObject.writeHeaderRange(rangeHeaderInfo,开始位置,结束位置)</h3>

<p>rangeHeaderInfo使用readHeaderRange()函数读取,<br>
其它参数可选,开始位置默认为0,结束位置默认为文件尾</p>

<h3>自动完成常量</h3>

<p>_HTTP_ADDREQ_FLAGS_MASK=0xFFFF0000<br>
_HTTP_ADDREQ_FLAG_ADD=0x20000000<br>
_HTTP_ADDREQ_FLAG_COALESCE_WITH_COMMA=0x40000000<br>
_HTTP_ADDREQ_FLAG_COALESCE_WITH_SEMICOLON=0x1000000<br>
_HTTP_ADDREQ_FLAG_REPLACE=0x80000000<br>
_HTTP_ADDREQ_INDEX_MASK=0xFFFF<br>
_INTERNET_FLAG_ASYNC=0x10000000<br>
_INTERNET_FLAG_CACHE_ASYNC=0x80<br>
_INTERNET_FLAG_CACHE_IF_NET_FAIL=0x10000<br>
_INTERNET_FLAG_DONT_CACHE=0x4000000<br>
_INTERNET_FLAG_EXISTING_CONNECT=0x20000000<br>
_INTERNET_FLAG_FORMS_SUBMIT=0x40<br>
_INTERNET_FLAG_FROM_CACHE=0x1000000<br>
_INTERNET_FLAG_FWD_BACK=0x20<br>
_INTERNET_FLAG_HYPERLINK=0x400<br>
_INTERNET_FLAG_IDN_DIRECT=0x1<br>
_INTERNET_FLAG_IDN_PROXY=0x2<br>
_INTERNET_FLAG_IGNORE_CERT_CN_INVALID=0x1000<br>
_INTERNET_FLAG_IGNORE_CERT_DATE_INVALID=0x2000<br>
_INTERNET_FLAG_IGNORE_REDIRECT_TO_HTTP=0x8000<br>
_INTERNET_FLAG_IGNORE_REDIRECT_TO_HTTPS=0x4000<br>
_INTERNET_FLAG_KEEP_CONNECTION=0x400000<br>
_INTERNET_FLAG_MAKE_PERSISTENT=0x2000000<br>
_INTERNET_FLAG_MUST_CACHE_REQUEST=0x10<br>
_INTERNET_FLAG_NEED_FILE=0x10<br>
_INTERNET_FLAG_NO_AUTH=0x40000<br>
_INTERNET_FLAG_NO_AUTO_REDIRECT=0x200000<br>
_INTERNET_FLAG_NO_CACHE_WRITE=0x4000000<br>
_INTERNET_FLAG_NO_COOKIES=0x80000<br>
_INTERNET_FLAG_NO_UI=0x200<br>
_INTERNET_FLAG_OFFLINE=0x1000000<br>
_INTERNET_FLAG_PASSIVE=0x8000000<br>
_INTERNET_FLAG_PRAGMA_NOCACHE=0x100<br>
_INTERNET_FLAG_RAW_DATA=0x40000000<br>
_INTERNET_FLAG_READ_PREFETCH=0x100000<br>
_INTERNET_FLAG_RELOAD=0x80000000<br>
_INTERNET_FLAG_RESTRICTED_ZONE=0x20000<br>
_INTERNET_FLAG_RESYNCHRONIZE=0x800<br>
_INTERNET_FLAG_SECURE=0x800000  </p>

<p><a href="https://www.aardio.com/zh-cn/doc/library-reference/inet/http.md">Markdown 格式</a></p>

</body> 
</html>