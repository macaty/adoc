
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言文档 - inet 库模块帮助文档'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言文档 - inet 库模块帮助文档</title> 
<link rel="stylesheet" href="../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>inet 库模块帮助文档</h1>

<p><a id="inet"></a></p>

<h2>inet 成员列表</h2>

<p><a id="inet.clearCache"></a></p>

<h3>inet.clearCache(可选输入查找模式串)</h3>

<p>清除指定缓存</p>

<p><a id="inet.clearCookie"></a></p>

<h3>inet.clearCookie(可选输入查找模式串)</h3>

<p>清除指定Cookies</p>

<p><a id="inet.clearSesseion"></a></p>

<h3>inet.clearSesseion()</h3>

<p>重置会话</p>

<p><a id="inet.clearVisited"></a></p>

<h3>inet.clearVisited(可选输入查找模式串)</h3>

<p>清除指定历史记录</p>

<p><a id="inet.deleteCache"></a></p>

<h3>inet.deleteCache(缓存URL)</h3>

<p>删除指定的缓存</p>

<p><a id="inet.eachCache"></a></p>

<h3>inet.eachCache</h3>

<pre><code class="aardio language-aardio">for cacheEntry in inet.eachCache(/*可选输入查找URL匹配模式串  
例如域名*/){
    //遍历所有缓存

}
</code></pre>

<p><a id="inet.eachCookie"></a></p>

<h3>inet.eachCookie</h3>

<pre><code class="aardio language-aardio">for cacheEntry in inet.eachCookie(/*可选输入查找URL匹配模式串  
例如域名*/){
    //遍历所有缓存Cookie

}
</code></pre>

<p><a id="inet.eachVisited"></a></p>

<h3>inet.eachVisited</h3>

<pre><code class="aardio language-aardio">for cacheEntry in inet.eachVisited(/*可选输入查找URL匹配模式串  
例如域名*/){
    //遍历所有缓存历史

}
</code></pre>

<p><a id="inet.getCookie"></a></p>

<h3>inet.getCookie(&quot;https&quot;)</h3>

<p>返回指定网址的 Cookie 。<br>
一般指定根域名就可以了，最好不要指定子域名。<br>
如果参数 @2 为 true 则返回包含 Cookie 名值对的表对象。<br>
参数 @2 指定一个字符串可用于匹配 Cookie 名字，不匹配则使用原 Cookie 名。<br>
注意不能获取 HttpOnly Cookie、不能获取其他进程的会话 Cookie。</p>

<p><a id="inet.getSystemProxy"></a></p>

<h3>inet.getSystemProxy()</h3>

<p>返回一个表包含当前用户系统代理配置，也即IE代理配置</p>

<p><a id="inet.lastResponse"></a></p>

<h3>inet.lastResponse()</h3>

<p>返回服务器响应信息<br>
可用于查询服务器错误信息</p>

<p><a id="inet.refreshOption"></a></p>

<h3>inet.refreshOption()</h3>

<p>刷新配置</p>

<p><a id="inet.reloadSystemProxy"></a></p>

<h3>inet.reloadSystemProxy()</h3>

<p>如果当前进程使用默认代理，则重新配置默认系统代理，<br>
当切换到全局代理后，需要调用此函数修复 proxyBypass 未即时生效的问题。</p>

<p><a id="inet.setAuth"></a></p>

<h3>inet.setAuth(&quot;用户名&quot;,&quot;密码&quot;,http.request)</h3>

<p>设置登录信息,最后一个参数不能省略<br>
成功返回true</p>

<p><a id="inet.setCookie"></a></p>

<h3>inet.setCookie</h3>

<p>设定 Cookie。<br>
web.form,web.rest,inet.http 共享此 Cookies 设置。<br>
此函数兼容 fsys.cookies 格式，<br>
兼容 CDP 方法 Network.getCookies 返回的数据格式</p>

<p><a id="inet.setCookie"></a></p>

<h3>inet.setCookie(&quot;网址&quot;,&quot;值&quot;,&quot;键&quot;,过期时间或天数)</h3>

<p>设定指定网址的 Cookie。<br>
第一个参数指定 Cookie 生效的网址。<br>
如果不指定值则删除删除指定名字的会话 cookie 与持久 Cookie，<br>
如果指定名字与值则设置 Cookie，如果不指定过期时间则仅设置会话 Cookie，<br>
否则设置为持久 Cookie。<br>
可选参数 @4 使用 time 对象指定过期时间，或用数值指定过期天数</p>

<p><a id="inet.setCookie"></a></p>

<h3>inet.setCookie(&quot;网址&quot;,&quot;键=值&quot;,过期时间或天数)</h3>

<p>设定指定网址的 Cookie。<br>
可选参数@3使用 time 对象指定过期时间，或用数值指定过期天数。<br>
如果不指定过期时间则设置会话cookie,<br>
否则修改持久化 Cookie,<br>
第一个参数指定 Cookie 生效的网址</p>

<p><a id="inet.setCookie"></a></p>

<h3>inet.setCookie(&quot;网址&quot;,表)</h3>

<p>设定指定网址的 Cookie。<br>
参数 @2 用一个表指定要设置的 Cookie 参数。<br>
可指定 name,value,expires 字段。<br>
name （Cookie 名字）与 value （Cookie 值）必须指定一个。<br>
expires 可不指定（设置会话 Cookie）。<br>
expires 如果为数值则应当是时间戳</p>

<p><a id="inet.setCookie"></a></p>

<h3>inet.setCookie(webview)</h3>

<p>传入 web.view 可直接获取浏览器控件的 Cookies<br>
作为 inet.setCookie 的参数，设置为 inet.http 可用的 Cookies 。<br>
web.form,web.rest,inet.http 共享此 Cookies 设置</p>

<p><a id="inet.setCookie"></a></p>

<h3>inet.setCookie(数组)</h3>

<p>设定数组参数指定的多个 Cookie。<br>
数组中的每个 Cookie 都必须是一个表。<br>
表中 domain 指定域名, path 指定网站目录（可省略）。<br>
name 字段（Cookie 名字）与 value 字段（Cookie 值）必须指定一个。<br>
expires 字段可不指定（设置会话 Cookie）。<br>
expires 字段如果为数值则应当是时间戳  </p>

<p>如果参数 @1 为 null 则返回 false ，不会报错。<br>
如果参数 @1 为表参数则返回 true</p>

<p><a id="inet.setProxy"></a></p>

<h3>inet.setProxy</h3>

<p>修改同一进程内的默认代理设置<br>
对同一进程内的web.form,inet.http有效<br>
设置系统代理请使用 inet.conn.setProxy 函数</p>

<p><a id="inet.setProxy"></a></p>

<h3>inet.setProxy(&quot;IE&quot;)</h3>

<p>修改进程内默认代理设置为使用IE代理设置<br>
此参数为默认值,可省略</p>

<p><a id="inet.setProxy"></a></p>

<h3>inet.setProxy(&quot;代理服务器地址:端口&quot;,&quot;绕过代理地址&quot;)</h3>

<p>设置所有协议走 HTTP 代理服务器，  </p>

<p>└── 指定 SOCKS 代理格式：&quot;socks=代理服务器地址:端口&quot;<br>
└──  <a href="../../library-guide/std/inet/proxy.html" tppabs="https://www.aardio.com/zh-cn/doc/library-guide/std/inet/proxy.html">代理格式说明</a><br>
绕过代理地址已自动设置，建议省略保持默认即可。</p>

<p><a id="inet.setProxy"></a></p>

<h3>inet.setProxy(false)</h3>

<p>修改进程内默认代理设置为不使用代理</p>

<p><a id="inet.setProxyAuth"></a></p>

<h3>inet.setProxyAuth(&quot;用户名&quot;,&quot;密码&quot;)</h3>

<p>设置inet.http默认代理登录信息<br>
该设置在进程内有效</p>

<p><a id="inetcacheentryObject"></a></p>

<h2>inetcacheentryObject 成员列表</h2>

<p><a id="inetcacheentryObject.cacheEntryType"></a></p>

<h3>inetcacheentryObject.cacheEntryType</h3>

<p>缓存入口类型</p>

<p><a id="inetcacheentryObject.expireTime"></a></p>

<h3>inetcacheentryObject.expireTime</h3>

<p>入口到期时间</p>

<p><a id="inetcacheentryObject.fileExtension"></a></p>

<h3>inetcacheentryObject.fileExtension</h3>

<p>文件扩展(相当于将信息文件备份)</p>

<p><a id="inetcacheentryObject.fileName"></a></p>

<h3>inetcacheentryObject.fileName</h3>

<p>缓存的本地文件名<br>
使用string.load()函数可以读取缓存内容</p>

<p><a id="inetcacheentryObject.headerInfo"></a></p>

<h3>inetcacheentryObject.headerInfo</h3>

<p>Internet缓存信息头的地址</p>

<p><a id="inetcacheentryObject.headerInfoSize"></a></p>

<h3>inetcacheentryObject.headerInfoSize</h3>

<p>Internet缓存信息头的信息大小</p>

<p><a id="inetcacheentryObject.lastAccessTime"></a></p>

<h3>inetcacheentryObject.lastAccessTime</h3>

<p>最后一次访问的时间</p>

<p><a id="inetcacheentryObject.lastModifiedTime"></a></p>

<h3>inetcacheentryObject.lastModifiedTime</h3>

<p>最后一次修改的时间</p>

<p><a id="inetcacheentryObject.lastSyncTime"></a></p>

<h3>inetcacheentryObject.lastSyncTime</h3>

<p>最后一次与服务器同步的时间</p>

<p><a id="inetcacheentryObject.reserved.exemptDelta"></a></p>

<h3>inetcacheentryObject.reserved.exemptDelta</h3>

<p>豁免时间,跟最后访问时间有关</p>

<p><a id="inetcacheentryObject.sizeHigh"></a></p>

<h3>inetcacheentryObject.sizeHigh</h3>

<p>文件大小的高位</p>

<p><a id="inetcacheentryObject.sizeLow"></a></p>

<h3>inetcacheentryObject.sizeLow</h3>

<p>文件大小的低位</p>

<p><a id="inetcacheentryObject.url"></a></p>

<h3>inetcacheentryObject.url</h3>

<p>URL地址名<br>
如果是Cookie文件,<br>
则可使用inet.getCookie()读取Cookie内容.</p>

<p><a id="inetcacheentryObject.useCount"></a></p>

<h3>inetcacheentryObject.useCount</h3>

<p>当前用户使用缓存的次数</p>

<h3>全局常量</h3>

<p><a id="::InternetCloseHandle"></a></p>

<h3>::InternetCloseHandle</h3>

<pre><code class="aardio language-aardio">::Wininet.api(&quot;InternetCloseHandle&quot;,&quot;bool(POINTER hInet)&quot;)
```

&lt;a id=&quot;::InternetConnect&quot;&gt;&lt;/a&gt;
### ::InternetConnect 
 ```aardio
::Wininet.api(&quot;InternetConnect&quot;,&quot;pointer(POINTER hInet,ustring serverName,INT serverPort,ustring userName,ustring password,INT service,INT flags,INT context)&quot;)
```

&lt;a id=&quot;::InternetOpen&quot;&gt;&lt;/a&gt;
### ::InternetOpen 
 ```aardio
::Wininet.api(&quot;InternetOpen&quot;,&quot;pointer(ustring agent,INT accessType,ustring proxy,ustring proxyBypass,INT flags)&quot; )
```

&lt;a id=&quot;::InternetQueryOption&quot;&gt;&lt;/a&gt;
### ::InternetQueryOption 
 ```aardio
::Wininet.api(&quot;InternetQueryOptionW&quot;,&quot;bool(pointer hInet,INT option,struct &amp;buffer,INT &amp;length)&quot;)
```

&lt;a id=&quot;::InternetSetOption&quot;&gt;&lt;/a&gt;
### ::InternetSetOption 
 ```aardio
::Wininet.api(&quot;InternetSetOptionW&quot;,&quot;bool(pointer hInet,INT opt,struct buffer,INT len)&quot;)
```

&lt;a id=&quot;::InternetSetOptionPtr&quot;&gt;&lt;/a&gt;
### ::InternetSetOptionPtr 
 ```aardio
::Wininet.api(&quot;InternetSetOptionW&quot;,&quot;bool(pointer hInet,INT opt,pointer buffer,INT len)&quot;)
```


### 自动完成常量
_COOKIE_CACHE_ENTRY=0x100000  
_EDITED_CACHE_ENTRY=0x8  
_HTTP_QUERY_ACCEPT=0x18  
_HTTP_QUERY_CONTENT_LENGTH=0x5  
_HTTP_QUERY_CONTENT_TYPE=0x1  
_HTTP_QUERY_EXPIRES=0xA  
_HTTP_QUERY_FLAG_NUMBER=0x20000000  
_HTTP_QUERY_FLAG_REQUEST_HEADERS=0x80000000  
_HTTP_QUERY_FLAG_SYSTEMTIME=0x40000000  
_HTTP_QUERY_FORWARDED=0x1E  
_HTTP_QUERY_LAST_MODIFIED=0xB  
_HTTP_QUERY_PRAGMA=0x11  
_HTTP_QUERY_RAW_HEADERS=0x15  
_HTTP_QUERY_RAW_HEADERS_CRLF=0x16  
_HTTP_QUERY_REQUEST_METHOD=0x2D  
_HTTP_QUERY_SET_COOKIE=0x2B  
_HTTP_QUERY_STATUS_CODE=0x13  
_HTTP_QUERY_STATUS_TEXT=0x14  
_HTTP_QUERY_VERSION=0x12  
_HTTP_QUERY_WARNING=0x43  
_HTTP_STATUS_DENIED=0x191  
_HTTP_STATUS_PROXY_AUTH_REQ=0x197  
_INTERNET_DEFAULT_FTP_PORT=0x15  
_INTERNET_DEFAULT_GOPHER_PORT=0x46  
_INTERNET_DEFAULT_HTTPS_PORT=0x1BB  
_INTERNET_DEFAULT_HTTP_PORT=0x50  
_INTERNET_DEFAULT_SOCKS_PORT=0x438  
_INTERNET_ERROR_BASE=0x2EE0  
_INTERNET_FLAG_CACHE_IF_NET_FAIL=0x10000  
_INTERNET_FLAG_DONT_CACHE=0x4000000  
_INTERNET_FLAG_HYPERLINK=0x400  
_INTERNET_FLAG_KEEP_CONNECTION=0x0  
_INTERNET_FLAG_KEEP_CONNECTIONN=0x400000  
_INTERNET_FLAG_RELOAD=0x80000000  
_INTERNET_FLAG_SECURE=0x800000  
_INTERNET_INVALID_PORT_NUMBER=0x0  
_INTERNET_OPEN_TYPE_DIRECT=0x1  
_INTERNET_OPEN_TYPE_PRECONFIG=0x0  
_INTERNET_OPEN_TYPE_PRECONFIG_WITH_NO_AUTOPROXY=0x4  
_INTERNET_OPEN_TYPE_PROXY=0x3  
_INTERNET_OPTION_ACTIVATE_WORKER_THREADS=0x5C  
_INTERNET_OPTION_ALTER_IDENTITY=0x50  
_INTERNET_OPTION_ASYNC=0x1E  
_INTERNET_OPTION_ASYNC_ID=0xF  
_INTERNET_OPTION_ASYNC_PRIORITY=0x10  
_INTERNET_OPTION_AUTH_FLAGS=0x55  
_INTERNET_OPTION_AUTODIAL_CONNECTION=0x53  
_INTERNET_OPTION_AUTODIAL_MODE=0x52  
_INTERNET_OPTION_BYPASS_EDITED_ENTRY=0x40  
_INTERNET_OPTION_CACHE_STREAM_HANDLE=0x1B  
_INTERNET_OPTION_CACHE_TIMESTAMPS=0x45  
_INTERNET_OPTION_CALLBACK=1  
_INTERNET_OPTION_CALLBACK_FILTER=0x36  
_INTERNET_OPTION_CLIENT_CERT_CONTEXT=0x54  
_INTERNET_OPTION_CODEPAGE=0x44  
_INTERNET_OPTION_CODEPAGE_EXTRA=0x65  
_INTERNET_OPTION_CODEPAGE_PATH=0x64  
_INTERNET_OPTION_CONNECTED_STATE=0x32  
_INTERNET_OPTION_CONNECT_BACKOFF=4  
_INTERNET_OPTION_CONNECT_LIMIT=0x2E  
_INTERNET_OPTION_CONNECT_RETRIES=3  
_INTERNET_OPTION_CONNECT_TIME=0x37  
_INTERNET_OPTION_CONNECT_TIMEOUT=2  
_INTERNET_OPTION_CONTEXT_VALUE=0x2D  
_INTERNET_OPTION_CONTROL_RECEIVE_TIMEOUT=6  
_INTERNET_OPTION_CONTROL_SEND_TIMEOUT=5  
_INTERNET_OPTION_COOKIES_3RD_PARTY=0x56  
_INTERNET_OPTION_DATAFILE_EXT=0x60  
_INTERNET_OPTION_DATAFILE_NAME=0x21  
_INTERNET_OPTION_DATA_RECEIVE_TIMEOUT=8  
_INTERNET_OPTION_DATA_SEND_TIMEOUT=7  
_INTERNET_OPTION_DIAGNOSTIC_SOCKET_INFO=0x43  
_INTERNET_OPTION_DIGEST_AUTH_UNLOAD=0x4C  
_INTERNET_OPTION_DISABLE_AUTODIAL=0x46  
_INTERNET_OPTION_DISABLE_PASSPORT_AUTH=0x57  
_INTERNET_OPTION_DISCONNECTED_TIMEOUT=0x31  
_INTERNET_OPTION_ENABLE_PASSPORT_AUTH=0x5A  
_INTERNET_OPTION_END_BROWSER_SESSION=0x2A  
_INTERNET_OPTION_ERROR_MASK=0x3E  
_INTERNET_OPTION_EXEMPT_CONNECTION_LIMIT=0x59  
_INTERNET_OPTION_EXTENDED_ERROR=0x18  
_INTERNET_OPTION_FROM_CACHE_TIMEOUT=0x3F  
_INTERNET_OPTION_HANDLE_TYPE=9  
_INTERNET_OPTION_HIBERNATE_INACTIVE_WORKER_THREADS=0x5B  
_INTERNET_OPTION_HTTP_DECODING=0x41  
_INTERNET_OPTION_HTTP_VERSION=0x3B  
_INTERNET_OPTION_IDENTITY=0x4E  
_INTERNET_OPTION_IDLE_STATE=0x33  
_INTERNET_OPTION_IDN=0x66  
_INTERNET_OPTION_IGNORE_OFFLINE=0x4D  
_INTERNET_OPTION_KEEP_CONNECTION=0x16  
_INTERNET_OPTION_LISTEN_TIMEOUT=0xB  
_INTERNET_OPTION_MAX_CONNS_PER_1_0_SERVER=0x4A  
_INTERNET_OPTION_MAX_CONNS_PER_PROXY=0x67  
_INTERNET_OPTION_MAX_CONNS_PER_SERVER=0x49  
_INTERNET_OPTION_OFFLINE_MODE=0x1A  
_INTERNET_OPTION_OFFLINE_SEMANTICS=0x34  
_INTERNET_OPTION_PARENT_HANDLE=0x15  
_INTERNET_OPTION_PASSWORD=0x1D  
_INTERNET_OPTION_PER_CONNECTION_OPTION=0x4B  
_INTERNET_OPTION_POLICY=0x30  
_INTERNET_OPTION_PROXY=0x26  
_INTERNET_OPTION_PROXY_PASSWORD=0x2C  
_INTERNET_OPTION_PROXY_SETTINGS_CHANGED=0x5F  
_INTERNET_OPTION_PROXY_USERNAME=0x2B  
_INTERNET_OPTION_READ_BUFFER_SIZE=0xC  
_INTERNET_OPTION_RECEIVE_THROUGHPUT=0x39  
_INTERNET_OPTION_RECEIVE_TIMEOUT=6  
_INTERNET_OPTION_REFRESH=0x25  
_INTERNET_OPTION_REMOVE_IDENTITY=0x4F  
_INTERNET_OPTION_REQUEST_FLAGS=0x17  
_INTERNET_OPTION_REQUEST_PRIORITY=0x3A  
_INTERNET_OPTION_RESET_URLCACHE_SESSION=0x3C  
_INTERNET_OPTION_RESTORE_WORKER_THREAD_DEFAULTS=0x5D  
_INTERNET_OPTION_SECONDARY_CACHE_KEY=0x35  
_INTERNET_OPTION_SECURITY_CERTIFICATE=0x23  
_INTERNET_OPTION_SECURITY_CERTIFICATE_STRUCT=0x20  
_INTERNET_OPTION_SECURITY_FLAGS=0x1F  
_INTERNET_OPTION_SECURITY_KEY_BITNESS=0x24  
_INTERNET_OPTION_SECURITY_SELECT_CLIENT_CERT=0x2F  
_INTERNET_OPTION_SEND_THROUGHPUT=0x38  
_INTERNET_OPTION_SEND_TIMEOUT=5  
_INTERNET_OPTION_SEND_UTF8_SERVERNAME_TO_PROXY=0x58  
_INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT=0x69  
_INTERNET_OPTION_SETTINGS_CHANGED=0x27  
_INTERNET_OPTION_SOCKET_SEND_BUFFER_LENGTH=0x5E  
_INTERNET_OPTION_SUPPRESS_BEHAVIOR=0x51  
_INTERNET_OPTION_SUPPRESS_SERVER_AUTH=0x68  
_INTERNET_OPTION_URL=0x22  
_INTERNET_OPTION_USERNAME=0x1C  
_INTERNET_OPTION_USER_AGENT=0x29  
_INTERNET_OPTION_VERSION=0x28  
_INTERNET_OPTION_WRITE_BUFFER_SIZE=0xD  
_INTERNET_PER_CONN_FLAGS=0x1  
_INTERNET_PER_CONN_PROXY_BYPASS=0x3  
_INTERNET_PER_CONN_PROXY_SERVER=0x2  
_INTERNET_SERVICE_FTP=0x1  
_INTERNET_SERVICE_GOPHER=0x2  
_INTERNET_SERVICE_HTTP=0x3  
_INTERNET_SUPPRESS_RESET_ALL=0x0  
_MAX_CACHE_ENTRY_INFO_SIZE=4096  
_NORMAL_CACHE_ENTRY=0x1  
_PROXY_TYPE_DIRECT=0x1  
_PROXY_TYPE_PROXY=0x2  
_SPARSE_CACHE_ENTRY=0x10000  
_STICKY_CACHE_ENTRY=0x4  
_TRACK_OFFLINE_CACHE_ENTRY=0x10  
_TRACK_ONLINE_CACHE_ENTRY=0x20  
_URLCACHE_FIND_DEFAULT_FILTER=0x300035  
_URLHISTORY_CACHE_ENTRY=0x200000  


[Markdown 格式](_.md)
</code></pre>

</body> 
</html>