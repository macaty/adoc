[aardio æ–‡æ¡£](../../index.htm "aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ")

# service åº“æ¨¡å—å¸®åŠ©æ–‡æ¡?
## service æˆå‘˜åˆ—è¡¨

NTæœåŠ¡æ“ä½œ

éƒ¨åˆ†æ“ä½œéœ€è¦ç®¡ç†æƒé™?
### service.activeSessionIdï¼?

è¿”å›æ“ä½œç³»ç»Ÿæ´»åŠ¨ç”¨æˆ·ä¼šè¯ID,

æ›´å¤šä¼šè¯æ§åˆ¶è¯·å‚è€ƒæ ‡å‡†åº“ win.ts

### service.create(å¯åŠ¨è·¯å¾„,æœåŠ¡å?æ˜¾ç¤ºå…¨å,æœåŠ¡æè¿°)

åˆ›å»ºæœåŠ¡,

å‚æ•°@1å¯ä¸ºç©?é»˜è®¤ä½¿ç”¨å½“å‰åº”ç”¨ç¨‹åºè·¯å¾„,

å…¶ä»–å¯é€‰å‚æ•°æœªåˆ—å‡ºè¯·æŸ¥çœ‹å‡½æ•°æºç ?
### service.delete("æœåŠ¡å?)

åˆ é™¤æœåŠ¡

æ³¨æ„åˆ é™¤æœåŠ¡å‰æœ€å¥½å…³é—­æœåŠ¡ç®¡ç†å™¨

### service.each()

[è¿”å›å¯¹è±¡:ntsrvsta2Object](#ntsrvsta2Object)

### service.each(serviceType,serviceState,groupName)

```aardio aardio
for( serviceName,displayName,svrStatusProcess in service.each()){
    io.print(serviceName, displayName,svrStatusProcess.state)
}

```

### service.eachSessionï¼ˆï¼‰

```aardio aardio
for id,station,state in service.eachSession(){
    if( state == 0 ) return id;/*éå†æ“ä½œç³»ç»Ÿæ‰€æœ‰ç™»å½•ç”¨æˆ·ä¼šè¯ï¼Œ
idä¸ºä¼šè¯IDï¼Œstationä¸ºä¼šè¯å,stateä¸ºä¼šè¯çŠ¶æ€?stateä¸?ä¸ºç™»å½•æ¿€æ´»çŠ¶æ€?1ä¸ºå·²è¿æ¥,4ä¸ºæ–­å¼€çŠ¶æ€?/
}

```

### service.isExist("æœåŠ¡å?)

æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„æœåŠ?
### service.isRunning("æœåŠ¡å?)

æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œ

### service.isStopped("æœåŠ¡å?)

æœåŠ¡æ˜¯å¦å·²åœæ­?
### service.manager()

[è¿”å›å¯¹è±¡:ntsrvmgrObject](#ntsrvmgrObject)

### service.manager(desiredAccess,machineName,databaseName)

åˆ›å»ºç®¡ç†å™?
### service.msgbox("æ–‡æœ¬","æ ‡é¢˜",ç­‰å¾…è¶…æ—¶å€?æ ·å¼)

å¼¹å‡ºå¯¹è¯æ¡?
è¿”å›ç”¨æˆ·æ“ä½œID,å¦‚æœä¸æŒ‡å®šè¶…æ—¶å€¼è¿”å›IDASYNC 32001

è¶…æ—¶å€¼ä»¥æ¯«ç§’ä¸ºå•ä½?è¶…æ—¶ä¸?è¡¨ç¤ºä¸€ç›´ç­‰å¾?ä¸æŒ‡å®šè¶…æ—¶åˆ™ä¸ç­‰å¾…ç”¨æˆ·æ“ä½?

é™¤å‚æ•°ä¸€ä»¥å¤–,å…¶ä»–æ‰€æœ‰å‚æ•°å¯é€?
å¦‚æœå‚æ•°@1æ˜¯è¡¨å¯¹è±¡,è‡ªåŠ¨è°ƒç”¨table.tostringåºåˆ—åŒ–ä¸ºæ–‡æœ¬

å…¶ä»–ç±»å‹è°ƒç”¨tostringè½¬ä¸ºå­—ç¬¦ä¸?
### service.msgboxErr("æ–‡æœ¬","æ ‡é¢˜")

å¼¹å‡ºé”™è¯¯å¯¹è¯æ¡?
æ‰€æœ‰è€…çª—å£å‚æ•°å¯é€?
å¦‚æœå‚æ•°@1æ˜¯è¡¨å¯¹è±¡,è‡ªåŠ¨è°ƒç”¨table.tostringåºåˆ—åŒ–ä¸ºæ–‡æœ¬

å…¶ä»–ç±»å‹è°ƒç”¨tostringè½¬ä¸ºå­—ç¬¦ä¸?
### service.msgboxTest("æ–‡æœ¬","æ ‡é¢˜")

è¿”å›å¸ƒå°”å€¼è¡¨ç¤ºç”¨æˆ·æ˜¯å¦æŒ‰äº†â€œç¡®å®šâ€æŒ‰é’®ã€?
æ ‡é¢˜,æ‰€æœ‰è€…çª—å£å‚æ•°å¯é€?
### service.pause("æœåŠ¡å?)

æš‚åœæœåŠ¡,

æˆåŠŸè¿”å›true,

å¤±è´¥è¯·ä½¿ç”¨lasterrå‡½æ•°è·å–é”™è¯¯ä¿¡æ¯

### service.registerCtrlThread()

[è¿”å›å¯¹è±¡:ntsrvsta2Object](#ntsrvsta2Object)

### service.registerCtrlThread(serviceName,handle)

```aardio aardio
service.registerCtrlThread( serviceName,function(control,eventType,pEventData){

    }
)

```

### service.restart("æœåŠ¡å?,åœæ­¢è¶…æ—¶,å¯åŠ¨è¶…æ—¶)

é‡æ–°å¯åŠ¨æœåŠ¡,æˆåŠŸè¿”å›true,

è¶…æ—¶ä»¥ç§’ä¸ºå•ä½ï¼Œçœç•¥åˆ™ä¸é™æ—¶é—´ç­‰å¾…æ“ä½œå®Œæˆ?
åœæ­¢è¶…æ—¶è¾¾åˆ°æ—¶é—´åæœåŠ¡æœªæ­£å¸¸åœæ­¢åˆ™å¼ºåˆ¶ä¸­æ–­æœåŠ¡è¿›ç¨?
### service.resume("æœåŠ¡å?)

æš‚åœçŠ¶æ€æ¢å¤è¿è¡?

æˆåŠŸè¿”å›true,

å¤±è´¥è¯·ä½¿ç”¨lasterrå‡½æ•°è·å–é”™è¯¯ä¿¡æ¯

### service.serviceName

å½“å‰æœåŠ¡çº¿ç¨‹ä¸­è¿è¡Œçš„NTæœåŠ¡åï¼Œ

ä¸»çº¿ç¨‹åº”è‡ªè¡ŒæŒ‡å®š

### service.sessions()

è¿”å›æ“ä½œç³»ç»Ÿæ‰€æœ‰ç™»å½•ç”¨æˆ·ä¼šè¯?

æ›´å¤šä¼šè¯æ§åˆ¶è¯·å‚è€ƒæ ‡å‡†åº“ win.ts

### service.start("æœåŠ¡å?)

å¯åŠ¨æœåŠ¡,

æˆåŠŸè¿”å›true,

å¤±è´¥è¯·ä½¿ç”¨lasterrå‡½æ•°è·å–é”™è¯¯ä¿¡æ¯

### service.startDispatchThread(æœåŠ¡å›è°ƒå‡½æ•°è¡?

```aardio aardio
service.service.startDispatchThread(
    æœåŠ¡å?= function(serviceName,argv){
        import service;
        var srvStatus = service.registerCtrlThread(serviceName,function(control,eventType,pEventData){
            import service;
            if( control == 0x1/*_SERVICE_CONTROL_STOP*/ ){
                service.updateStatus({currentState = 0x1/*_SERVICE_STOPPED*/},owner.serviceName);
            }
        } )

        srvStatus.controlsAccepted = 0x1/*_SERVICE_ACCEPT_STOP*/
        srvStatus.currentState = 0x4/*_SERVICE_RUNNING*/;
        service.updateStatus(srvStatus,serviceName)

        /*æœåŠ¡è¿è¡Œä»£ç */

        srvStatus.controlsAccepted = 0;
        srvStatus.currentState = 0x1/*_SERVICE_STOPPED*/
        service.updateStatus(srvStatus,serviceName)
    }
)

```

### service.stop("æœåŠ¡å?)

åœæ­¢æœåŠ¡,

æˆåŠŸè¿”å›true,

å¤±è´¥è¯·ä½¿ç”¨lasterrå‡½æ•°è·å–é”™è¯¯ä¿¡æ¯

### service.stop("æœåŠ¡å?,true)

åœæ­¢æœåŠ¡,å¦‚æœå¤±è´¥å°±å¼ºåˆ¶ä¸­æ–­æœåŠ¡è¿›ç¨?

æˆåŠŸè¿”å›true,

å¤±è´¥è¯·ä½¿ç”¨lasterrå‡½æ•°è·å–é”™è¯¯ä¿¡æ¯

### service.terminate("æœåŠ¡å?)

å¼ºåˆ¶ä¸­æ–­æœåŠ¡è¿›ç¨‹,

æˆåŠŸè¿”å›true,

### service.updateStatus(æœåŠ¡çŠ¶æ€è¡¨,æœåŠ¡å?

å‚æ•°@1åº”æ˜¯registerCtrlHandlerå‡½æ•°çš„è¿”å›å€?

åœ¨CtrlHandlerå‡½æ•°ä¸­æŒ‡å®šéƒ¨åˆ†éœ€è¦æ›´æ–°çš„å€¼å³å?
## ntsrvconfigObject æˆå‘˜åˆ—è¡¨

### ntsrvconfigObject.binaryPathName

```aardio aardio
binaryPathName

```

### ntsrvconfigObject.dependencies

```aardio aardio
dependencies

```

### ntsrvconfigObject.displayName

```aardio aardio
displayName

```

### ntsrvconfigObject.errorControl

```aardio aardio
errorControl

```

### ntsrvconfigObject.loadOrderGroup

```aardio aardio
loadOrderGroup

```

### ntsrvconfigObject.serviceStartName

```aardio aardio
serviceStartName

```

### ntsrvconfigObject.serviceType

```aardio aardio
serviceType

```

### ntsrvconfigObject.startType

```aardio aardio
startType

```

### ntsrvconfigObject.tagId

```aardio aardio
tagId

```

## ntsrvmgrObject æˆå‘˜åˆ—è¡¨

### ntsrvmgrObject.changeConfig(serviceName,serviceType,startType)

ä¿®æ”¹é…ç½®,å…¶ä»–å¯é€‰å‚æ•°æœªåˆ—å‡ºè¯·æŸ¥çœ‹å‡½æ•°æºç ?
### ntsrvmgrObject.changeConfig2("æœåŠ¡å?,é…ç½®é¡?é…ç½®å€?

ä¿®æ”¹é…ç½®

é…ç½®å€¼å¿…é¡»æ˜¯ç»“æ„ä½?
### ntsrvmgrObject.changeDescription("æœåŠ¡å?,"è¯´æ˜")

ä¿®æ”¹æœåŠ¡è¯´æ˜

### ntsrvmgrObject.close()

å…³é—­

### ntsrvmgrObject.control(serviceName,desiredAccess,control)

æ§åˆ¶æœåŠ¡

### ntsrvmgrObject.create(å¯åŠ¨è·¯å¾„,æœåŠ¡å?æ˜¾ç¤ºå…¨å)

åˆ›å»ºæœåŠ¡,å…¶ä»–å¯é€‰å‚æ•°æœªåˆ—å‡ºè¯·æŸ¥çœ‹å‡½æ•°æºç ?
### ntsrvmgrObject.delete("æœåŠ¡å?)

åˆ é™¤æœåŠ¡

æ³¨æ„åˆ é™¤æœåŠ¡å‰æœ€å¥½å…³é—­æœåŠ¡ç®¡ç†å™¨

### ntsrvmgrObject.eachDependent("æœåŠ¡å?)

```aardio aardio
for(serviceName,displayName,serviceStatus in ntsrvmgrObject.eachDependent("/*æŒ‡å®šæœåŠ¡ååˆ—å‡ºä¾èµ–æ­¤æœåŠ¡çš„æœåŠ?/") ){

}

```

### ntsrvmgrObject.eachDependent()

[è¿”å›å¯¹è±¡:ntsrvsta2Object](#ntsrvsta2Object)

### ntsrvmgrObject.isExist("æœåŠ¡å?)

æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„æœåŠ?
### ntsrvmgrObject.isRunning("æœåŠ¡å?)

æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œ

### ntsrvmgrObject.isStopped("æœåŠ¡å?)

æœåŠ¡æ˜¯å¦å·²åœæ­?
### ntsrvmgrObject.open(serviceName,desiredAccess)

æ‰“å¼€æœåŠ¡å¥æŸ„

### ntsrvmgrObject.pause("æœåŠ¡å?)

æš‚åœæœåŠ¡,

æˆåŠŸè¿”å›true,

å¤±è´¥è¯·ä½¿ç”¨lasterrå‡½æ•°è·å–é”™è¯¯ä¿¡æ¯

### ntsrvmgrObject.queryBinaryPathName("æœåŠ¡å?)

è¿”å›å¯åŠ¨è·¯å¾„ä»¥åŠå‚æ•°

### ntsrvmgrObject.queryConfig("æœåŠ¡å?)

è¿”å›é…ç½®

### ntsrvmgrObject.queryConfig()

[è¿”å›å¯¹è±¡:ntsrvconfigObject](#ntsrvconfigObject)

### ntsrvmgrObject.queryConfig2("æœåŠ¡å?,é…ç½®é¡?é…ç½®å€?

è·å–é…ç½®

é…ç½®å€¼å¿…é¡»æ˜¯ç»“æ„ä½?
### ntsrvmgrObject.queryDescription("æœåŠ¡å?)

è¿”å›æœåŠ¡è¯´æ˜

### ntsrvmgrObject.queryStatus("æœåŠ¡å?)

æˆåŠŸè¿”å›ä¸€ä¸ªè¡¨ç¤ºæœåŠ¡çŠ¶æ€çš„è¡¨å¯¹è±?
### ntsrvmgrObject.queryStatus()

[è¿”å›å¯¹è±¡:ntsrvsta2Object](#ntsrvsta2Object)

### ntsrvmgrObject.resume("æœåŠ¡å?)

æš‚åœçŠ¶æ€æ¢å¤è¿è¡?

æˆåŠŸè¿”å›true,

å¤±è´¥è¯·ä½¿ç”¨lasterrå‡½æ•°è·å–é”™è¯¯ä¿¡æ¯

### ntsrvmgrObject.start("æœåŠ¡å?)

å¯åŠ¨æœåŠ¡,

æˆåŠŸè¿”å›true,

å¤±è´¥è¯·ä½¿ç”¨lasterrå‡½æ•°è·å–é”™è¯¯ä¿¡æ¯

### ntsrvmgrObject.startAndWait("æœåŠ¡å?,è¿›ç¨‹æƒé™)

å¯åŠ¨æœåŠ¡å¹¶ç­‰å¾…æœåŠ¡è¿›ç¨‹åˆ‡æ¢åˆ°è¿è¡ŒçŠ¶æ€?

è¿”å›æ‰“å¼€çš„è¿›ç¨‹å¯¹è±¡ï¼ˆprocess å¯¹è±¡ï¼?å¯é€‰ç”¨å‚æ•°@2æŒ‡å®šè¿›ç¨‹è®¿é—®æƒé™

### ntsrvmgrObject.startAndWait()

[è¿”å›å¯¹è±¡:processObject](javascript:if(confirm('https://www.aardio.com/zh-cn/doc/library-reference/process/_.html  \n\nï¿½ï¿½ï¿½Ä¼ï¿½ï¿½Ş·ï¿½ï¿½ï¿½ Teleport Ultra ï¿½ï¿½ï¿½ï¿½, ï¿½ï¿½Îª ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Êµï¿½ï¿½Ä¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ØµÄ¡ï¿½  \n\nï¿½ï¿½ï¿½ï¿½ï¿½Ú·ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ï´ï¿½ï¿½ï¿½ï¿½ï¿½?'))window.location='https://www.aardio.com/zh-cn/doc/library-reference/process/_.html#processObject')

### ntsrvmgrObject.startAutomatic("æœåŠ¡å?)

è®¾ç½®ä¸ºè‡ªåŠ¨å¯åŠ?
### ntsrvmgrObject.startDelayed("æœåŠ¡å?,æ˜¯å¦å»¶æ—¶)

è®¾ç½®ä¸ºå»¶æ—¶å¯åŠ?
### ntsrvmgrObject.startDisabled("æœåŠ¡å?)

è®¾ç½®ä¸ºç¦ç”?
### ntsrvmgrObject.startManual("æœåŠ¡å?)

è®¾ç½®ä¸ºæ‰‹åŠ¨å¯åŠ?
### ntsrvmgrObject.stop("æœåŠ¡å?)

åœæ­¢æœåŠ¡,

æˆåŠŸè¿”å›true,

å¤±è´¥è¯·ä½¿ç”¨lasterrå‡½æ•°è·å–é”™è¯¯ä¿¡æ¯

### ntsrvmgrObject.stop("æœåŠ¡å?,true)

åœæ­¢æœåŠ¡,å¦‚æœå¤±è´¥å°±å¼ºåˆ¶ä¸­æ–­æœåŠ¡è¿›ç¨?

æˆåŠŸè¿”å›true,

å¤±è´¥è¯·ä½¿ç”¨lasterrå‡½æ•°è·å–é”™è¯¯ä¿¡æ¯

### ntsrvmgrObject.terminate("æœåŠ¡å?)

å¼ºåˆ¶ä¸­æ–­æœåŠ¡è¿›ç¨‹,

æˆåŠŸè¿”å›true,

### ntsrvmgrObject.wait("æœåŠ¡å?,çŠ¶æ€ç )

ç­‰å¾…æœåŠ¡åˆ‡æ¢åˆ°æŒ‡å®šçŠ¶æ€?
çŠ¶æ€ç ä¸æŒ‡å®šæ—¶é»˜è®¤ä¸?4/\*\_SERVICE\_RUNNING\*/

æˆåŠŸè¿”å›ä¸€ä¸ªè¡¨ç¤ºæœåŠ¡çŠ¶æ€çš„è¡¨å¯¹è±?
### ntsrvmgrObject.wait()

[è¿”å›å¯¹è±¡:ntsrvsta2Object](#ntsrvsta2Object)

## ntsrvsta2Object æˆå‘˜åˆ—è¡¨

### ntsrvsta2Object.checkPoint

```aardio aardio
checkPoint

```

### ntsrvsta2Object.controlsAccepted

```aardio aardio
controlsAccepted

```

### ntsrvsta2Object.currentState

```aardio aardio
currentState

```

### ntsrvsta2Object.processId

```aardio aardio
processId

```

### ntsrvsta2Object.serviceFlags

```aardio aardio
processId

```

### ntsrvsta2Object.serviceSpecificExitCode

```aardio aardio
serviceSpecificExitCode

```

### ntsrvsta2Object.serviceType

```aardio aardio
serviceType

```

### ntsrvsta2Object.state

```aardio aardio
state

```

### ntsrvsta2Object.waitHint

```aardio aardio
waitHint

```

### ntsrvsta2Object.win32ExitCode

```aardio aardio
win32ExitCode

```

### è‡ªåŠ¨å®Œæˆå¸¸é‡

\_SERVICE\_ACCEPT\_HARDWAREPROFILECHANGE=0x20

\_SERVICE\_ACCEPT\_NETBINDCHANGE=0x10

\_SERVICE\_ACCEPT\_PARAMCHANGE=0x8

\_SERVICE\_ACCEPT\_PAUSE\_CONTINUE=0x2

\_SERVICE\_ACCEPT\_POWEREVENT=0x40

\_SERVICE\_ACCEPT\_SESSIONCHANGE=0x80

\_SERVICE\_ACCEPT\_SHUTDOWN=0x4

\_SERVICE\_ACCEPT\_STOP=0x1

\_SERVICE\_ADAPTER=0x4

\_SERVICE\_AUTO\_START=0x2

\_SERVICE\_BOOT\_START=0x0

\_SERVICE\_CONTINUE\_PENDING=0x5

\_SERVICE\_CONTROL\_CONTINUE=0x3

\_SERVICE\_CONTROL\_HARDWAREPROFILECHANGE=0xC

\_SERVICE\_CONTROL\_NETBINDADD=0x7

\_SERVICE\_CONTROL\_NETBINDDISABLE=0xA

\_SERVICE\_CONTROL\_NETBINDENABLE=0x9

\_SERVICE\_CONTROL\_NETBINDREMOVE=0x8

\_SERVICE\_CONTROL\_PARAMCHANGE=0x6

\_SERVICE\_CONTROL\_PAUSE=0x2

\_SERVICE\_CONTROL\_POWEREVENT=0xD

\_SERVICE\_CONTROL\_SESSIONCHANGE=0xE

\_SERVICE\_CONTROL\_SHUTDOWN=0x5

\_SERVICE\_CONTROL\_STOP=0x1

\_SERVICE\_DEMAND\_START=0x3

\_SERVICE\_DISABLED=0x4

\_SERVICE\_FILE\_SYSTEM\_DRIVER=0x2

\_SERVICE\_KERNEL\_DRIVER=0x1

\_SERVICE\_PAUSED=0x7

\_SERVICE\_PAUSE\_PENDING=0x6

\_SERVICE\_RECOGNIZER\_DRIVER=0x8

\_SERVICE\_RUNNING=0x4

\_SERVICE\_RUNS\_IN\_SYSTEM\_PROCESS=0x1

\_SERVICE\_START\_PENDING=0x2

\_SERVICE\_STOPPED=0x1

\_SERVICE\_STOP\_PENDING=0x3

\_SERVICE\_SYSTEM\_START=0x1

\_SERVICE\_WIN32=0x30

\_SERVICE\_WIN32\_OWN\_PROCESS=0x10

\_SERVICE\_WIN32\_SHARE\_PROCESS=0x20

[Markdown æ ¼å¼](javascript:if(confirm('https://www.aardio.com/zh-cn/doc/library-reference/service/_.md  \n\nï¿½ï¿½ï¿½Ä¼ï¿½ï¿½Ş·ï¿½ï¿½ï¿½ Teleport Ultra ï¿½ï¿½ï¿½ï¿½, ï¿½ï¿½Îª ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ä¿ï¿½Ä¼ï¿½ï¿½ï¿½ï¿½Í¹æ·¶ï¿½Ú¡ï¿½  \n\nï¿½ï¿½ï¿½ï¿½ï¿½Ú·ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ï´ï¿½ï¿½ï¿½ï¿½ï¿½?'))window.location='https://www.aardio.com/zh-cn/doc/library-reference/service/_.md')

