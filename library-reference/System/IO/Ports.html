
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言文档 - System.IO.Ports 库模块帮助文档'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言文档 - System.IO.Ports 库模块帮助文档</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>System.IO.Ports 库模块帮助文档</h1>

<p><a id="System.IO.Ports"></a></p>

<h2>System.IO.Ports 成员列表</h2>

<p>.NET System.IO.Ports 名字空间<br>
Win7 或 .NET 2.0 开始自带此组件</p>

<p><a id="System.IO.Ports.?"></a></p>

<h3>System.IO.Ports.?</h3>

<p>.NET 名字空间、类、结构体的成员，<br>
可访问成员名字空间、类、枚举、静态属性或字段，<br>
导入的类可用于构造 .NET 对象，传回 .NET 则自动转为该类的 Type 对象  </p>

<p><a href="../../dotNet/appDomain.html#dotNetNameSpaceObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/dotNet/appDomain.html#dotNetNameSpaceObject">返回对象:dotNetNameSpaceObject</a></p>

<p><a id="System.IO.Ports.SerialPort"></a></p>

<h3>System.IO.Ports.SerialPort()</h3>

<p><a href="#systemIoSerialPortObject">返回对象:systemIoSerialPortObject</a></p>

<p><a id="System.IO.Ports.SerialPort"></a></p>

<h3>System.IO.Ports.SerialPort(portName,baudRate)</h3>

<p>打开串口。<br>
可选用 @portName 指定端口名，例如 &quot;COM1&quot;。<br>
可选用 @baudRate 参数指定波特率</p>

<p><a id="System.IO.Ports.assembly"></a></p>

<h3>System.IO.Ports.assembly</h3>

<p>导入此 .NET 名字空间的程序集对象。  </p>

<p><a href="#dotNetCrlAssemblyObject">返回对象:dotNetCrlAssemblyObject</a></p>

<p><a id="System.IO.Ports.SerialPort"></a></p>

<h2>System.IO.Ports.SerialPort 成员列表</h2>

<p>串口设备</p>

<p>打开串口</p>

<p><a id="System.IO.Ports.SerialPort.GetPortNames "></a></p>

<h3>System.IO.Ports.SerialPort.GetPortNames ()</h3>

<p>返回包含所有串口名的字符串数组</p>

<p><a id="systemIoSerialPortObject"></a></p>

<h2>systemIoSerialPortObject 成员列表</h2>

<p><a id="systemIoSerialPortObject.BaseStream"></a></p>

<h3>systemIoSerialPortObject.BaseStream</h3>

<p>获取底层 System.IO.Stream 对象。</p>

<p><a id="systemIoSerialPortObject.BaudRate"></a></p>

<h3>systemIoSerialPortObject.BaudRate</h3>

<p>获取或设置串行波特率。</p>

<p><a id="systemIoSerialPortObject.BreakState"></a></p>

<h3>systemIoSerialPortObject.BreakState</h3>

<p>获取或设置中断信号状态。</p>

<p><a id="systemIoSerialPortObject.BytesToRead"></a></p>

<h3>systemIoSerialPortObject.BytesToRead</h3>

<p>获取接收缓冲区中的数据字节数。</p>

<p><a id="systemIoSerialPortObject.BytesToWrite"></a></p>

<h3>systemIoSerialPortObject.BytesToWrite</h3>

<p>获取发送缓冲区中的数据字节数。</p>

<p><a id="systemIoSerialPortObject.CDHolding"></a></p>

<h3>systemIoSerialPortObject.CDHolding</h3>

<p>获取端口的 Carrier Detect 线路状态。</p>

<p><a id="systemIoSerialPortObject.CanRaiseEvents"></a></p>

<h3>systemIoSerialPortObject.CanRaiseEvents</h3>

<p>获取一个值，指示组件是否能够触发事件。</p>

<p><a id="systemIoSerialPortObject.Container"></a></p>

<h3>systemIoSerialPortObject.Container</h3>

<p>获取包含该组件的 IContainer。</p>

<p><a id="systemIoSerialPortObject.CtsHolding"></a></p>

<h3>systemIoSerialPortObject.CtsHolding</h3>

<p>获取 Clear-to-Send 线路的状态。</p>

<p><a id="systemIoSerialPortObject.DataBits"></a></p>

<h3>systemIoSerialPortObject.DataBits</h3>

<p>获取或设置每字节的标准数据位长度。</p>

<p><a id="systemIoSerialPortObject.DataReceived"></a></p>

<h3>systemIoSerialPortObject.DataReceived</h3>

<pre><code class="aardio language-aardio">systemIoSerialPortObject.DataReceived = function(sender,e){
    try{
        var str = sender.ReadExisting();
        /*str 为串口接收的文本数据，字符串值  
为避免收到乱码，Encoding 属性要正确设置文本编码。  
或者改用 read 函数读取二进制的字节数组。  

这个回调函数如果抛出异常，程序会退出。  
建议代码写在 try 语句中，在 catch 语句中获取错误信息。  

注意无论 .NET 是否多线程回调，    
被 .NET 回调的 aardio 函数总会在原调用线程执行，  
不需要考虑多线程规则与同步问题*/

    }
    catch(e){

    }
}
</code></pre>

<p><a id="systemIoSerialPortObject.DiscardNull"></a></p>

<h3>systemIoSerialPortObject.DiscardNull</h3>

<p>获取或设置一个值，指示在端口和接收缓冲区之间传输时是否忽略空字节。</p>

<p><a id="systemIoSerialPortObject.DsrHolding"></a></p>

<h3>systemIoSerialPortObject.DsrHolding</h3>

<p>获取数据集准备 (DSR) 信号的状态。</p>

<p><a id="systemIoSerialPortObject.DtrEnable"></a></p>

<h3>systemIoSerialPortObject.DtrEnable</h3>

<p>获取或设置一个值，在串行通信期间启用数据终端就绪 (DTR) 信号。</p>

<p><a id="systemIoSerialPortObject.Encoding"></a></p>

<h3>systemIoSerialPortObject.Encoding</h3>

<p>获取或设置读写字符串值时使用的默认文本编码。<br>
可设为 System.Text.UTF8Encoding 等编码类的实例对象。<br>
默认值为  System.Text.ASCIIEncoding 对象。  </p>

<p>读写二进制字节数组与 Encoding 无关</p>

<p><a id="systemIoSerialPortObject.ErrorReceived"></a></p>

<h3>systemIoSerialPortObject.ErrorReceived</h3>

<pre><code class="aardio language-aardio">systemIoSerialPortObject.ErrorReceived = function(sender,e){
    var eventType = e.EventType;
    /*发生错误，eventType 为 System.IO.Ports.SerialError 枚举 */
}
</code></pre>

<p><a id="systemIoSerialPortObject.Events"></a></p>

<h3>systemIoSerialPortObject.Events</h3>

<p>获取附加到此组件的事件处理程序列表。</p>

<p><a id="systemIoSerialPortObject.Handshake"></a></p>

<h3>systemIoSerialPortObject.Handshake</h3>

<p>获取或设置使用 Handshake 值的串行端口数据传输的握手协议。</p>

<p><a id="systemIoSerialPortObject.IsOpen"></a></p>

<h3>systemIoSerialPortObject.IsOpen</h3>

<p>获取一个值，指示 SerialPort 对象的打开或关闭状态。</p>

<p><a id="systemIoSerialPortObject.NewLine"></a></p>

<h3>systemIoSerialPortObject.NewLine</h3>

<p>获取或设置用于解释 ReadLine() 和 WriteLine(String) 方法结束的值。</p>

<p><a id="systemIoSerialPortObject.Open"></a></p>

<h3>systemIoSerialPortObject.Open()</h3>

<p>创建连接</p>

<p><a id="systemIoSerialPortObject.Parity"></a></p>

<h3>systemIoSerialPortObject.Parity</h3>

<p>获取或设置奇偶校验协议。</p>

<p><a id="systemIoSerialPortObject.ParityReplace"></a></p>

<h3>systemIoSerialPortObject.ParityReplace</h3>

<p>获取或设置在奇偶校验错误发生时替换数据流中的无效字节的字节。</p>

<p><a id="systemIoSerialPortObject.PortName"></a></p>

<h3>systemIoSerialPortObject.PortName</h3>

<p>获取或设置用于通信的端口，包括但不限于所有可用的 COM 端口。</p>

<p><a id="systemIoSerialPortObject.Read"></a></p>

<h3>systemIoSerialPortObject.Read(bytes,offset,count)</h3>

<p>读取数据。<br>
@bytes 为 buffer 对象或者字节码数组。<br>
@offset 指定为数据写入参数@1的索引偏移量，0 为自第一个字节开始写入。<br>
@count 指定自指定索引开始写入的字节数</p>

<p><a id="systemIoSerialPortObject.ReadBufferSize"></a></p>

<h3>systemIoSerialPortObject.ReadBufferSize</h3>

<p>获取或设置 SerialPort 输入缓冲区的大小。</p>

<p><a id="systemIoSerialPortObject.ReadByte"></a></p>

<h3>systemIoSerialPortObject.ReadByte()</h3>

<p>同步读取一个字节，返回数值</p>

<p><a id="systemIoSerialPortObject.ReadChar"></a></p>

<h3>systemIoSerialPortObject.ReadChar()</h3>

<p>同步读取一个字符，返回数值</p>

<p><a id="systemIoSerialPortObject.ReadExisting"></a></p>

<h3>systemIoSerialPortObject.ReadExisting()</h3>

<p>根据编码读取所有可用字节，返回字符串</p>

<p><a id="systemIoSerialPortObject.ReadLine"></a></p>

<h3>systemIoSerialPortObject.ReadLine()</h3>

<p>读取一行字符串</p>

<p><a id="systemIoSerialPortObject.ReadTimeout"></a></p>

<h3>systemIoSerialPortObject.ReadTimeout</h3>

<p>获取或设置读取操作未完成时发生超时之前的毫秒数。</p>

<p><a id="systemIoSerialPortObject.ReceivedBytesThreshold"></a></p>

<h3>systemIoSerialPortObject.ReceivedBytesThreshold</h3>

<p>获取或设置在数据接收到内部输入缓冲区之前，DataReceived 事件发生时的字节数。</p>

<p><a id="systemIoSerialPortObject.RtsEnable"></a></p>

<h3>systemIoSerialPortObject.RtsEnable</h3>

<p>获取或设置一个值，指示在串行通信期间是否启用请求发送 (RTS) 信号。</p>

<p><a id="systemIoSerialPortObject.Site"></a></p>

<h3>systemIoSerialPortObject.Site</h3>

<p>获取或设置组件的 ISite。</p>

<p><a id="systemIoSerialPortObject.StopBits"></a></p>

<h3>systemIoSerialPortObject.StopBits</h3>

<p>获取或设置每字节的标准停止位数。</p>

<p><a id="systemIoSerialPortObject.Write"></a></p>

<h3>systemIoSerialPortObject.Write</h3>

<p>发送数据</p>

<p><a id="systemIoSerialPortObject.Write"></a></p>

<h3>systemIoSerialPortObject.Write(bytes,offset,count)</h3>

<p>发送数据。<br>
@bytes 为 buffer 对象或者字节码数组。<br>
@offset 指定索引偏移量，0 为自第一个字节开始发送。<br>
@count 指定自指定索引开始发送的字节数</p>

<p><a id="systemIoSerialPortObject.Write"></a></p>

<h3>systemIoSerialPortObject.Write(str)</h3>

<p>发送数据。<br>
@str 指定要发送的字符串。</p>

<p><a id="systemIoSerialPortObject.WriteBufferSize"></a></p>

<h3>systemIoSerialPortObject.WriteBufferSize</h3>

<p>获取或设置串行端口输出缓冲区的大小。</p>

<p><a id="systemIoSerialPortObject.WriteLine"></a></p>

<h3>systemIoSerialPortObject.WriteLine(str)</h3>

<p>发送数据并添加换行。<br>
@str 指定要发送的字符串。</p>

<p><a id="systemIoSerialPortObject.WriteTimeout"></a></p>

<h3>systemIoSerialPortObject.WriteTimeout</h3>

<p>获取或设置写操作未完成时发生超时之前的毫秒数。</p>

<p><a href="https://www.aardio.com/zh-cn/doc/library-reference/System/IO/Ports.md">Markdown 格式</a></p>

</body> 
</html>