
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - COM æ¥å£ - è¾“å‡ºä¸å¼•ç”¨å‚æ•°'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - COM æ¥å£ - è¾“å‡ºä¸å¼•ç”¨å‚æ•°</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>aardio èŒƒä¾‹: COM æ¥å£ - è¾“å‡ºä¸å¼•ç”¨å‚æ•°</h1><pre><code class="aardio language-aardio">//COM æ¥å£ - è¾“å‡ºä¸å¼•ç”¨å‚æ•°
import fonts.fontAwesome;
import win.ui;
/*DSG{{*/
var winform = win.form(text=&quot;COM è¾“å‡ºå‚æ•°&quot;;right=700;bottom=266)
winform.add(
edit={cls=&quot;edit&quot;;left=216;top=22;right=662;bottom=245;db=1;dl=1;dr=1;dt=1;edge=1;hscroll=1;multiline=1;vscroll=1;z=1};
static={cls=&quot;static&quot;;text=&quot;Static&quot;;left=20;top=24;right=199;bottom=234;transparent=1;z=2}
)
/*}}*/

import com.lite;  
var dll = com.lite(&quot;~/example/Languages/VB/.vb6/Vb6Control.ocx&quot;)
var vbCtrl = dll.createEmbedEx(winform.static);
winform.show();

/*
å¯¹äºå¤§éƒ¨åˆ†é™„å¸¦è¿è¡Œæ—¶ COM ç±»å‹åº“çš„ COM å¯¹è±¡ï¼Œ
å¦‚æœä½¿ç”¨äº†è¾“å‡ºä¸å¼•ç”¨å‚æ•°ï¼Œåªè¦ç®€å•åœ°åœ¨è¿”å›å€¼æ¥æ”¶è¾“å…¥å‚æ•°å°±å¯ä»¥äº†ã€‚
*/

var ret,outStr = vbCtrl.GetOutStr(&quot;&quot;);
var ret,outStr = vbCtrl.GetOutStr(); //å¸¦ç±»å‹åº“ä¸”ä¸éœ€è¦è¾“å…¥å€¼æ—¶é€šå¸¸å¯ä»¥çœç•¥
winform.edit.print(&quot;è°ƒç”¨ VB æ§ä»¶å‡½æ•°è¿”å›å€¼:&quot;,ret, outStr );

/*
æœ‰æå°‘æ•° COM å¯¹è±¡ï¼Œä½¿ç”¨äº†è¾“å‡ºå‚æ•°ï¼Œåˆä¸æä¾›è¿è¡Œæ—¶ç±»å‹åº“ã€‚
è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦ç”¨ com.Variant å®šä¹‰ä¸€ä¸ªç±»å‹æ˜ç¡®çš„ COM å˜ä½“å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚
å¹¶ä¸”æŒ‡å®šå‚æ•° @3 ä¸º true ï¼Œä»¥å£°æ˜è¿™æ˜¯ä¸€ä¸ªè¾“å‡ºä¸å¼•ç”¨å‚æ•°ã€‚
*/
var ptrOutStr = com.Variant(&quot;&quot;,8/*_VT_BSTR*/,true);//BSTR ç±»å‹å¯è‡ªåŠ¨è¯†åˆ«ï¼Œå‚æ•° @2 å¯ä»¥çœç•¥ä¸ºç©ºã€‚

//è°ƒç”¨å‡½æ•°ï¼Œè¾“å‡ºå‚æ•°ä»ç„¶ä¼šæ·»åŠ åˆ°è¿”å›å€¼åˆ—è¡¨ï¼ˆè¿”å›å€¼æ˜¯ä¼ å€¼ï¼Œä¸æ˜¯å¼•ç”¨è¾“å‡ºå‚æ•°ï¼‰ã€‚
var ret = vbCtrl.GetOutStr(ptrOutStr);//ä¼ å€ï¼ˆä¹Ÿå°±æ˜¯ä¼ æŒ‡é’ˆå€¼ï¼‰ã€‚

//COM å‡½æ•°ç›´æ¥ä¿®æ”¹äº†è¾“å…¥å‚æ•°çš„å€¼ã€‚
winform.edit.print(&quot;è¾“å‡ºå‚æ•°æ–°å€¼:&quot;, ptrOutStr.value );

/*****************************************************
ä»¥ä¸‹åŸºäº com.Variant å®ç°çš„å‡½æ•°å°†å‚æ•° @2 æŒ‡å®šä¸º true å¯åˆ›å»ºè¾“å‡ºå‚æ•°ï¼š

namespace com{
    float = lambda(v,ref) Variant(v,4/*_VT_R4*/,ref); 
    double = lambda(v,ref) Variant(v,5/*_VT_R8*/,ref); 
    byte = lambda(v,ref) Variant(v,0x10/*_VT_I1*/,ref); 
    ubyte = lambda(v,ref) Variant(v,0x11/*_VT_UI1*/,ref); 
    word = lambda(v,ref) Variant(v,2/*_VT_I2*/,ref); 
    uword = lambda(v,ref) Variant(v,0x12/*_VT_UI2*/,ref); 
    int = lambda(v,ref) Variant(v,3/*_VT_I4*/,ref); 
    uint = lambda(v,ref) Variant(v,0x13/*_VT_UI4*/,ref); 
    long = lambda(v,ref) Variant(v,0x14/*_VT_I8*/,ref); 
    ulong = lambda(v,ref) Variant(v,0x15/*_VT_UI8*/,ref);   
}
*****************************************************/

winform.show();
win.loopMessage();
</code></pre>
<a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/example/COM/Advanced/ByRef.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª Ëü²»ÔÚÏîÄ¿ÎÄ¼şÀàĞÍ¹æ·¶ÄÚ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/example/COM/Advanced/ByRef.md'" tppabs="https://www.aardio.com/zh-cn/doc/example/COM/Advanced/ByRef.md">Markdown æ ¼å¼</a>
</body> 
</html>