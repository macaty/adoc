
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - MSXML è¯»å†™'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - MSXML è¯»å†™</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>aardio èŒƒä¾‹: MSXML è¯»å†™</h1><pre><code class="aardio language-aardio">//MSXML è¯»å†™

import console;
import web.msxml

xmlstr =/*&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;å›½å®¶ id=&quot;china&quot;&gt;
    &lt;çœä»½&gt;
        &lt;çœä»½è¯¦æƒ… id=&quot;shanxi&quot;&gt;é™•è¥¿&lt;/çœä»½è¯¦æƒ…&gt;
        &lt;åœ°åŒº&gt;
            &lt;å¸‚ id=&quot;xian&quot;&gt;è¥¿å®‰&lt;/å¸‚&gt;
            &lt;å¸‚ id=&quot;xianyang&quot;&gt;å’¸é˜³&lt;/å¸‚&gt;
        &lt;/åœ°åŒº&gt;
    &lt;/çœä»½&gt;
    &lt;çœä»½&gt;
        &lt;çœä»½è¯¦æƒ… id=&quot;hunan&quot;&gt;æ¹–å—&lt;/çœä»½è¯¦æƒ…&gt;
        &lt;åœ°åŒº&gt;
            &lt;å¸‚ id=&quot;changsha&quot;&gt;é•¿æ²™&lt;/å¸‚&gt;
            &lt;å¸‚ id=&quot;zhuzhou&quot;&gt;æ ªæ´²&lt;/å¸‚&gt;
        &lt;/åœ°åŒº&gt;
    &lt;/çœä»½&gt;
&lt;/å›½å®¶&gt;*/

//è§£æ XML
var xmlDoc = web.msxml(xmlstr);

//å¯è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä¸‹é¢ä»£ç ç­‰ä»·äº console.log( tostring(xmlDoc.xml) ); 
console.log( xmlDoc.xml ); 

//XPath æŸ¥è¯¢
var eles = xmlDoc.selectNodes(&quot;/å›½å®¶/çœä»½[2]/åœ°åŒº[1]/å¸‚[1]&quot;);
//XPath è¯­æ³•é€ŸæŸ¥: https://quickref.me/zh-CN/docs/xpath.html

//é•¿åº¦
console.log(&quot;XPathè¿”å›æ•°ç»„é•¿åº¦&quot;,eles.length)
console.log(&quot;XPathè¿”å›èŠ‚ç‚¹æ–‡æœ¬&quot;,eles[0].text)   

//æŒ‰æ¡ä»¶æŸ¥è¯¢èŠ‚ç‚¹
qNodes = xmlDoc.queryNodes( tagName=&quot;å¸‚&quot;;text =&quot;è¥¿å®‰&quot; ) 
console.log( qNodes.text ); 

//eachNode() å‚æ•°ä¸€å¯é€‰æŒ‡å®štagName,å‚æ•°äºŒå¯é€‰æŒ‡å®šçˆ¶èŠ‚ç‚¹
for(k,xnode in xmlDoc.eachNode( &quot;çœä»½&quot;) ){ 
    for(k,xnode in xmlDoc.eachNode( &quot;çœä»½è¯¦æƒ…&quot;,xnode) ){ 
        console.log( &quot;çœä»½è¯¦æƒ… Id: &quot; ,  xnode.attributes(0).nodeValue  );
        console.log( &quot;çœä»½è¯¦æƒ… value: &quot; ,xnode.text  );
    } 
    for(k,xnode in xmlDoc.eachNode( &quot;åœ°åŒº&quot;,xnode ) ){ 
        for(k,xnode in xmlDoc.eachNode( &quot;å¸‚&quot;,xnode ) ){
            console.log( &quot;   å¸‚ Id: &quot;, xnode.attributes(0).nodeValue );
            console.log( &quot;   å¸‚ value: &quot;, xnode.text ); 
        }
    }
}

var root = xmlDoc.documentElement

//ä¿®æ”¹å›½å®¶ä¸‹å±ç¬¬ä¸€ä¸ªå­—èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹
//æ³¨æ„ aardioæ•°ç»„ä¸‹æ ‡ä»1å¼€å§‹,è€Œcomæ•°ç»„ä¸‹æ ‡ä»é›¶å¼€å§‹
//ä¸‹é¢ä¸¤å¥çš„ä½œç”¨æ˜¯ä¸€æ ·çš„
root.childNodes(0).Text=&quot;testitem&quot; 

//COM å¯¹è±¡å¯åœ¨å±æ€§åå­—å‰åŠ ä¸Šsetå‰ç¼€ã€å¹¶ä»¥å‡½æ•°å½¢å¼è°ƒç”¨å±æ€§æ–¹æ³•
root.childNodes(0).setText(&quot;testitem2&quot;) 

//ä¸‹é¢è¿™å‡ å¥ä½œç”¨æ˜¯ä¸€æ ·çš„
var text = root.childNodes(0).Text;
var text = root.childNodes(0).getText() //åœ¨å±æ€§åå­—å‰åŠ ä¸Šgetå‰ç¼€ã€å¹¶ä»¥å‡½æ•°å½¢å¼è°ƒç”¨å±æ€§æ–¹æ³•
var text = root.childNodes.item(0).getText() 
console.log( text)

//æ›´ç®€å•çš„æ–¹æ³•
console.log( xmlDoc.å¸‚(0).text  ); 

//ä¿å­˜xmlæ–‡ä»¶
xmlDoc.save( &quot;/result.xmlDoc&quot; )

import process;
process.execute(&quot;notepad.exe&quot;,xmlDoc.url )
</code></pre>
<a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/example/Web/XML/msxml.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª Ëü²»ÔÚÏîÄ¿ÎÄ¼şÀàĞÍ¹æ·¶ÄÚ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/example/Web/XML/msxml.md'" tppabs="https://www.aardio.com/zh-cn/doc/example/Web/XML/msxml.md">Markdown æ ¼å¼</a>
</body> 
</html>