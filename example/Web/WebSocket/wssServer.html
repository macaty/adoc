
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - WSS æœåŠ¡ç«¯'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - WSS æœåŠ¡ç«¯</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>aardio èŒƒä¾‹: WSS æœåŠ¡ç«¯</h1><pre><code class="aardio language-aardio">//WSS æœåŠ¡ç«¯
import win.ui;
/*DSG{{*/
var winform = win.form(text=&quot;wss æœåŠ¡ç«¯&quot;;right=759;bottom=469)
winform.add(
edit={cls=&quot;edit&quot;;left=12;top=13;right=744;bottom=448;edge=1;multiline=1;z=1}
)
/*}}*/

import console; 
import web.SocketSharp;//æ‰“å¼€æ§åˆ¶å°å¯æŸ¥çœ‹æœåŠ¡ç«¯é”™è¯¯è¾“å‡º

//åŠ è½½ SSL è¯ä¹¦åå¯æ”¹ä¸º wss:// ã€‚
var wssv = web.SocketSharp.Server.WebSocketServer(&quot;wss://localhost:8877&quot;) 

//ç”Ÿæˆæµ‹è¯•è¯ä¹¦ï¼Œws åè®®ä¸éœ€è¦
import web.SocketSharp.Pfx;
wssv.SslConfiguration.ServerCertificate = System.Security.Cryptography.X509Certificates.X509Certificate2(
    web.SocketSharp.Pfx(&quot;/test.pfx&quot;,&quot;123456&quot;) 
);

/*
ç¬¬äºŒä¸ªå‚æ•°ç”¨äºå®šä¹‰ä¸€ä¸ª WebSocket ä¼šè¯ç±»ã€‚
æ¯æ¬¡åˆ›å»ºæ–°çš„ WebSocket è¿æ¥æ—¶ä¼šè°ƒç”¨ç±»åˆ›å»ºWebSocket ä¼šè¯å®ä¾‹ã€‚ 
*/
wssv.AddWebSocketService(&quot;/echo&quot;,class {

    onMessage = function(e){
        /*
        this.socket ä¼šè‡ªåŠ¨ç»‘å®šä¸º WebSocketSharp.Server.WebSocketBehavior å®ä¾‹ã€‚
        ç”¨æ³•è¯·å‚è€ƒ WebSocketSharp æ–‡æ¡£ã€‚

        å¿…é¡»å®šä¹‰ this.onMessage äº‹ä»¶ç”¨äºæ¥æ”¶æ¶ˆæ¯ã€‚
        å¯é€‰å®šä¹‰ this.onOpen, this.onClose, this.onError äº‹ä»¶ã€‚
        è¿™å‡ ä¸ªäº‹ä»¶ä¸ WebSocketSharp.Server.WebSocketBehavio çš„åŒåäº‹ä»¶ç”¨æ³•ç›¸åŒã€‚
        å”¯ä¸€ä¸åŒçš„æ˜¯é¦–å­—æ¯å°å†™ã€‚

        this.send() ç­‰ä»·äºè°ƒç”¨ this.socket.Send()
        this.sendAsync() ç­‰ä»·äºè°ƒç”¨ this.socket.SendAsync()
        å”¯ä¸€åŒºåˆ«æ˜¯é¦–å­—æ¯å°å†™ã€‚
        */ 

        winform.edit.print(&quot;æœåŠ¡ç«¯æ”¶åˆ°æ¶ˆæ¯&quot;,e.data)

        //åŒæ­¥å‘é€ï¼Œç¾¤å‘ç”¨ this.broadcast
        this.send(&quot;ä½ å¥½æˆ‘æ˜¯æœåŠ¡ç«¯&quot;)

        //å¼‚æ­¥å‘é€ï¼ŒæˆåŠŸå›è°ƒå‚æ•° @2ï¼Œå¼‚æ­¥ç¾¤å‘ç”¨ broadcastAsync
        this.sendAsync(&quot;ä½ å¥½æˆ‘æ˜¯æœåŠ¡ç«¯&quot;,function(completed){

        } ) 
    }  
});

//å¯åŠ¨æœåŠ¡å™¨
wssv.Start();

winform.onDestroy = function(){ 
    wssv.Stop();//å…³é—­æœåŠ¡å™¨ï¼Œä¸ç„¶ä¸‹æ¬¡å¯åŠ¨ï¼ŒçŸ­æ—¶é—´å†…ç«¯å£ä¼šæ˜¯å ç”¨çŠ¶æ€
}

winform.show();
win.loopMessage();
</code></pre>
<a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/example/Web/WebSocket/wssServer.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª Ëü²»ÔÚÏîÄ¿ÎÄ¼şÀàĞÍ¹æ·¶ÄÚ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/example/Web/WebSocket/wssServer.md'" tppabs="https://www.aardio.com/zh-cn/doc/example/Web/WebSocket/wssServer.md">Markdown æ ¼å¼</a>
</body> 
</html>