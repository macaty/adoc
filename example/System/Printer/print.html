
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - è°ƒç”¨æ‰“å°æœº'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - è°ƒç”¨æ‰“å°æœº</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>aardio èŒƒä¾‹: è°ƒç”¨æ‰“å°æœº</h1><pre><code class="aardio language-aardio">//æ‰“å°
import win.ui;
/*DSG{{*/
var winform = win.form(text=&quot;è°ƒç”¨æ‰“å°æœº&quot;;right=759;bottom=469;border=&quot;dialog frame&quot;;max=false)
winform.add(
btnEnumPrinters={cls=&quot;button&quot;;text=&quot;åˆ—å‡ºæ‰€æœ‰æ‰“å°æœº&quot;;left=446;top=217;right=697;bottom=285;z=4};
btnPrint={cls=&quot;button&quot;;text=&quot;è°ƒç”¨APIæ‰“å°&quot;;left=446;top=46;right=697;bottom=114;z=1};
btnPrintDefault={cls=&quot;button&quot;;text=&quot;é»˜è®¤æ‰“å°æœºè¾“å‡º&quot;;left=446;top=132;right=697;bottom=200;z=5};
btnWbPrint={cls=&quot;button&quot;;text=&quot;ä½¿ç”¨HTMLæ‰“å°&quot;;left=446;top=302;right=697;bottom=370;z=2};
edit={cls=&quot;edit&quot;;left=40;top=36;right=417;bottom=429;edge=1;multiline=1;z=3}
)
/*}}*/

import win.dlg.print;
import sys.printer;

//è°ƒç”¨æ‰“å°å¯¹è¯æ¡†,GDI+æ‰“å°
winform.btnPrint.oncommand = function(id,event){

    import win.dlg.print;
    var printDlg = win.dlg.print(winform);
    if(!printDlg.doModal()) return;

    var pdc = sys.printer.device(printDlg.hdc);
    pdc.start(
        function(hdcPrinter){
            //GDI+ç»˜å›¾
            import gdip.graphics;
            import gdip.family;
            import gdip.solidBrush;

            var graphics = gdip.graphics(hdcPrinter);
            graphics.pageUnit = 2/*_UnitPixel,æ‰“å°å•ä½æ”¹ä¸ºä½¿ç”¨åƒç´ */

            var brush = gdip.solidBrush(0xFFFF0000);
            var family = gdip.family(&quot;å®‹ä½“&quot;);
            var strformat = gdip.stringformat(); 
            var curFont = family.createFont(  15,2/*_GdipFontStyleItalic*/, 2/*_GdipUnitPixel*/)
            graphics.drawString( &quot;Hellow world! æ‰“å°æµ‹è¯•!!&quot;  , curFont
            ,  gdip.RECTF(15,15,500,150), strformat,brush);
            brush.delete()
            curFont.delete()
            strformat.delete();
            family.delete(); 
        }
    );

    //ç»“æŸæ‰“å° 
    printDlg.free()   
}

//ç›´æ¥é€‰å®šé»˜è®¤æ‰“å°æœºè¾“å‡º
winform.btnPrintDefault.oncommand = function(id,event){

    var printer = sys.printer();
    var pdc = printer.createDevice(
        dmPaperSize = 9/*_DMPAPER_A4*/; //å°ç¥¨æ‰“å°æœºå¯ä»¥è®¾ä¸º0,æ™®é€šæ‰“å°æœºä½¿ç”¨ _DMPAPER_ å‰ç¼€å¸¸é‡æŒ‡å®šçº¸å¼ å¤§å°ï¼Œä¾‹å¦‚ _DMPAPER_A4 æŒ‡å®šä¸ºA4çº¸
        dmOrientation = 0;//æ¨ªå‘æ‰“å°ä¸º2,çºµå‘æ‰“å°ä¸º1
        //dmPaperWidth = 800;//çº¸å¼ å®½åº¦
        //dmPaperLength = 580;//çº¸å¼ é•¿åº¦
    );

    pdc.start(
        function(hdcPrinter){
            ::Gdi32.TextOut(hdcPrinter,20,20,&quot;æµ‹è¯•æ‰“å°&quot;,4); 
        }
    );

    pdc.close();
}

//åˆ—å‡ºæ‰€æœ‰æ‰“å°æœº
winform.btnEnumPrinters.oncommand = function(id,event){

    for printerName,serverName,attributes in sys.printer.each(){
        winform.edit.print(printerName,serverName,attributes)
    }
}

//HTMLæ ¼å¼æ‰“å°
winform.btnWbPrint.oncommand = function(id,event){
    import web.mshtml;
    wbPrint = web.mshtml();
    wbPrint.write(&quot;æµ‹è¯•ä¸€ä¸‹&quot;)
    wbPrint.getDoc().execCommand(&quot;print&quot;)
}

winform.show() 
win.loopMessage();

</code></pre>
<a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/example/System/Printer/print.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª Ëü²»ÔÚÏîÄ¿ÎÄ¼şÀàĞÍ¹æ·¶ÄÚ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/example/System/Printer/print.md'" tppabs="https://www.aardio.com/zh-cn/doc/example/System/Printer/print.md">Markdown æ ¼å¼</a>
</body> 
</html>