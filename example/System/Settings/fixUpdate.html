
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - RUNAS// ä¿®å¤æ›´æ–°'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - RUNAS// ä¿®å¤æ›´æ–°</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>aardio èŒƒä¾‹: RUNAS// ä¿®å¤æ›´æ–°</h1><pre><code class="aardio language-aardio">//RUNAS// ä¿®å¤æ›´æ–°
import fsys; 
import service;
import console;

console.log(&quot;Windows 10 å¦‚æœåå¤æ›´æ–°å¤±è´¥ï¼Œæˆ–æ›´æ–°åå¯¼è‡´ç³»ç»Ÿæ— æ³•å¯åŠ¨ï¼Œ
å³ä½¿ä¸‹è½½æ–°ç‰ˆæ“ä½œç³»ç»Ÿå®‰è£…ç¨‹åºä¹Ÿæç¤º: &#39;æ— æ³•ç¡®å®šä½ çš„ç”µè„‘èƒ½å¦å®‰è£… Win10&#39;,
è¿™å¾ˆå¯èƒ½æ˜¯å› ä¸ºå¼•å¯¼åˆ†åŒºå¯¼è‡´çš„é—®é¢˜ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ï¼š 

    1.ä½¿ç”¨ Uç›˜å¯åŠ¨ Win10 PE ç³»ç»Ÿ 
    2.è¿è¡Œ DiskGenius åˆ é™¤ç³»ç»Ÿç¡¬ç›˜çš„ ESPã€MSRã€Recovery åˆ†åŒºï¼Œè¿™äº›åˆ†åŒºéƒ½å¾ˆå°ï¼Œå°å¿ƒä¸è¦åˆ é”™äº†ï¼Œ
    3.DiskGenius é‡Œåœ¨æ“ä½œç³»ç»Ÿç¡¬ç›˜é‡æ–°åˆ›å»º ESP åˆ†åŒº
    4.æ‰“å¼€ DISM++ ä¿®å¤å¼•å¯¼ï¼ˆé€‰ä¸­åŸæ¥çš„æ“ä½œç³»ç»Ÿç¡¬ç›˜ï¼Œä¸æ˜¯PEåˆ†åŒºï¼‰ 
    5.è¿™é‡Œ https://go.microsoft.com/fwlink/?LinkId=691209 ä¸‹è½½ MediaCreationTool å®‰è£…æœ€æ–°ç³»ç»Ÿ

ä¸Šé¢çš„æ–¹æ³•ä»…ä¾›å‚è€ƒï¼Œä½¿ç”¨ä¸Šé¢çš„æ–¹æ¡ˆä¸€åˆ‡é£é™©è‡ªè´Ÿã€‚&quot;)

console.more(1,true)

if(!console.askYesNo(&quot;å¦‚æœä½ æš‚æ—¶ä¸æƒ³å°è¯•é‡å»ºå¼•å¯¼åˆ†åŒºçš„æ–¹æ³•ï¼Œ
ä½ å¯ä»¥ç»§ç»­è¿è¡Œæœ¬å·¥å…·å°è¯•é‡ç½®å’Œä¿®å¤ç³»ç»Ÿè‡ªåŠ¨æ›´æ–°å·¥å…·ï¼Œæœ¬å·¥å…·ä¸ä½œä»»ä½•ä¿è¯ï¼Œ
ä½¿ç”¨æœ¬å·¥å…·ä¸€åˆ‡åæœè‡ªè´Ÿï¼ŒæŒ‰ Y é”®ç»§ç»­æ“ä½œ,æŒ‰ N é”®å–æ¶ˆ&quot;)) return;
console.pause(true);

var stopService = function(serviceName){
    console.showLoading(&quot; æ­£åœ¨åœæ­¢ &quot; + serviceName + &quot; æœåŠ¡&quot;);
    sleep(1000);

    var ret = service.stop(serviceName);
    console.log(ret?&quot;æˆåŠŸ&quot;:&quot;å¤±è´¥&quot;);
    sleep(3000);    
}

stopService(&quot;wuauserv&quot;);
stopService(&quot;cryptSvc&quot;);
stopService(&quot;bits&quot;);
stopService(&quot;msiserver&quot;);

import fsys;
fsys.enum( io.getSpecial(0x23/*_CSIDL_COMMON_APPDATA*/,&quot;\Application Data\Microsoft\Network\Downloader\&quot;), 
    {&quot;qmgr*.dat&quot;,&quot;qmgr.db&quot;,&quot;qmgr.jfm&quot;},
    function(dir,filename,fullpath,findData){ 
        if(filename){ 
            console.log(&quot;æ­£åœ¨åˆ é™¤ï¼š&quot;+filename)
            fsys.delete(fullpath);
        }
    } 
);

var path = io.getSpecial(0x24 /*_CSIDL_WINDOWS*/,&quot;SoftwareDistribution/Download&quot;);
fsys.enum( path, &quot;*.*&quot;,
    function(dir,filename,fullpath,findData){ 
        fsys.delete(fullpath)
        console.log(&quot;æ­£åœ¨åˆ é™¤&quot;,filename:dir)
    },false
);

var path = io.getSpecial(0x24 /*_CSIDL_WINDOWS*/,&quot;SoftwareDistribution/DataStore&quot;);
fsys.enum( path, &quot;*.*&quot;,
    function(dir,filename,fullpath,findData){ 
        fsys.delete(fullpath)
        console.log(&quot;æ­£åœ¨åˆ é™¤&quot;,filename:dir)
    },false
);

console.showLoading(&quot;æ­£åœ¨é‡ç½®å®‰å…¨ç¼–å½•æ•°æ®åº“æ–‡ä»¶1&quot;);

import fsys.acl;
fsys.acl.takeOwn(&quot;C:\Windows\system32\catroot2&quot;);
var ret = fsys.rename(&quot;C:\Windows\system32\catroot2&quot;,&quot;C:\Windows\system32\catroot2.old&quot;);
console.log(ret?&quot;æˆåŠŸ&quot;:&quot;å¤±è´¥&quot;);

console.showLoading(&quot;æ­£åœ¨é‡ç½®å®‰å…¨ç¼–å½•æ•°æ®åº“æ–‡ä»¶2&quot;);
var ret = fsys.delete(&quot;C:\Windows\system32\catroot2.old&quot;);
console.log(ret?&quot;æˆåŠŸ&quot;:&quot;å¤±è´¥&quot;);

console.showLoading(&quot;æ­£åœ¨é‡ç½®è‡ªåŠ¨æ›´æ–°ç›®å½•&quot;);
import fsys.acl;
fsys.acl.takeOwn(&quot;C:\Windows\SoftwareDistribution&quot;);
var ret = fsys.delete(&quot;C:\Windows\SoftwareDistribution&quot;);
console.log(ret?&quot;æˆåŠŸ&quot;:&quot;å¤±è´¥&quot;);

import process.batch;
var prcs = process.batch.wow64(`
sc.exe sdset bits D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWLOCRRC;;;AU)(A;;CCLCSWRPWPDTLOCRRC;;;PU)
sc.exe sdset wuauserv D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWLOCRRC;;;AU)(A;;CCLCSWRPWPDTLOCRRC;;;PU)

for %%1 in (%windir%\system32\*.dll) do regsvr32.exe /s %%1

netsh winsock reset

bitsadmin.exe /reset /allusers
`)

for( all,out,err in prcs.each() ){
    io.stdout.write( out,err );
}

var startService = function(serviceName){
    console.showLoading(&quot; æ­£åœ¨å¯åŠ¨ &quot; + serviceName + &quot; æœåŠ¡&quot;);
    sleep(1000);

    var srvMgr = service.manager();

    srvMgr.startAutomatic(serviceName);
    var ret = srvMgr.isRunning(serviceName)  || srvMgr.start(serviceName);
    console.log(ret?&quot;æˆåŠŸ&quot;:&quot;å¤±è´¥&quot;);
    sleep(3000);    
}

startService(&quot;wuauserv&quot;);
startService(&quot;cryptSvc&quot;);
startService(&quot;bits&quot;);
startService(&quot;msiserver&quot;);

var prcs = process.batch.wow64(`
wuauclt /resetauthorization
wuauclt /detectnow
usoclient startscan
`)
for( all,out,err in prcs.each() ){
    io.stdout.write( out,err );
}

if( console.askYesNo(&quot;æ˜¯å¦è°ƒç”¨ DISM ä¿®å¤ç³»ç»Ÿæ–‡ä»¶&quot;) ) {

    /*
    /Online é€‰é¡¹æŒ‡çš„æ˜¯ä¿®å¤å½“å‰æ­£åœ¨è¿è¡Œçš„ Windows ç³»ç»Ÿã€‚
    ä¹Ÿå¯ä»¥ä¿®å¤å…¶ä»–åˆ†åŒºæœªåŠ è½½çš„ Windows ï¼Œä¾‹å¦‚åŠ ä¸Šç”¨C:\Windowså»ä¿®å¤ D:\ ç›˜çš„ Windows 
    process(&quot;DISM.exe /Image:D:\ /Cleanup-image /Restorehealth /Source:C:\Windows&quot;)
    */
    import process;
    process(&quot;DISM.exe /Online /Cleanup-image /Restorehealth&quot;).wait()

    //sfc /scannow å‘½ä»¤å°†æ‰«ææ‰€æœ‰å—ä¿æŠ¤çš„ç³»ç»Ÿæ–‡ä»¶ï¼Œå¹¶ç”¨ä½äº %WinDir%\System32\dllcache çš„å‹ç¼©æ–‡ä»¶å¤¹ä¸­çš„ç¼“å­˜å‰¯æœ¬æ›¿æ¢æŸåçš„æ–‡ä»¶ã€‚
    //process(&quot;sfc /scannow&quot;).wait();
}

if( console.askYesNo(&quot;æ˜¯å¦ä¸‹è½½å¹¶è¿è¡Œå¾®è½¯å‡çº§ç³»ç»Ÿå·¥å…· MediaCreationTool&quot;) ) {
    import fsys.wow64;
    fsys.wow64.disableRedirection(
        function(){
            import inet.installer
            inet.installer(&quot;MediaCreationTool&quot;,&quot;https://go.microsoft.com/fwlink/?LinkId=691209&quot;)     
        }
    )
}

console.log(&quot;å…¨éƒ¨æ“ä½œå·²å®Œæˆã€‚&quot;);
console.pause(true);
</code></pre>
<a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/example/System/Settings/fixUpdate.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª Ëü²»ÔÚÏîÄ¿ÎÄ¼şÀàĞÍ¹æ·¶ÄÚ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/example/System/Settings/fixUpdate.md'" tppabs="https://www.aardio.com/zh-cn/doc/example/System/Settings/fixUpdate.md">Markdown æ ¼å¼</a>
</body> 
</html>