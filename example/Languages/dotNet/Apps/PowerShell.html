
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - aardio è°ƒç”¨ PowerShell'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - aardio è°ƒç”¨ PowerShell</title> 
<link rel="stylesheet" href="../../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>aardio èŒƒä¾‹: è°ƒç”¨ PowerShell</h1><pre><code class="aardio language-aardio">//aardio è°ƒç”¨ PowerShell
import win;
import console;
import dotNet.ps;

/*
dotNet.ps åœ¨å½“å‰è¿›ç¨‹è¿è¡Œ PowerShellï¼Œ
aardio / .Net(C#) / PowerShell å…±äº«åº”ç”¨ç¨‹åºåŸŸï¼Œå¹¶å…±äº«å¯¼å…¥çš„ .Net ç¨‹åºé›†ä¸ç±»å‹ã€‚
*/
var compiler = dotNet.createCompiler(&quot;C#&quot;);  
compiler.Source = /****** 
namespace CSharpLibrary
{ 
    public class Object
    {
        //å®šä¹‰ä¸€ä¸ªå§”æ‰˜ç±»å‹
        public delegate int TestDelegateType(string str,int a);

        //å®šä¹‰ä¸€ä¸ªäº‹ä»¶
        public event TestDelegateType onTestEvent; 

        public int Test()
        {   
            return onTestEvent(&quot;ä½ å¥½&quot;,123);
        }

        //PowerShell 5 ä¸éœ€è¦åŠ è¿™ä¸ªå‡½æ•°
        public static Object New(){return new Object(); }
    }
}
******/
compiler.import(&quot;CSharpLibrary&quot;); //ç¼–è¯‘ C# ä»£ç å¹¶å¯¼å…¥åå­—ç©ºé—´

var out,err = dotNet.ps( `
param($win) # å£°æ˜å‚æ•°ï¼Œç±»ä¼¼ aardio ä¸­ $win = ...

#PowerShell é‡Œ :: è¡¨ç¤ºè®¿é—®ç±»çš„é™æ€æˆå‘˜ï¼ŒNew ç”¨äºåˆ›å»ºå¯¹è±¡
$obj = [CSharpLibrary.Object]::New() #ä½äº PowerShell 5 éœ€è¦åœ¨ç±»é‡Œå¢åŠ  New å‡½æ•°æˆ–æ”¹ç”¨ New-Object

# æ·»åŠ äº‹ä»¶ï¼Œæ³¨æ„ä¸‹é¢æ–¹æ‹¬å·é‡Œæ˜¯å¼ºåˆ¶ç±»å‹è½¬æ¢
$obj.add_onTestEvent( {
    param($str,$a) # å£°æ˜å‚æ•°

    # PowerShell ä¼šæŠŠæ‰€æœ‰è¯­å¥çš„é»˜è®¤è¾“å‡ºå¡è¿›è¿”å›å€¼ï¼Œæ”¹ä¸ºèµ‹å€¼è¯­å¥å¯é¿å…è¿™ä¸ªé—®é¢˜
    $temp = $win.InvokeMember(&quot;msgbox&quot;,&quot;äº‹ä»¶è¢«å›è°ƒäº†&quot;,$str)

    # return è¯­å¥åªèƒ½æ”¹æœ€åä¸€ä¸ªè¿”å›å€¼ï¼Œä¸å…¶ä»–è¯­è¨€æœ‰è¾ƒå¤§åŒºåˆ«
    return $a 
})

$obj.Test()
`,{win = dotNet.ps.export(win)});

console.log(out,err);
console.pause(true);
</code></pre>
<a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/example/Languages/dotNet/Apps/PowerShell.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª Ëü²»ÔÚÏîÄ¿ÎÄ¼şÀàĞÍ¹æ·¶ÄÚ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/example/Languages/dotNet/Apps/PowerShell.md'" tppabs="https://www.aardio.com/zh-cn/doc/example/Languages/dotNet/Apps/PowerShell.md">Markdown æ ¼å¼</a>
</body> 
</html>