
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - C# ä½¿ç”¨ dynamic è°ƒç”¨ aardio'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - C# ä½¿ç”¨ dynamic è°ƒç”¨ aardio</title> 
<link rel="stylesheet" href="../../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>aardio èŒƒä¾‹: C# ä½¿ç”¨ dynamic è°ƒç”¨ aardio</h1><pre><code class="aardio language-aardio">//C# ä½¿ç”¨ dynamic è°ƒç”¨ aardio

/*
åªè¦ç®€æ´ï¼Œä¸æ±‚å®Œç¾ï¼
Win7 åœ¨å¸‚åœºä¸Šå·²ç»æ¥è¿‘æ¶ˆå¤±ï¼Œç°åœ¨å¼€å‘è½¯ä»¶å†å¤„å¤„è€ƒè™‘ Win7 å…¼å®¹æ˜¯ä¸å¿…è¦çš„ã€‚
Win10 å·²è‡ªå¸¦.NET 4.6 ä»¥ä¸Šï¼Œè€Œ .NET 4.x éƒ½æ”¯æŒ dynamic å¯¹è±¡
*/
import dotNet.v4;
var compiler = dotNet.createCompiler(&quot;C#&quot;); //åˆ›å»ºC#ç¼–è¯‘å™¨

//å¿…é¡»å¼•å…¥ä¸‹é¢çš„å‡ ä¸ª DLL
compiler.Reference(
    &quot;System.Core.dll&quot;,&quot;Microsoft.CSharp.dll&quot;
);

compiler.Source = /****** 
using System; 
using System.Dynamic;

namespace CSharpLibrary  
{    
    public class Object  
    {   
        //åªè¦å°† aardio å¯¹è±¡ç±»å‹å†™ä¸º dynamic å°±å¯ä»¥è‡ªç”±è°ƒç”¨äº†ã€‚
        public object Hello( dynamic aardioObject, dynamic aardioFunction ){

            //è°ƒç”¨ aardio å‡½æ•°
            var num = aardioFunction(12,3,this);

            //ä¿®æ”¹ aardio å¯¹è±¡å±æ€§
            aardioObject.å±æ€§å = num;  

            //è°ƒç”¨ aardio å¯¹è±¡å‡½æ•°
            var ret = aardioObject.æ‰§è¡Œaardio(&quot; console.log(&#39;åœ¨C#ä¸­æ‰§è¡Œaardioä»£ç &#39;) &quot;,this);

            //è¯» aardio å¯¹è±¡å±æ€§ 
            return aardioObject.test.abc; 
        } 
    }   
} 
******/

compiler.import(&quot;CSharpLibrary&quot;); //è‡ªç¨‹åºé›†å¯¼å…¥åå­—ç©ºé—´   

//ä½¿ç”¨ C# ç¼–å†™çš„ç±»æ„é€ å¯¹è±¡å®ä¾‹
var cSharpObj = CSharpLibrary.Object();

var aardioObject =  { 
    test = { abc = 12345;  }
    å±æ€§å = 123; 
    æ‰§è¡Œaardio = function( code,netObj ){  

         /*
        aardio å‡½æ•°ä¼ ç»™ .NET æ—¶ï¼ˆå§”æ‰˜ã€äº‹ä»¶ï¼‰ï¼Œ
        aardio ä¼šåœ¨åŸå‡½æ•°å¤–åŒ…è£…ä¸€å±‚ä»£ç†å‡½æ•°ï¼Œå¹¶è‡ªåŠ¨å¤„ç†å›è°ƒå‚æ•°ã€‚
        å›è°ƒ aardio å‡½æ•°çš„å‚æ•°ä¸­çš„ .NET å¯¹è±¡ä¼šè‡ªåŠ¨å°è£…ä¸º dotNet.object ã€‚ 

        ä½† .NET åè¿‡æ¥ç›´æ¥å›è°ƒ aardio å¯¹è±¡çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œ
        å›è°ƒ aardio å‡½æ•°çš„å‚æ•°ä¸­çš„ .NET å¯¹è±¡æ²¡æœ‰ç»è¿‡å¤„ç†ï¼Œä¸ä¼šè‡ªåŠ¨å°è£…ä¸º dotNet.object ã€‚ 

        åŸç”Ÿ .NET å¯¹è±¡åœ¨ aardio ä¸­å­˜ä¸º COM å¯¹è±¡ï¼Œ
        è€ŒåŸç”Ÿ COM æ¥å£ä¸æ”¯æŒ .NET çš„å¾ˆå¤šç‰¹æ€§ï¼Œä¾‹å¦‚é‡è½½ï¼ˆå‡½æ•°åç›¸åŒï¼Œå‚æ•°ä¸åŒï¼‰ã€‚

        .NET åŸç”Ÿå¯¹è±¡ä¼ å…¥ com.IsNetObject() ä¼šè¿”å›é 0 å€¼ã€‚
        è€Œ dotNet.object ä¼ å…¥ dotNet.getObject() ä¼šè¿”å›é null å€¼ã€‚ 

        è§£å†³æ–¹æ¡ˆï¼š
        å¦‚ä¸‹å°†åŸç”Ÿ .NET å¯¹è±¡è½¬æ¢ä¸º aardio ä¸­çš„ dotNet.object ã€‚  
        */
        netObj = dotNet.object(netObj);

        loadcode(code)(); 
        return 123;
    }  
}

import console;
//è°ƒç”¨å®æ—¶ç¼–è¯‘çš„ C# å‡½æ•°
var ret = cSharpObj.Hello( 
    aardioObject,
    function(a,b,netObj){ 
        /*
        è¿™è™½ç„¶æ˜¯é€šè¿‡ dynamic å›è°ƒçš„å‡½æ•°ã€‚
        ä½† aardio å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç»™ .NET æ—¶ï¼Œaardio ä¼šè‡ªåŠ¨å°è£…å¹¶è½¬æ¢æ‰€æœ‰å›è°ƒå‚æ•°ã€‚
        æ‰€ä»¥è¿™é‡Œçš„ netObj æ˜¯ dotNet.object å¯¹è±¡ï¼Œä¸éœ€è¦è½¬æ¢ã€‚
        */
        console.log(&quot;aardio å‡½æ•°è¢« C# è°ƒç”¨äº†,å‚æ•°:&quot;,a,b)

        //æ— è®º.NET å›è°ƒæ˜¯å¦åœ¨åŒä¸€çº¿ç¨‹ï¼Œè¢« .NET å›è°ƒçš„ aardio å‡½æ•°æ€»æ˜¯åœ¨åŸè°ƒç”¨çº¿ç¨‹æ‰§è¡Œï¼ˆä¸å¿…è€ƒè™‘å¤šçº¿ç¨‹è§„åˆ™ä¸åŒæ­¥ï¼‰ã€‚  

        return a + b; 
    } 
); 

console.dump(ret);
console.dumpJson(aardioObject);
console.pause();
</code></pre>
<a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/example/Languages/dotNet/Delegate/dynamic.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª Ëü²»ÔÚÏîÄ¿ÎÄ¼şÀàĞÍ¹æ·¶ÄÚ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/example/Languages/dotNet/Delegate/dynamic.md'" tppabs="https://www.aardio.com/zh-cn/doc/example/Languages/dotNet/Delegate/dynamic.md">Markdown æ ¼å¼</a>
</body> 
</html>