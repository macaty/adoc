
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - PowerShell ä½¿ç”¨ InvokeMember å›è°ƒ aardio'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - PowerShell ä½¿ç”¨ InvokeMember å›è°ƒ aardio</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>aardio èŒƒä¾‹: PowerShell ä½¿ç”¨ InvokeMember å›è°ƒ aardio</h1><pre><code class="aardio language-aardio">//PowerShell ä½¿ç”¨ InvokeMember å›è°ƒ aardio
import win;
import console; 
console.showLoading(&quot; æ­£åœ¨æ‰§è¡Œ PowerShell å‘½ä»¤&quot;);

/*
aardio è°ƒç”¨ PowerShell æ•™ç¨‹: https://mp.weixin.qq.com/s/Sr4HNkOJ1mmAj_V52v69IA
PowerShell å¿«é€Ÿå…¥é—¨ https://learnxinyminutes.com/docs/zh-cn/powershell-cn/ 

Win10/Win11 è‡ªå¸¦çš„ PowerShell 5.1 å·²ç»å¯ä»¥ç›´æ¥å›è°ƒå‚æ•°ä¸­çš„ aardio å¯¹è±¡ã€‚
å¦‚æœå¸Œæœ›å…¼å®¹åˆ° Win7 è‡ªå¸¦çš„ PowerShell 2.0ï¼Œåˆ™å¯ç”¨ dotNet.ps.export() å¯¼å‡º aardio å¯¹è±¡åˆ° PowerShell ã€‚

åªè¦ç®€æ´ï¼Œä¸æ±‚å®Œç¾ï¼
Win7 åœ¨å¸‚åœºä¸Šå·²ç»æ¥è¿‘æ¶ˆå¤±ï¼Œç°åœ¨å¼€å‘è½¯ä»¶å†å¤„å¤„è€ƒè™‘ Win7 å…¼å®¹æ˜¯ä¸å¿…è¦çš„ã€‚
*/
import dotNet.ps;

//PowerShell è„šæœ¬ä»£ç 
var pScript = /* 
    # å®šä¹‰å‘½åå‚æ•°ï¼Œå‚æ•°å‰åŠ $å·ï¼Œaardio å‚æ•°è¡¨é‡Œå»æ‰$å·
    param($win,$external,$username)

    # ä½¿ç”¨ InvokeMember è°ƒç”¨å‚æ•°ä¼ è¿›æ¥çš„ aardio å¯¹è±¡ï¼Œå‚æ•° @1 æŒ‡å®šæˆå‘˜å‡½æ•°å
    $win.InvokeMember(&quot;msgboxTest&quot;,&quot;è¿™æ˜¯ PowerShell è°ƒç”¨ aardio æ‰“å¼€çš„å¯¹è¯æ¡†ã€‚&quot;) #è¿”å›å€¼ä¼šè‡ªåŠ¨è¾“å‡ºä¸€è¡Œ

    # å¯ä»¥ç›´æ¥è¯»å†™å±æ€§ï¼Œè¿™é‡Œç”¨ä¸‹æ ‡ä¹Ÿå¯ä»¥
    $external.abc = 123

    # è‡ªç”±è°ƒç”¨ aardio å‡½æ•° 
    $external.InvokeMember(&quot;func&quot;,&quot;å‚æ•°1&quot;,&quot;å‚æ•°2&quot;)

    # éå†æ‰€æœ‰åŒ¿åå‚æ•°ï¼Œæœ‰åå­—çš„å‚æ•°è¿™é‡Œä¸è¾“å‡º
    for ( $i=0; $i -lt $args.count; $i++){
        #write-host $args[$i]
    }

    Write-Host (&quot;username: &quot; + $username[0])
    Write-Output &quot;æµ‹è¯•è¾“å‡º&quot; 

    $PSVersionTable.PSVersion
*/

var output,err = dotNet.ps(pScript,{
    //ç­‰å·å‰é¢æ˜¯å‚æ•°åï¼ˆå¿…é¡»æ˜¯å­—ç¬¦ä¸²ï¼‰ï¼Œç­‰å·åé¢æ˜¯å‚æ•°å€¼ï¼ˆå¯ä¼ å…¥ .Net å¯¹è±¡ã€COM å¯¹è±¡ã€aardio å¯¹è±¡ï¼‰
    win = dotNet.ps.export(win); //å‚æ•°åå‰ä¸è¦åŠ $æˆ–- 
    external = dotNet.ps.export({
        func = function(...){
            console.log(&quot;PowerShell è°ƒç”¨ aardioï¼Œå‚æ•°ï¼š&quot;,...)  
            console.dump(owner)
        }
    }); 
    username = {&quot;æµ‹è¯•åå­—&quot;};//ä¸éœ€è¦å›è°ƒæˆå‘˜å‡½æ•°çš„æ™®é€šæ•°ç»„ï¼Œä¸éœ€è¦ç”¨ dotNet.ps.export è½¬æ¢ã€‚
    &quot;åŒ¿åå‚æ•°1&quot;,&quot;åŒ¿åå‚æ•°2&quot;,&quot;åŒ¿åå‚æ•°3&quot;,&quot;åŒ¿åå‚æ•°4&quot;
});

console.log(output,err);
console.pause();
</code></pre>
<a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/example/Languages/PowerShell/InvokeMember.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª Ëü²»ÔÚÏîÄ¿ÎÄ¼şÀàĞÍ¹æ·¶ÄÚ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/example/Languages/PowerShell/InvokeMember.md'" tppabs="https://www.aardio.com/zh-cn/doc/example/Languages/PowerShell/InvokeMember.md">Markdown æ ¼å¼</a>
</body> 
</html>