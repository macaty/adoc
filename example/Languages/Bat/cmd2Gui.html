
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - DOSå‘½ä»¤è¡Œçª—å£åŒ–å·¥å…·'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - DOSå‘½ä»¤è¡Œçª—å£åŒ–å·¥å…·</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>aardio èŒƒä¾‹: DOSå‘½ä»¤è¡Œçª—å£åŒ–å·¥å…·</h1><pre><code class="aardio language-aardio">//å‘½ä»¤è¡Œçª—å£åŒ–
//ç›¸å…³èŒƒä¾‹ï¼šè¿›ç¨‹ &gt; ç®¡é“
import win.ui;
import win.ui.menu;
import process.popen;
/*DSG{{*/
var winform = win.form(text=&quot;DOSå‘½ä»¤è¡Œçª—å£åŒ–å·¥å…·&quot;;right=760;bottom=595;bgcolor=16777215;)
winform.add(
btnCls={cls=&quot;button&quot;;text=&quot;æ¸…å±&quot;;left=560;top=564;right=634;bottom=588;db=1;dr=1;font=LOGFONT(name=&#39;å®‹ä½“&#39;);z=5};
button={cls=&quot;button&quot;;text=&quot;è¿è¡Œ&quot;;left=481;top=564;right=555;bottom=588;db=1;dr=1;font=LOGFONT(name=&#39;å®‹ä½“&#39;);z=1};
editCmd={cls=&quot;edit&quot;;text=&quot;dir c:\&quot;;left=233;top=564;right=465;bottom=588;db=1;dl=1;dr=1;edge=1;font=LOGFONT(name=&#39;å®‹ä½“&#39;);z=4};
editCon={cls=&quot;edit&quot;;left=11;top=9;right=748;bottom=553;bgcolor=0;color=16777215;db=1;dl=1;dr=1;dt=1;edge=1;font=LOGFONT(name=&#39;å®‹ä½“&#39;);hscroll=1;link=1;multiline=1;vscroll=1;z=2};
static={cls=&quot;static&quot;;text=&quot;å‘½ä»¤ï¼š&quot;;left=180;top=568;right=227;bottom=584;align=&quot;center&quot;;db=1;dl=1;font=LOGFONT(h=-14;name=&#39;å®‹ä½“&#39;);transparent=1;z=3}
)
/*}}*/

onMenu = function(id){
    var str = winform.menu.getString(id,0x0/*_MF_BYCOMMAND*/);
    str = string.replace(str,&quot;\S+\s*$&quot;,&quot;&quot;)
    winform.editCmd.text = str;
} 

var menu = win.ui.menu(winform);//åˆ›å»ºä¸»èœå•  
menu.add( &quot;DOSå‘½ä»¤&quot;,{
    { &quot;ver æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯&quot;;onMenu  };  
    { &quot;regedit /s æ³¨å†Œè¡¨æ–‡ä»¶å å¯¼å…¥æ³¨å†Œè¡¨&quot;;onMenu  }; 
    { &quot;regedit /e æ³¨å†Œè¡¨æ–‡ä»¶å å¯¼å‡ºæ³¨å†Œè¡¨&quot;;onMenu  }; 
    { &quot;cacls æ–‡ä»¶å æŸ¥çœ‹æ–‡ä»¶çš„è®¿é—®ç”¨æˆ·æƒé™åˆ—è¡¨ &quot;;onMenu  };
    { &quot;set ç¯å¢ƒå˜é‡åç§°=è¦æŒ‡æ´¾çš„å€¼ è®¾ç½®ç¯å¢ƒå˜é‡ &quot;;onMenu  };
    { &quot;set æ˜¾ç¤ºå½“å‰æ‰€æœ‰çš„ç¯å¢ƒå˜é‡&quot;;onMenu  }; 
    { &quot;set p æ˜¾ç¤ºå‡ºå½“å‰ä»¥å­—ç¬¦på¼€å¤´çš„æ‰€æœ‰ç¯å¢ƒå˜é‡&quot;;onMenu  };  
    { &quot;echo ä¿¡æ¯ åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå‡ºä¿¡æ¯&quot;;onMenu  }; 
} )
menu.add( &quot;ç½‘ç»œå‘½ä»¤&quot;, {
        { &quot;net&quot;; {
            { &quot;use&quot;; {
                {&quot;use \\ip\ipc$ &quot;&quot; &quot;&quot; /user:&quot;&quot; &quot;&quot; å»ºç«‹IPCç©ºé“¾æ¥&quot;;onMenu  };
                {&quot;use \\ip\ipc$ &quot;&quot;å¯†ç &quot;&quot; /user:&quot;&quot;ç”¨æˆ·å&quot;&quot; å»ºç«‹IPCéç©ºé“¾æ¥&quot;;onMenu  };
                {&quot;use h: \\ip\c$ &quot;&quot;å¯†ç &quot;&quot; /user:&quot;&quot;ç”¨æˆ·å&quot;&quot; ç›´æ¥ç™»é™†åæ˜ å°„å¯¹æ–¹Cï¼šåˆ°æœ¬åœ°ä¸ºH:&quot;;onMenu  };
                {&quot;use h: \\ip\c$ ç™»é™†åæ˜ å°„å¯¹æ–¹Cï¼šåˆ°æœ¬åœ°ä¸ºH:&quot;;onMenu  };
                {&quot;use \\ip\ipc$ /del åˆ é™¤IPCé“¾æ¥&quot;;onMenu  };
                {&quot;use h: /del åˆ é™¤æ˜ å°„å¯¹æ–¹åˆ°æœ¬åœ°çš„ä¸ºH:çš„æ˜ å°„&quot;;onMenu  };
            } }

            {&quot;è´¦æˆ·&quot;; {
                {&quot;password å¯†ç  æ›´æ”¹ç³»ç»Ÿç™»é™†å¯†ç &quot;;onMenu  };
                {&quot;user guest 12345 ç”¨guestç”¨æˆ·ç™»é™†åç”¨å°†å¯†ç æ”¹ä¸º12345&quot;;onMenu  };
                {&quot;user ç”¨æˆ·å å¯†ç  /add å»ºç«‹ç”¨æˆ·&quot;;onMenu  };
                {&quot;user guest /active:yes æ¿€æ´»guestç”¨æˆ·&quot;;onMenu  };
                {&quot;user æŸ¥çœ‹æœ‰å“ªäº›ç”¨æˆ·&quot;;onMenu  };
                {&quot;user å¸æˆ·å æŸ¥çœ‹å¸æˆ·çš„å±æ€§&quot;;onMenu  };
                {&quot;localgroup administrators ç”¨æˆ·å /add æŠŠâ€œç”¨æˆ·â€æ·»åŠ åˆ°ç®¡ç†å‘˜ä¸­ä½¿å…¶å…·æœ‰ç®¡ç†å‘˜æƒé™&quot;;onMenu  };
            } }

            {&quot;å…±äº«&quot;; {
                {&quot;share æŸ¥çœ‹æœ¬åœ°å¼€å¯çš„å…±äº«&quot;;onMenu  };
                {&quot;share ipc$ å¼€å¯ipc$å…±äº«&quot;;onMenu  };
                {&quot;share ipc$ /del åˆ é™¤ipc$å…±äº«&quot;;onMenu  };
                {&quot;share c$ /del åˆ é™¤Cï¼šå…±äº«&quot;;onMenu  };
                {&quot;view æŸ¥çœ‹æœ¬åœ°å±€åŸŸç½‘å†…å¼€å¯äº†å“ªäº›å…±äº« &quot;;onMenu  }; 
                {&quot;view \\ip æŸ¥çœ‹å¯¹æ–¹å±€åŸŸç½‘å†…å¼€å¯äº†å“ªäº›å…±äº«&quot;;onMenu  }; 
                {&quot;logoff æ–­å¼€è¿æ¥çš„å…±äº«&quot;;onMenu  };
            } }

            {&quot;NTæœåŠ¡&quot;; {
                {&quot;start æŸ¥çœ‹å¼€å¯äº†å“ªäº›æœåŠ¡&quot;;onMenu  };
                {&quot;start æœåŠ¡å  å¼€å¯æœåŠ¡&quot;;onMenu  }; 
                {&quot;stop æœåŠ¡å åœæ­¢æŸæœåŠ¡&quot;;onMenu  };  
                {&quot;pause æœåŠ¡å æš‚åœæŸæœåŠ¡&quot;;onMenu  }; 
            } }

            {&quot;æ—¶é—´&quot;; {
            {&quot;time \\ç›®æ ‡ip æŸ¥çœ‹å¯¹æ–¹æ—¶é—´&quot;;onMenu  }; 
            {&quot;time \\ç›®æ ‡ip /set åŒæ­¥æ—¶é—´&quot;;onMenu  }; 
            {&quot;time \\ç›®æ ‡ip /set /yes åŒæ­¥æ—¶é—´å¹¶å–æ¶ˆç¡®è®¤&quot;;onMenu  }; 

            } }
        }}
        {&quot;netstat&quot;; {
            {&quot;netstat -a æŸ¥çœ‹å¼€å¯äº†å“ªäº›ç«¯å£&quot;;onMenu  };
            {&quot;netstat -n æŸ¥çœ‹ç«¯å£çš„ç½‘ç»œè¿æ¥æƒ…å†µ,&quot;;onMenu  };
            {&quot;netstat -an æŸ¥çœ‹ç«¯å£&quot;;onMenu  };
            {&quot;netstat -v æŸ¥çœ‹æ­£åœ¨è¿›è¡Œçš„å·¥ä½œ&quot;;onMenu  };
            {&quot;netstat -p åè®®å æŸ¥çœ‹æŸåè®®ä½¿ç”¨æƒ…å†µ&quot;;onMenu  };
            {&quot;netstat -p tcq/ip æŸ¥çœ‹tcp/ipåè®®ä½¿ç”¨æƒ…å†µ&quot;;onMenu  } 
            {&quot;netstat -s æŸ¥çœ‹æ­£åœ¨ä½¿ç”¨çš„æ‰€æœ‰åè®®ä½¿ç”¨æƒ…å†µ&quot;;onMenu  } 
            {&quot;nbtstat -A ip çœ‹å¯¹æ–¹æœ€è¿‘ç™»é™†çš„ç”¨æˆ·å&quot;;onMenu  }
        } }
        {&quot;nbtstat&quot;; {  
            {&quot;nbtstat -A ip çœ‹å¯¹æ–¹æœ€è¿‘ç™»é™†çš„ç”¨æˆ·å&quot;;onMenu  }
        } }
        {&quot;tracert -å‚æ•° ip è·Ÿè¸ªè·¯ç”±&quot;;onMenu }
        {&quot;ping ip(æˆ–åŸŸå) å‘å¯¹æ–¹ä¸»æœºå‘é€é»˜è®¤å¤§å°ä¸º32å­—èŠ‚çš„æ•°æ®&quot;;onMenu  }
        {&quot;ipconfig /all æ˜¾ç¤ºå…¨éƒ¨ç½‘å¡é…ç½®ä¿¡æ¯&quot;;onMenu  };
        {&quot;telnet ip ç«¯å£ è¿œç¨‹ç™»é™†æœåŠ¡å™¨&quot;;onMenu  } 
        {&quot;netsh æŸ¥çœ‹æˆ–æ›´æ”¹æœ¬åœ°ç½‘ç»œé…ç½®æƒ…å†µ&quot;;onMenu  }
        {&quot;arp -a æŸ¥çœ‹å…¨éƒ¨ARPç¼“å­˜&quot;;onMenu  }
} )
menu.add( &quot;æ–‡ä»¶å‘½ä»¤&quot;, {
        {&quot;dir æŸ¥çœ‹æ–‡ä»¶&quot;;onMenu  }
        {&quot;dir /Q æ˜¾ç¤ºæ–‡ä»¶åŠç›®å½•å±ç³»ç»Ÿå“ªä¸ªç”¨æˆ·&quot;;onMenu  }
        {&quot;dir /T:C æ˜¾ç¤ºæ–‡ä»¶åˆ›å»ºæ—¶é—´,&quot;;onMenu  }
        {&quot;dir /T:A æ˜¾ç¤ºæ–‡ä»¶ä¸Šæ¬¡è¢«è®¿é—®æ—¶é—´,&quot;;onMenu  }
        {&quot;dir /T:W ä¸Šæ¬¡è¢«ä¿®æ”¹æ—¶é—´ &quot;;onMenu  }
        {&quot;attrib æ–‡ä»¶å(ç›®å½•å) æŸ¥çœ‹æŸæ–‡ä»¶(ç›®å½•)çš„å±æ€§ &quot;;onMenu  } 
        {&quot;attrib æ–‡ä»¶å -A -R -S -H H å»æ‰æŸæ–‡ä»¶çš„å­˜æ¡£,åªè¯»,ç³»ç»Ÿ,éšè—å±æ€§&quot;;onMenu  }
        {&quot;attrib æ–‡ä»¶å +A +R +S +H æ·»åŠ æŸæ–‡ä»¶çš„å­˜æ¡£,åªè¯»,ç³»ç»Ÿ,éšè—å±æ€§&quot;;onMenu  }
        {&quot;del -F æ–‡ä»¶å åŠ -Få‚æ•°åå°±å¯åˆ é™¤åªè¯»æ–‡ä»¶&quot;;onMenu  }
        {&quot;del -F æ–‡ä»¶å /ARã€/AHã€/ASã€/AAåˆ†åˆ«è¡¨ç¤ºåˆ é™¤åªè¯»ã€éšè—ã€ç³»ç»Ÿã€å­˜æ¡£æ–‡ä»¶&quot;;onMenu  }
        {&quot;del -F /A-Rã€/A-Hã€/A-Sã€/A-Aè¡¨ç¤ºåˆ é™¤é™¤åªè¯»ã€éšè—ã€ç³»ç»Ÿã€å­˜æ¡£ä»¥å¤–çš„æ–‡ä»¶&quot;;onMenu  } 
        {&quot;DEL/A-S *.*  åˆ é™¤å½“å‰ç›®å½•ä¸‹é™¤ç³»ç»Ÿæ–‡ä»¶ä»¥å¤–çš„æ‰€æœ‰æ–‡ä»¶&quot;;onMenu  }
        {&quot;del /S /Q ç›®å½• åˆ é™¤ç›®å½•åŠç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶&quot;;onMenu  }
        {&quot;rmdir /s /Q ç›®å½• /S åˆ é™¤ç›®å½•åŠç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶ &quot;;onMenu  } 
        {&quot;move è¦ç§»åŠ¨çš„æ–‡ä»¶å å­˜æ”¾ç§»åŠ¨æ–‡ä»¶çš„è·¯å¾„ ç§»åŠ¨æ–‡ä»¶ &quot;;onMenu  }
        {&quot;fc one.txt two.txt &gt; 3st.txt å¯¹æ¯”äºŒä¸ªæ–‡ä»¶å¹¶æŠŠä¸åŒä¹‹å¤„è¾“å‡ºåˆ°3st.txtæ–‡ä»¶ä¸­ &quot;;onMenu  }
        {&quot;copy è·¯å¾„\æ–‡ä»¶å1 è·¯å¾„\æ–‡ä»¶å2 /y å¤åˆ¶æ–‡ä»¶1åˆ°æŒ‡å®šçš„ç›®å½•ä¸ºæ–‡ä»¶2&quot;;onMenu  } 
        {&quot;copy c:\srv.exe \\ip\admin$ å¤åˆ¶æœ¬åœ°c:\srv.exeåˆ°å¯¹æ–¹çš„adminä¸‹ &quot;;onMenu  }
        {&quot;cppy 1st.jpg/b+2st.txt/a 3st.jpg å°†2st.txtçš„å†…å®¹è—èº«åˆ°1st.jpgä¸­ç”Ÿæˆ3st.jpgæ–°çš„æ–‡ä»¶&quot;;onMenu  } 
        {&quot;copy \\ip\admin$\*.* c:\   å¤åˆ¶å¯¹æ–¹admini$å…±äº«ä¸‹çš„æ‰€æœ‰æ–‡ä»¶è‡³æœ¬åœ°Cï¼š &quot;;onMenu  }
        {&quot;xcopy è¦å¤åˆ¶çš„æ–‡ä»¶æˆ–ç›®å½• &quot;;onMenu  }
        {&quot;for å¯¹ä¸€ç»„æ–‡ä»¶ä¸­çš„æ¯ä¸€ä¸ªæ–‡ä»¶æ‰§è¡ŒæŸä¸ªç‰¹å®šå‘½ä»¤ &quot;;onMenu  }
        {&quot;findstr &quot;&quot;Hello&quot;&quot; aa.txt åœ¨aa.txtæ–‡ä»¶ä¸­å¯»æ‰¾å­—ç¬¦ä¸²hello&quot;;onMenu  } 
        {&quot;find æ–‡ä»¶å æŸ¥æ‰¾æŸæ–‡ä»¶ &quot;;onMenu  }
        {&quot;format ç›˜ç¬¦ /FS:ç±»å‹ æ ¼å¼åŒ–ç£ç›˜&quot;;onMenu  } 
        {&quot;md ç›®å½•å åˆ›å»ºç›®å½• &quot;;onMenu  }
        {&quot;replace æºæ–‡ä»¶ è¦æ›¿æ¢æ–‡ä»¶çš„ç›®å½• æ›¿æ¢æ–‡ä»¶ &quot;;onMenu  }
        {&quot;ren åŸæ–‡ä»¶å æ–°æ–‡ä»¶å é‡å‘½åæ–‡ä»¶å&quot;;onMenu  } 
        {&quot;tree ä»¥æ ‘å½¢ç»“æ„æ˜¾ç¤ºå‡ºç›®å½• &quot;;onMenu  }
        {&quot;tree -f å°†åˆ—å‡ºç¬¬ä¸ªæ–‡ä»¶å¤¹ä¸­æ–‡ä»¶åç§° &quot;;onMenu  }
        {&quot;type æ–‡ä»¶å æ˜¾ç¤ºæ–‡æœ¬æ–‡ä»¶çš„å†…å®¹&quot;;onMenu  } 
        {&quot;more æ–‡ä»¶å é€å±æ˜¾ç¤ºè¾“å‡ºæ–‡ä»¶&quot;;onMenu  } 
} )
menu.add( &quot;IISæœåŠ¡å‘½ä»¤&quot;, { 
        {&quot;iisreset /reboot é‡å¯win2k&quot;;onMenu  }  
        {&quot;iisreset /start å¯åŠ¨InternetæœåŠ¡&quot;;onMenu  } 
        {&quot;iisreset /start åœæ­¢InternetæœåŠ¡&quot;;onMenu  } 
        {&quot;iisreset /restart é‡æ–°å¯åŠ¨InternetæœåŠ¡&quot;;onMenu  } 
        {&quot;iisreset /status æ˜¾ç¤ºInternetæœåŠ¡çŠ¶æ€ &quot;;onMenu  } 
        {&quot;iisreset /enable  å¯ç”¨InternetæœåŠ¡çš„é‡æ–°å¯åŠ¨&quot;;onMenu  } 
        {&quot;iisreset /disable ç¦ç”¨InternetæœåŠ¡çš„é‡æ–°å¯åŠ¨&quot;;onMenu  }
        {&quot;iisreset /rebootonerror å½“å¯åŠ¨ã€åœæ­¢æˆ–é‡æ–°å¯åŠ¨InternetæœåŠ¡æ—¶,è‹¥å‘ç”Ÿé”™è¯¯å°†é‡æ–°å¼€æœº &quot;;onMenu  } 
        {&quot;iisreset /noforce è‹¥æ— æ³•åœæ­¢InternetæœåŠ¡,å°†ä¸ä¼šå¼ºåˆ¶ç»ˆæ­¢InternetæœåŠ¡ &quot;;onMenu  }  
} )
menu.add( &quot;è®¾ç½®&quot;, { 
    {&quot;è‡ªåŠ¨æ¸…å±&quot;;
        function(id){
            winform.autoCls = !winform.menu.checked(id,0)
            winform.menu.check(id,winform.autoCls,0) 
        }
    }    
} )

import win.path;
import string.cmdline;


//è¾“å…¥å­—ç¬¦åˆ°å­è¿›ç¨‹ 
winform.editCon.wndproc = function(hwnd,message,wParam,lParam){ 
    if( message == 0x102/*_WM_CHAR*/){
        if( winform.process ){

            if( winform.editCon.mbc ){
                table.push( winform.editCon.mbc,wParam &amp; 0xFF )

                winform.process.write( string.pack( winform.editCon.mbc  ) ); 
                winform.editCon.mbc = null;
                return;
            }

            if( wParam &lt;= 0x80 ){ 
                if( wParam == 13 ){
                    winform.process.write(&#39;\r\n&#39;);
                }
                elseif( wParam &gt;= 32 &amp;&amp; wParam &lt;= 126 ){ //å¯æ‰“å°å­—ç¬¦
                    winform.process.write( string.pack( wParam &amp; 0xFF  )  );
                } 
            }
            else {
                winform.editCon.mbc = { wParam &amp; 0xFF  };
            } 
        }
    } 
}

winform.button.oncommand = function(id,event){ 
    if( winform.autoCls ){
        winform.btnCls.oncommand();
    } 

    if( winform.process ){
        winform.process.process.terminate();
        winform.process.close();
    }

    winform.editCon.setFocus()

    var cmdline = winform.editCmd.text; 
    winform.process = process.popen.cmd(cmdline) // åˆ›å»ºè¿›ç¨‹ 

    if(!winform.process){
        winform.editCon.print(&#39;é”™è¯¯çš„å‘½ä»¤è¡Œæˆ–å‚æ•°&#39;);
        winform.editCmd.selectAll();
        return;
    }

    //å°†å‘½ä»¤è¡Œè¾“å‡ºè‡ªåŠ¨è½¬å‘åˆ°æ–‡æœ¬æ¡†
    winform.process.logResponse(winform.editCon);
}

winform.btnCls.oncommand = function(id,event){ 
    winform.editCon.text = &quot;&quot; 
}

winform.editCmd.onOk = function(){
    winform.button.oncommand();
    return true;    
}

winform.onOk = winform.editCmd.onOk

winform.show() 
win.loopMessage();
</code></pre>
<a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/example/Languages/Bat/cmd2Gui.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª Ëü²»ÔÚÏîÄ¿ÎÄ¼şÀàĞÍ¹æ·¶ÄÚ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/example/Languages/Bat/cmd2Gui.md'" tppabs="https://www.aardio.com/zh-cn/doc/example/Languages/Bat/cmd2Gui.md">Markdown æ ¼å¼</a>
</body> 
</html>