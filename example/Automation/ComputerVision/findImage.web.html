
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言范例 - 请稍候正在打开网页......'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言范例 - 请稍候正在打开网页......</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>aardio 范例: 请稍候正在打开网页......</h1><pre><code class="aardio language-aardio">//网页找图
import win.ui;
/*DSG{{*/
var winform = win.form(text=&quot;请稍候正在打开网页......&quot;;right=759;bottom=469)
winform.add()
/*}}*/

//导入浏览器控件支持库
import web.form; 

//在winform上建立浏览器控件窗口
var wb = web.form( winform  ); 
wb.noScriptErr = true;

//打开网页
wb.go(&quot;http://bbs.aardio.com/forum-image-1.html&quot;);

//显示窗口
winform.show();   

//等待指定HTML节点（匹配tagName,src等节点属性）
wb.waitQueryEles( tagName=&quot;img&quot;; src=&quot;logo\.png&quot; )
win.delay(1000);//给点时间让图像显示出来

import soImage;//导入搜图扩展库
import inet.http;//导入HTTP支持库

winform.text = &quot;请稍候,正在下载样本数据&quot;
var imgBytes = inet.http().get(&quot;http://bbs.aardio.com/static/image/common/logo.png&quot;);

//创建查找图像
var imgFind = soImage();
imgFind.setBytes( imgBytes,&quot;*.png&quot;); //解析下载的图像数据，注意要指定图像文件后缀名
imgFind.crop(29,33,193,55);//裁剪图像,尽可能去掉背景，保留特征最强的部分

/*
也可以使用下面的方法加载要查找的样本图像，
查找图像要尽可能的小，并尽可能裁剪去掉背景，突出查找特征。
img.load(&quot;/要查找的图片.bmp&quot;);
*/

/*
在窗口内查找图像
img.findImage(窗口句柄,x,y,x2,y2,step)
参数x,y,x2,y2指定要查找的范围，x、y为左上角坐标,x2、y2为右下角坐标。
step参数指定步进。除第一个参数以外，所有参数可选。
*/
var sm,x,y = imgFind.findImageInWindow(winform);
winform.text = &quot;已找到图片，相似度：&quot; + sm;

//移动鼠标
import mouse; 
mouse.moveToWindow(x-50,y-50,winform.hwnd,8);//保留鼠标轨迹模仿真实的鼠标移动
mouse.click();//点击鼠标

//启动消息循环
win.loopMessage();
</code></pre>
<a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/example/Automation/ComputerVision/findImage.web.md  \n\nļ޷ Teleport Ultra , Ϊ Ŀļ͹淶ڡ  \n\nڷϴ?'))window.location='https://www.aardio.com/zh-cn/doc/example/Automation/ComputerVision/findImage.web.md'" tppabs="https://www.aardio.com/zh-cn/doc/example/Automation/ComputerVision/findImage.web.md">Markdown 格式</a>
</body> 
</html>